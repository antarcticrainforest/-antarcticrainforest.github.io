<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/atmosphere/UKCA/asad_prls.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_1df14ea1ac826f73bc3062fa8a76e0c2.xhtml">atmosphere</a></li><li class="navelem"><a class="el" href="dir_3b087d695daa154bfcb7242bcfd0fbd3.xhtml">UKCA</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">asad_prls.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="asad__prls_8f90_source.xhtml">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aff4ede1e3451428db2a2e8e99b0157da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfacesubroutine.xhtml">subroutine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asad__prls_8f90.xhtml#aff4ede1e3451428db2a2e8e99b0157da">asad_prls</a> (kl, knspec, kspec, ldepem)</td></tr>
<tr class="memdesc:aff4ede1e3451428db2a2e8e99b0157da"><td class="mdescLeft">&#160;</td><td class="mdescRight">(c) [University of Cambridge] [2008]. All rights reserved.  <a href="#aff4ede1e3451428db2a2e8e99b0157da">More...</a><br /></td></tr>
<tr class="separator:aff4ede1e3451428db2a2e8e99b0157da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aff4ede1e3451428db2a2e8e99b0157da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff4ede1e3451428db2a2e8e99b0157da">&#9670;&nbsp;</a></span>asad_prls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfacesubroutine.xhtml">subroutine</a> asad_prls </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>, intent(in)&#160;</td>
          <td class="paramname"><em>kl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>, intent(in)&#160;</td>
          <td class="paramname"><em>knspec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>, dimension(knspec), intent(in)&#160;</td>
          <td class="paramname"><em>kspec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>ldepem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(c) [University of Cambridge] [2008]. All rights reserved. </p>
<p>(c) [University of Cambridge] [2008]. All rights reserved. This routine has been licensed to the Met Office for use and distribution under the UKCA collaboration agreement, subject!&gt; to the terms and conditions set out therein. [Met Office Ref SC138]!&gt; Purpose: To compute the rate of change from each reaction and to compute the production and loss for each species. This routine can be regarded as the main engine to ASAD and accounts for a significant part of the total computational effort. Part of the UKCA model, a community model supported by The Met Office and NCAS, with components provided initially by The University of Cambridge, University of Leeds and The Met. Office. See www.ukca.ac.uk Called from ASAD_DIFFUN and ASAD_FTOY This file belongs in section: UKCA Interface !&gt; Called by ftoy and diffun. kl - No. of spatial points to compute for. Upper limit to inner loop over gridpoints. Usually this is set to jpnl. However, some stiff integrators only comput a single gridpoint at a time, in which case, this is set to 1. ***NOTE**** Setting kl to 1 on a vector computer will severely hamper performance and effectively cause this routine (which accounts for most of the computation in ASAD) to run in scalar mode. knspec - Number of species to compute product and loss terms for. Normally, this routine is called to compute prod. &amp; loss terms for steady state species or non!&gt; steady state species (rather than all the species). kspec - Array of size knspec which holds the species number to compute the product and loss terms for. ldepem - If true, deposition and emission terms are considere although the user may not have turned them on for individual species. If .false., then dry &amp; wet deposition and emissions are ignored regardless of what the user has set. This option is useful when the product and loss are required without these effects. On exit from this routine, the arrays; prod, slos and prk will hav been assigned. Method !&gt; First the reaction rates of change are computed. These are divided into reactions with one reactant and those with two reactants. If we write dy/dt = P - Ly then prod holds P and slos holds Ly, so that prod and slos are always positive. The same code is used for both prod and slos which means we equivalence these arrays to one which spans both. This allows the summation of reaction rates to be unrolled so that we can compute the sums in groups of three. This has proved to be much more efficient on the Cray computer architecture than summing the terms one by one. Tests hav shown there is little to be gained by unrolling over more than 3 terms. Therefore when indexing the pd array we loop over it twice with an interval of jpspec. The first pass updates the products an the second updates the losses. [Equivalence replaced by creating prod and slos as pointers in UM code - see routine asad_mod_init.] For some reactions, the products may be fractional e.g. the actual rate of production is a percentage of the production given by the rate of reaction. All fractional products are treated separated as they involve another multiplication. This loop is not unrolled as it is assumed that the no. of reactions with fractional products is small compared to the total number of reactions. The individual species loss rates are updated by adding the terms due to wet &amp; dry deposition, using previously calculated rates. Similarly, the production rates are updated by adding previously calculated emission rates. Note that wet and dry deposition are treated are first order loss rates ie. dy/dt = -Wy - Dy where W is the wet and D is the dry deposition rates respectively. Local variables !&gt; ip1, ip2, ip3 : no. of groups of 1, 2 &amp; 3 term sums for each species ngrp : for each species, holds the no. of 3 sum, 2 sum and single sum terms and therefore controls the loop limits nprdx3, nprdx2, nprdx1 : arrays holds the species indicies for 3 term, 2 term and single term sums. Language: FORTRAN 90 This code is written to UMDP3 v6 programming standards. </p>

<p class="definition">Definition at line <a class="el" href="asad__prls_8f90_source.xhtml#l00100">100</a> of file <a class="el" href="asad__prls_8f90_source.xhtml">asad_prls.f90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="asad__prls_8f90_aff4ede1e3451428db2a2e8e99b0157da_icgraph.svg" width="100%" height="576"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
