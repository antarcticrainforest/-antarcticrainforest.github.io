<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/utility/qxreconf/rcf_post_process_mod.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_0619a8f54b4fad7043a6de45be8fde0b.xhtml">utility</a></li><li class="navelem"><a class="el" href="dir_448e69cd1e368218ef2123538d498dc2.xhtml">qxreconf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rcf_post_process_mod.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="rcf__post__process__mod_8f90.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno"><a class="line" href="namespacercf__post__process__mod.xhtml">    4</a></span>&#160;<span class="keyword">Module</span> <a class="code" href="namespacercf__post__process__mod.xhtml" title="Post `main loop&#39; processing of data Post `main loop&#39; processing of data. ">rcf_post_process_mod</a></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">! Description:</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">Contains</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">Subroutine </span><a class="code" href="namespacercf__post__process__mod.xhtml#abd81a99947cd0c226d25842ec46e1e95" title="Subroutine Rcf_Post_Process - process fields after `main loop&#39;. ">rcf_post_process_atmos</a>( fields_in, field_count_in, orog_in,&amp;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                   fields_out, field_count_out, orog, &amp;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                   hdr_in, hdr_out, data_source)</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="namespacercf__post__process__mod.xhtml#abd81a99947cd0c226d25842ec46e1e95">   30</a></span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__field__equals__mod.xhtml" title="Copy one field into another - IGNORING THE DATA Copy one field into another - IGNORING THE DATA ...">rcf_field_equals_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="interfacercf__field__equals__mod_1_1rcf__field__equals.xhtml" title="No data is copied or data pointers set. ">rcf_field_equals</a></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__exppx__mod.xhtml" title="Extract a STASHmaster record Extract a STASHmaster record. ">rcf_exppx_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="namespacercf__exppx__mod.xhtml#a88789ab4ab32d603dfdd4b9b0c492604" title="Subroutine Rcf_Exppx - extract a STASHmaster record. ">rcf_exppx</a></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacesubmodel__mod.xhtml" title="A module to contain information about submodels A module to contain information about submodels...">submodel_mod</a><span class="keywordtype">, Only</span> :  &amp;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="namespacesubmodel__mod.xhtml#a46a6f4e4a4119ea74676854f5e7e5e2b">atmos_im</a></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__calc__rho__mod.xhtml" title="Calculates RHO for the output dump Calculates RHO for the output dump. ">rcf_calc_rho_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="namespacercf__calc__rho__mod.xhtml#afb25afb0e9eadc667eb1cda4a478fb5b" title="Subroutine Rcf_Calc_Rho - calculates tho. ">rcf_calc_rho</a></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__set__interp__flags__mod.xhtml" title="magic numbers and code for setting up field interpolation flags magic numbers and code for setting up...">rcf_set_interp_flags_mod</a><span class="keywordtype">, Only</span>  : &amp;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="namespacercf__set__interp__flags__mod.xhtml#a850845a708fdb6496b10a52ee6fbe2b2">interp_done</a>,                      &amp;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="namespacercf__set__interp__flags__mod.xhtml#aba4f06e5e66d621574a202a2dcdb6cc9">interp_no_op</a></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__freeze__soil__mod.xhtml" title="Reinitialises frozen/unfrozen soil moisture Reinitialises frozen/unfrozen soil moisture. ">rcf_freeze_soil_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="namespacercf__freeze__soil__mod.xhtml#a30cff531f12d8dca3598d3e20de3d65d" title="This subroutine is the interface to FREEZE_SOIL which reinitialises frozen/unfrozen soil moisture fie...">rcf_freeze_soil</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__data__source__mod.xhtml" title="Definitions for data-type defining source of a field Definitions for data-type defining source of a f...">rcf_data_source_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="structrcf__data__source__mod_1_1data__source__type.xhtml">data_source_type</a>,           &amp;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="namespacercf__data__source__mod.xhtml#aed20a99b437b95600fdeec4087c0ebe6">ancillary_file</a>,             &amp;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespacercf__data__source__mod.xhtml#aea2d2e152c06c6c89dff95655f8d6f05" title="magic numbers for a source of a field etc ">input_dump</a></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__conv__cld__chk__mod.xhtml" title="Performs a sanity check on convective cloud variables Performs a sanity check on convective cloud var...">rcf_conv_cld_chk_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="namespacercf__conv__cld__chk__mod.xhtml#a397a3e7205764e31804103b70d67cd3f" title="Subroutine Rcf_Conv_Cld_Chk - sanity checks. ">rcf_conv_cld_chk</a></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__cloud__frac__chk__mod.xhtml" title="Checks that cloud fraction fields are consistent with q fields. Checks that cloud fraction fields are...">rcf_cloud_frac_chk_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="namespacercf__cloud__frac__chk__mod.xhtml#acc792ffc78c3e720b74d7cec5f47fab8" title="Subroutine Rcf_Cloud_Frac_Chk. ">rcf_cloud_frac_chk</a></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__snow__amount__chk__mod.xhtml" title="Checks that snow amount fields contains no negative values. ">rcf_snow_amount_chk_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="namespacercf__snow__amount__chk__mod.xhtml#a45b1871ce66f86d93da0fc482c904ccb" title="Subroutine Rcf_Snow_Amount_Chk. ">rcf_snow_amount_chk</a></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__sea__ice__frac__chk__mod.xhtml" title="Checks that sea ice fraction has a minimum value. ">rcf_sea_ice_frac_chk_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="namespacercf__sea__ice__frac__chk__mod.xhtml#a178bcc4a0fde68277369e8aad0b9d576" title="Subroutine Rcf_Sea_Ice_Frac_Chk. ">rcf_sea_ice_frac_chk</a></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__soil__moist__chk__mod.xhtml" title="Checks that soil moisture is appropriately set for vegetation. ">rcf_soil_moist_chk_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="namespacercf__soil__moist__chk__mod.xhtml#a294a8f0163f19a057753fe25c5ff616b" title="Subroutine Rcf_Soil_Moist_Chk. ">rcf_soil_moist_chk</a></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__writeumhdr__mod.xhtml" title="Simple wrapper routine for WritHead. ">rcf_writeumhdr_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="namespacercf__writeumhdr__mod.xhtml#ae76c6ff1095ca036e35af7da3a4d424c">rcf_writeumhdr</a></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__field__type__mod.xhtml" title="Defines the field_type data-type Defines the field_type data-type. ">rcf_field_type_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__umhead__mod.xhtml" title="Data module defining um_header_type Data module defining um_header_type. ">rcf_umhead_mod</a><span class="keywordtype">, Only</span> :&amp;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="structrcf__umhead__mod_1_1um__header__type.xhtml" title="Global Type Definitions: ">um_header_type</a></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__grid__type__mod.xhtml" title="Module to define a grid data type. Module to define a grid data type. ">rcf_grid_type_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="namespacercf__grid__type__mod.xhtml#a6fec52ad6879010f1543ab647101a5c4">output_grid</a></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacedecomp__params.xhtml" title="Magic numbers defining decompositions Magic numbers defining decompositions. ">decomp_params</a><span class="keywordtype">, ONLY</span> : &amp;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__headaddress__mod.xhtml" title="Magic numbers for header components Magic numbers for header components. ">rcf_headaddress_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="namespacercf__headaddress__mod.xhtml#adbb5d3ca51e7627314f9f348e04b6864">rc_pressuretop</a>,         &amp;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="namespacercf__headaddress__mod.xhtml#a76f3ebdd0d141e4d755305143c4aa7e1">rc_atmmoist</a>,            &amp;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="namespacercf__headaddress__mod.xhtml#a13f1d23b757acfa98dffa58696824d39">rc_atmmass</a>,             &amp;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="namespacercf__headaddress__mod.xhtml#a65eade611f5446ecc7682cef8a503a4f">rc_atmenergy</a>,           &amp;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="namespacercf__headaddress__mod.xhtml#af2ce94c142ba9fe6abe2878694fca3b3">rc_energycorr</a>,          &amp;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="namespacercf__headaddress__mod.xhtml#a1155c000b3f5c5041232264acd1bf322">ldc_rhcrit</a>,             &amp;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="namespacercf__headaddress__mod.xhtml#a6388c19d76913de952b36571eec60513">fh_gridstagger</a>,         &amp;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="namespacercf__headaddress__mod.xhtml#aac45c7fceea7edb3c45819734466bffd">fh_gridstagger_endgame</a></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__v__int__ctl__mod.xhtml" title="Data module containing vertical interpolation control variables Data module containing vertical inter...">rcf_v_int_ctl_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="namespacercf__v__int__ctl__mod.xhtml#a456ae80e5e11f90269e18bd5281dfbe5">v_int_active</a>,             &amp;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="namespacercf__v__int__ctl__mod.xhtml#a33f3453eb44c30035ad14ac673a04aab">v_int_active_soil</a></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__interp__weights__mod.xhtml" title="Defines interpolation weight variables Defines interpolation weight variables. ">rcf_interp_weights_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="namespacercf__interp__weights__mod.xhtml#acbe250e83e0b0c75c419a45d96b2318b">h_int_active</a></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__locate__mod.xhtml" title="Find a field in a field list by stash item number Find a field in a field list by stash item number...">rcf_locate_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__alloc__field__mod.xhtml" title="Module to allocate and deallocate space for field data Module to allocate and deallocate space for fi...">rcf_alloc_field_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="namespacercf__alloc__field__mod.xhtml#a534438d79b0ac0ce00bb3c7a3c4d14f1" title="Subroutine Rcf_Alloc_Field - allocates space Subroutine Rcf_Dealloc_Field - frees up space...">rcf_alloc_field</a>,            &amp;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="namespacercf__alloc__field__mod.xhtml#ac402578df5f55f08bc742eef36bd403c" title="Dealloc_field frees up any allocated data. ">rcf_dealloc_field</a></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__generate__heights__mod.xhtml" title="Generate SI dynamics height field Generate SI dynamics height field. ">rcf_generate_heights_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="namespacercf__generate__heights__mod.xhtml#a98a045e86a2ef9eec42be8bda125865e">rcf_generate_heights</a></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__theta__t__convs__mod.xhtml" title="Calculations between T and Theta Calculations between T and Theta. ">rcf_theta_t_convs_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="namespacercf__theta__t__convs__mod.xhtml#a768f2fd010849f1f74cdd7ebe9f1b168" title="Subroutine Rcf_Conv_Theta_T - converts theta to t Subroutine Rcf_Conv_T_Theta - converts t to theta...">rcf_conv_theta_t</a>,             &amp;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="namespacercf__theta__t__convs__mod.xhtml#a2017146af611cd53e96d3ec09d1778e3">rcf_conv_t_theta</a></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__read__field__mod.xhtml" title="Wrapper for the READFLDS routine. Wrapper for the READFLDS routine. ">rcf_read_field_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="namespacercf__read__field__mod.xhtml#a31084c176946b7db5991b2cb66973198" title="Subroutine Rcf_Read_Field - read in a field. ">rcf_read_field</a></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__calc__output__exner__mod.xhtml" title="Rcf_Calc_Output_Exner_Mod - calculate output dump exner pressure Rcf_Calc_Output_Exner_Mod - calculat...">rcf_calc_output_exner_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="namespacercf__calc__output__exner__mod.xhtml#ac4151773b597c2381d693b523d1d6ecc" title="Subroutine Rcf_Calc_Output_Exner. ">rcf_calc_output_exner</a></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__write__field__mod.xhtml" title="Wrapper for WRITFLDS Wrapper for WRITFLDS. ">rcf_write_field_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="namespacercf__write__field__mod.xhtml#a45aefec8543b2ff3e794f75dcf866138" title="Subroutine Rcf_Write_Field. ">rcf_write_field</a></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespaceereport__mod.xhtml" title="This file belongs in section: Misc. ">ereport_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__exner__p__convs__mod.xhtml" title="Converts between P and exner (on rho levels) Converts between P and exner (on rho levels) ...">rcf_exner_p_convs_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="namespacercf__exner__p__convs__mod.xhtml#acbc36f4816f60b0f8c70caf6592093dd" title="Subroutine Rcf_Conv_Exner_P - converts exner to P Subroutine Rcf_Conv_P_Exner - converts P to exner...">rcf_conv_exner_p</a>,             &amp;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="namespacercf__exner__p__convs__mod.xhtml#aa652643f81af4bbd27f5b1fd5056df19" title=" Routine to convert P to exner  ">rcf_conv_p_exner</a></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacercf__timer__switch.xhtml" title="This file belongs in section: Reconfiguration. ">rcf_timer_switch</a><span class="keywordtype">, ONLY</span> :   &amp;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="namespacercf__timer__switch.xhtml#acc4b204ab21882d55689b0e2ee93174c">ltimer</a></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__stashcodes__mod.xhtml" title="List of stashcode magic numbers List of stashcode magic numbers. ">rcf_stashcodes_mod</a><span class="keywordtype">, Only</span> :&amp;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="namespacercf__stashcodes__mod.xhtml#a8b04aa66aa966b394ecc63cd176edfcd">stashcode_theta</a>,          <a class="code" href="namespacercf__stashcodes__mod.xhtml#a439981c8c1d692ef180a812f05ec015f">stashcode_q</a>,       &amp;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="namespacercf__stashcodes__mod.xhtml#a89521ec66e4b25224b723cf244d50631">stashcode_rho</a>,            <a class="code" href="namespacercf__stashcodes__mod.xhtml#abf9490128fb974a411e4987cede2a050">stashcode_exner</a>,        &amp;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="namespacercf__stashcodes__mod.xhtml#a314276ea8ae0b2f7234c68d4efdff939">stashcode_p</a>,              <a class="code" href="namespacercf__stashcodes__mod.xhtml#ad0f205a438d215ac41aeea5e162b025b">stashcode_soil_moist</a>,   &amp;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="namespacercf__stashcodes__mod.xhtml#a388aadc57d98f3ad083a4a12553de866">stashcode_soil_temp</a>,      <a class="code" href="namespacercf__stashcodes__mod.xhtml#a29a39e580382b422b6620cce1413f04c">stashcode_orog</a>,         &amp;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__soilstress__to__soilmoist__mod.xhtml" title="Covert soil stress to moisture if soil stress was used in the!&gt; interpolation in the place of soil mo...">rcf_soilstress_to_soilmoist_mod</a><span class="keywordtype">,only</span>:&amp;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="namespacercf__soilstress__to__soilmoist__mod.xhtml#a9a2462d850fe3063ec6343cde4753ebc" title="Subroutine Rcf_Soilstress_to_soilmoist. ">rcf_soilstress_to_soilmoist</a></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacercf__soilconc__to__soilmoist__mod.xhtml" title="Covert soil conc to moisture if soil conc was used in the Covert soil conc to moisture if soil conc w...">rcf_soilconc_to_soilmoist_mod</a><span class="keywordtype">,ONLY</span>:&amp;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="namespacercf__soilconc__to__soilmoist__mod.xhtml#ae7b8e8cd67f4ab0b5efdc5d5c0c3a52e" title="Subroutine Rcf_Soilconc_to_soilmoist. ">rcf_soilconc_to_soilmoist</a></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">Use </span><a class="code" href="namespacercf__recon__mod.xhtml" title="data module defining RECON namelist data module defining RECON namelist ">rcf_recon_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="namespacercf__recon__mod.xhtml#a04b6f37d5d51a6066fd33cda2f387cf5" title="Run the reconfiguration in the VAR suiteLOGICAL :: var_recon = .FALSE. ">use_smc_stress</a>, <a class="code" href="namespacercf__recon__mod.xhtml#a90f30c452dc01657b0c7e97437479043" title="Check output dump for non-uniform polar rows. ">polar_check</a></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacercf__polar__rows__chk__mod.xhtml">rcf_polar_rows_chk_mod</a><span class="keywordtype">, ONLY</span>:  &amp;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="namespacercf__polar__rows__chk__mod.xhtml#a6b497da44b1031ad61910c382465ba6f" title="Subroutine Rcf_Polar_Rows_Chk. ">rcf_polar_rows_chk</a></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacercf__lsm__mod.xhtml" title="Land-Sea mask data Land-Sea mask data. ">rcf_lsm_mod</a><span class="keywordtype">, Only</span> : &amp;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="namespacercf__lsm__mod.xhtml#ab522187082e89e62fee2ff81186100ab">local_lsm_out</a></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacecppxref__mod.xhtml" title="Code Owner: See Unified Model Code Owners HTML page. ">cppxref_mod</a><span class="keywordtype">, ONLY</span> : &amp;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="namespacecppxref__mod.xhtml#af57185f8bd6471c59e021839b65568ee">ppx_atm_tall</a>,       &amp;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="namespacecppxref__mod.xhtml#aee52c237c158b3f2e85610d2207f1cf9">ppx_theta_level</a>,    &amp;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="namespacecppxref__mod.xhtml#a7f89c9221e09f66c19653393f771b350">ppx_rho_level</a></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacercf__lsh__land__ice__chk__mod.xhtml">rcf_lsh_land_ice_chk_mod</a><span class="keywordtype">, ONLY</span> : &amp;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="namespacercf__lsh__land__ice__chk__mod.xhtml#ae7d5f6f58e9d4c8ae25f08a6b4c9fa90" title="Subroutine rcf_lsh_land_ice_chk. ">rcf_lsh_land_ice_chk</a></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">! Arguments</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Pointer</span>           :: fields_in(:)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Pointer</span>           :: fields_out(:)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Intent(InOut)</span>     :: orog_in</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Intent(In)</span>        :: orog</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__data__source__mod_1_1data__source__type.xhtml">data_source_type</a> ), <span class="keywordtype">Pointer</span>     :: data_source(:)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__umhead__mod_1_1um__header__type.xhtml" title="Global Type Definitions: ">um_header_type</a> ), <span class="keywordtype">Intent(In)</span>    :: hdr_in</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__umhead__mod_1_1um__header__type.xhtml" title="Global Type Definitions: ">um_header_type</a> ), <span class="keywordtype">Intent(InOut)</span> :: hdr_out</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordtype">Integer</span>, <span class="keywordtype">Intent(In)</span>                   :: field_count_in</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordtype">Integer</span>, <span class="keywordtype">Intent(In)</span>                   :: field_count_out</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">! Local variables</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">Integer</span>                       :: pos</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordtype">Integer</span>                       :: pos_st   <span class="comment">!} positions in array of</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordtype">Integer</span>                       :: pos_sm   <span class="comment">!} soil temp and moisture</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordtype">Integer</span>                       :: pos_orog <span class="comment">!} and of orography</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">Integer</span>                       :: ErrorStatus</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordtype">Character (Len=*)</span>, <span class="keywordtype">Parameter</span>  :: RoutineName = <span class="stringliteral">&#39;Rcf_Post_Process&#39;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordtype">Character (Len=80)</span>            :: Cmessage</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordtype">Real</span>                          :: theta_heights(                     &amp;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                    output_grid % loc_p_field,      &amp;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                    0 : output_grid % model_levels + 1)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                    <span class="comment">! Height of theta levels</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keywordtype">Real</span>                          :: rho_heights(                       &amp;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                    output_grid % loc_p_field,      &amp;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                    0 : output_grid % model_levels + 1)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                    <span class="comment">! Height of rho levels</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">Logical</span>                       :: exner_out <span class="comment">! is exner in the output?</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keywordtype">Logical</span>                       :: l_soil_change   <span class="comment">! is soil changed</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Pointer</span>   :: exner</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Pointer</span>   :: theta</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Pointer</span>   :: q</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Pointer</span>   :: rho</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Pointer</span>   :: p</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordtype">Type</span>( <a class="code" href="structrcf__field__type__mod_1_1field__type.xhtml">field_type</a> ), <span class="keywordtype">Target</span>    :: pressure  <span class="comment">! exner OR p depending on</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                           <span class="comment">! circumstance</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">! DEPENDS ON: timer</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordflow">If</span> (<a class="code" href="namespacercf__timer__switch.xhtml#acc4b204ab21882d55689b0e2ee93174c">ltimer</a>) <span class="keyword">Call </span><a class="code" href="timer-timer1a_8f90.xhtml#a9ec0272078965f809aa1a1cbc6a05ea4">timer</a>( routinename, 3)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;l_soil_change = .false.     <span class="comment">! initialise soil moisture correction flag</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a>( <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a>, <a class="code" href="namespacercf__stashcodes__mod.xhtml#ad0f205a438d215ac41aeea5e162b025b">stashcode_soil_moist</a>,           &amp;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                 fields_out, field_count_out, pos_sm, .true. )</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordflow">IF</span> (data_source( pos_sm ) % source == <a class="code" href="namespacercf__data__source__mod.xhtml#aea2d2e152c06c6c89dff95655f8d6f05" title="magic numbers for a source of a field etc ">input_dump</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacercf__recon__mod.xhtml#a04b6f37d5d51a6066fd33cda2f387cf5" title="Run the reconfiguration in the VAR suiteLOGICAL :: var_recon = .FALSE. ">use_smc_stress</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     <span class="keyword">CALL </span><a class="code" href="namespacercf__soilstress__to__soilmoist__mod.xhtml#a9a2462d850fe3063ec6343cde4753ebc" title="Subroutine Rcf_Soilstress_to_soilmoist. ">rcf_soilstress_to_soilmoist</a>( fields_out, field_count_out,  &amp;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                     output_grid,<a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>,  &amp;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                     hdr_out)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacercf__v__int__ctl__mod.xhtml#a33f3453eb44c30035ad14ac673a04aab">v_int_active_soil</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     <span class="keyword">CALL </span><a class="code" href="namespacercf__soilconc__to__soilmoist__mod.xhtml#ae7b8e8cd67f4ab0b5efdc5d5c0c3a52e" title="Subroutine Rcf_Soilconc_to_soilmoist. ">rcf_soilconc_to_soilmoist</a>( fields_out, field_count_out,    &amp;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                     output_grid,<a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>,  &amp;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                     hdr_out)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordflow">    END IF</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordflow">  END IF</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordflow">End If</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;-<span class="comment">! Find and setup Theta (will hold T if interpolated)</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;-<span class="keyword">Call </span><a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a>( <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a>, <a class="code" href="namespacercf__stashcodes__mod.xhtml#a8b04aa66aa966b394ecc63cd176edfcd">stashcode_theta</a>,                &amp;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                 fields_out, field_count_out, pos)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;theta =&gt; fields_out( pos )</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#a534438d79b0ac0ce00bb3c7a3c4d14f1" title="Subroutine Rcf_Alloc_Field - allocates space Subroutine Rcf_Dealloc_Field - frees up space...">rcf_alloc_field</a>( theta )</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__read__field__mod.xhtml#a31084c176946b7db5991b2cb66973198" title="Subroutine Rcf_Read_Field - read in a field. ">rcf_read_field</a>( theta, hdr_out, <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a> )</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordflow">If</span> ( <a class="code" href="namespacercf__interp__weights__mod.xhtml#acbe250e83e0b0c75c419a45d96b2318b">h_int_active</a> .OR. <a class="code" href="namespacercf__v__int__ctl__mod.xhtml#a456ae80e5e11f90269e18bd5281dfbe5">v_int_active</a> ) <span class="keywordflow">Then</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;-<span class="comment">! Calculate required heights</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;-  <span class="keyword">Call </span><a class="code" href="namespacercf__generate__heights__mod.xhtml#a98a045e86a2ef9eec42be8bda125865e">rcf_generate_heights</a>( output_grid, orog,                &amp;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                             <a class="code" href="namespacecppxref__mod.xhtml#af57185f8bd6471c59e021839b65568ee">ppx_atm_tall</a>, <a class="code" href="namespacecppxref__mod.xhtml#aee52c237c158b3f2e85610d2207f1cf9">ppx_theta_level</a>,    &amp;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                             theta_heights, theta % level_size )</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__generate__heights__mod.xhtml#a98a045e86a2ef9eec42be8bda125865e">rcf_generate_heights</a>( output_grid, orog,               &amp;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                             <a class="code" href="namespacecppxref__mod.xhtml#af57185f8bd6471c59e021839b65568ee">ppx_atm_tall</a>, <a class="code" href="namespacecppxref__mod.xhtml#a7f89c9221e09f66c19653393f771b350">ppx_rho_level</a>,     &amp;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                             rho_heights,  theta % level_size )</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordflow">End If</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">! Find and read Q</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a>( <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a>, <a class="code" href="namespacercf__stashcodes__mod.xhtml#a439981c8c1d692ef180a812f05ec015f">stashcode_q</a>,                    &amp;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                 fields_out, field_count_out, pos )</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;q =&gt; fields_out( pos )</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#a534438d79b0ac0ce00bb3c7a3c4d14f1" title="Subroutine Rcf_Alloc_Field - allocates space Subroutine Rcf_Dealloc_Field - frees up space...">rcf_alloc_field</a>( q )</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__read__field__mod.xhtml#a31084c176946b7db5991b2cb66973198" title="Subroutine Rcf_Read_Field - read in a field. ">rcf_read_field</a>( q, hdr_out, <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a> )</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;-<span class="comment">! Find exner and P (as required)</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">! Note assumption that will have exner *OR* P available</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;-<span class="keyword">Call </span><a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a>( <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a>, <a class="code" href="namespacercf__stashcodes__mod.xhtml#abf9490128fb974a411e4987cede2a050">stashcode_exner</a>,                &amp;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                 fields_out, field_count_out, pos, .true. )</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">If</span> (pos /= 0) <span class="keywordflow">Then</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  exner =&gt; fields_out( pos )</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#a534438d79b0ac0ce00bb3c7a3c4d14f1" title="Subroutine Rcf_Alloc_Field - allocates space Subroutine Rcf_Dealloc_Field - frees up space...">rcf_alloc_field</a>( exner )</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  exner_out = .true.</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">! Also need space for P</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  p =&gt; pressure</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">Call </span><a class="code" href="interfacercf__field__equals__mod_1_1rcf__field__equals.xhtml" title="No data is copied or data pointers set. ">rcf_field_equals</a>( p, exner )</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#a534438d79b0ac0ce00bb3c7a3c4d14f1" title="Subroutine Rcf_Alloc_Field - allocates space Subroutine Rcf_Dealloc_Field - frees up space...">rcf_alloc_field</a>( p )</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  p % stashmaster =&gt; <a class="code" href="namespacercf__exppx__mod.xhtml#a88789ab4ab32d603dfdd4b9b0c492604" title="Subroutine Rcf_Exppx - extract a STASHmaster record. ">rcf_exppx</a>( <a class="code" href="namespacesubmodel__mod.xhtml#a46a6f4e4a4119ea74676854f5e7e5e2b">atmos_im</a>, 0, <a class="code" href="namespacercf__stashcodes__mod.xhtml#a314276ea8ae0b2f7234c68d4efdff939">stashcode_p</a> )</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keywordflow">Else</span>    <span class="comment">! exner not in output dump</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a>( <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a>, <a class="code" href="namespacercf__stashcodes__mod.xhtml#a314276ea8ae0b2f7234c68d4efdff939">stashcode_p</a>,                  &amp;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                   fields_out, field_count_out, pos )</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  p =&gt; fields_out( pos )</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#a534438d79b0ac0ce00bb3c7a3c4d14f1" title="Subroutine Rcf_Alloc_Field - allocates space Subroutine Rcf_Dealloc_Field - frees up space...">rcf_alloc_field</a>( p )</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  exner_out = .false.</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">! Also need space for exner</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  exner =&gt; pressure</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keyword">Call </span><a class="code" href="interfacercf__field__equals__mod_1_1rcf__field__equals.xhtml" title="No data is copied or data pointers set. ">rcf_field_equals</a>( exner, p )</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#a534438d79b0ac0ce00bb3c7a3c4d14f1" title="Subroutine Rcf_Alloc_Field - allocates space Subroutine Rcf_Dealloc_Field - frees up space...">rcf_alloc_field</a>( exner )</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  exner % stashmaster =&gt; <a class="code" href="namespacercf__exppx__mod.xhtml#a88789ab4ab32d603dfdd4b9b0c492604" title="Subroutine Rcf_Exppx - extract a STASHmaster record. ">rcf_exppx</a>( <a class="code" href="namespacesubmodel__mod.xhtml#a46a6f4e4a4119ea74676854f5e7e5e2b">atmos_im</a>, 0, <a class="code" href="namespacercf__stashcodes__mod.xhtml#abf9490128fb974a411e4987cede2a050">stashcode_exner</a> )</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordflow">End If</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">! Either read or calculate exner (as appropriate)</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordflow">If</span> ( exner % interp /= <a class="code" href="namespacercf__set__interp__flags__mod.xhtml#aba4f06e5e66d621574a202a2dcdb6cc9">interp_no_op</a> ) <span class="keywordflow">Then</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">If</span> ( exner_out ) <span class="keywordflow">Then</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keyword">Call </span><a class="code" href="namespacercf__read__field__mod.xhtml#a31084c176946b7db5991b2cb66973198" title="Subroutine Rcf_Read_Field - read in a field. ">rcf_read_field</a>( exner, hdr_out, <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a> )</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">Else</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">Call </span><a class="code" href="namespacercf__read__field__mod.xhtml#a31084c176946b7db5991b2cb66973198" title="Subroutine Rcf_Read_Field - read in a field. ">rcf_read_field</a>( p, hdr_out, <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a> )</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    exner % Data(:,:) = p % Data(:,:)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    exner % stashmaster =&gt; <a class="code" href="namespacercf__exppx__mod.xhtml#a88789ab4ab32d603dfdd4b9b0c492604" title="Subroutine Rcf_Exppx - extract a STASHmaster record. ">rcf_exppx</a>( <a class="code" href="namespacesubmodel__mod.xhtml#a46a6f4e4a4119ea74676854f5e7e5e2b">atmos_im</a>, 0, <a class="code" href="namespacercf__stashcodes__mod.xhtml#a314276ea8ae0b2f7234c68d4efdff939">stashcode_p</a> )</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keyword">Call </span><a class="code" href="namespacercf__exner__p__convs__mod.xhtml#aa652643f81af4bbd27f5b1fd5056df19" title=" Routine to convert P to exner  ">rcf_conv_p_exner</a>( exner )</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordflow">  End If</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordflow">Else</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">If</span> ( theta % interp /= <a class="code" href="namespacercf__set__interp__flags__mod.xhtml#a850845a708fdb6496b10a52ee6fbe2b2">interp_done</a> ) <span class="keywordflow">Then</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    errorstatus = 10</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    cmessage = <span class="stringliteral">&#39;Only have Theta available - need T to calculate exner&#39;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">Call </span><a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a>( routinename, errorstatus, cmessage )</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keywordflow">  End If</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a>( <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a>, <a class="code" href="namespacercf__stashcodes__mod.xhtml#a29a39e580382b422b6620cce1413f04c">stashcode_orog</a>,               &amp;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                   fields_out, field_count_out, pos_orog )</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__calc__output__exner__mod.xhtml#ac4151773b597c2381d693b523d1d6ecc" title="Subroutine Rcf_Calc_Output_Exner. ">rcf_calc_output_exner</a>( fields_in, field_count_in, orog_in,     &amp;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                              hdr_in, orog, theta, q, exner,          &amp;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                              data_source( pos_orog ) % source,       &amp;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                              rho_heights, theta_heights )</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">If</span> (exner_out) <span class="keywordflow">Then</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">Call </span><a class="code" href="namespacercf__write__field__mod.xhtml#a45aefec8543b2ff3e794f75dcf866138" title="Subroutine Rcf_Write_Field. ">rcf_write_field</a>( exner, hdr_out, <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a> )</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordflow">  End If</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">! Also calculate P - needed internally. Note need to temporarily</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">! fool with stashcode</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  p % Data(:,:) = exner % Data(:,:)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  p % stashmaster =&gt; <a class="code" href="namespacercf__exppx__mod.xhtml#a88789ab4ab32d603dfdd4b9b0c492604" title="Subroutine Rcf_Exppx - extract a STASHmaster record. ">rcf_exppx</a>( <a class="code" href="namespacesubmodel__mod.xhtml#a46a6f4e4a4119ea74676854f5e7e5e2b">atmos_im</a>, 0, <a class="code" href="namespacercf__stashcodes__mod.xhtml#abf9490128fb974a411e4987cede2a050">stashcode_exner</a> )</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__exner__p__convs__mod.xhtml#acbc36f4816f60b0f8c70caf6592093dd" title="Subroutine Rcf_Conv_Exner_P - converts exner to P Subroutine Rcf_Conv_P_Exner - converts P to exner...">rcf_conv_exner_p</a>( p )</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">! Write this newly calcuated field to dump</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">If</span> (.NOT. exner_out) <span class="keywordflow">Then</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">Call </span><a class="code" href="namespacercf__write__field__mod.xhtml#a45aefec8543b2ff3e794f75dcf866138" title="Subroutine Rcf_Write_Field. ">rcf_write_field</a>( p, hdr_out, <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a> )</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordflow">  End If</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keywordflow">End If</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">! Convert T (in dump) back to theta</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keywordflow">If</span> ( theta % interp == <a class="code" href="namespacercf__set__interp__flags__mod.xhtml#a850845a708fdb6496b10a52ee6fbe2b2">interp_done</a> ) <span class="keywordflow">Then</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__theta__t__convs__mod.xhtml#a2017146af611cd53e96d3ec09d1778e3">rcf_conv_t_theta</a>( theta, fields_out, field_count_out, hdr_out, &amp;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                         <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>, rho_heights, theta_heights)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__write__field__mod.xhtml#a45aefec8543b2ff3e794f75dcf866138" title="Subroutine Rcf_Write_Field. ">rcf_write_field</a>( theta, hdr_out, <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a> )</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordflow">End If</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">!*******************************************************************</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">! Calculate rho</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">!*******************************************************************</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a>( <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a>, <a class="code" href="namespacercf__stashcodes__mod.xhtml#a89521ec66e4b25224b723cf244d50631">stashcode_rho</a>,                  &amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                 fields_out, field_count_out, pos)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;rho =&gt; fields_out(pos)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keywordflow">If</span> ( rho % interp == <a class="code" href="namespacercf__set__interp__flags__mod.xhtml#aba4f06e5e66d621574a202a2dcdb6cc9">interp_no_op</a> ) <span class="keywordflow">Then</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">! No interpolation for rho need to calculate</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#a534438d79b0ac0ce00bb3c7a3c4d14f1" title="Subroutine Rcf_Alloc_Field - allocates space Subroutine Rcf_Dealloc_Field - frees up space...">rcf_alloc_field</a>( rho )</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__calc__rho__mod.xhtml#afb25afb0e9eadc667eb1cda4a478fb5b" title="Subroutine Rcf_Calc_Rho - calculates tho. ">rcf_calc_rho</a>( theta, q, exner, p, theta_heights, rho_heights, &amp;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                     rho)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__write__field__mod.xhtml#a45aefec8543b2ff3e794f75dcf866138" title="Subroutine Rcf_Write_Field. ">rcf_write_field</a>( rho, hdr_out, <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a> )</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#ac402578df5f55f08bc742eef36bd403c" title="Dealloc_field frees up any allocated data. ">rcf_dealloc_field</a>( rho )</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keywordflow">End if</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">! Tidy up</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#ac402578df5f55f08bc742eef36bd403c" title="Dealloc_field frees up any allocated data. ">rcf_dealloc_field</a>( p )</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#ac402578df5f55f08bc742eef36bd403c" title="Dealloc_field frees up any allocated data. ">rcf_dealloc_field</a>( q )</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#ac402578df5f55f08bc742eef36bd403c" title="Dealloc_field frees up any allocated data. ">rcf_dealloc_field</a>( exner )</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__alloc__field__mod.xhtml#ac402578df5f55f08bc742eef36bd403c" title="Dealloc_field frees up any allocated data. ">rcf_dealloc_field</a>( theta )</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">! Reset Soil Moisture to match vegetation if interpolated</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordflow">If</span> (<a class="code" href="namespacercf__interp__weights__mod.xhtml#acbe250e83e0b0c75c419a45d96b2318b">h_int_active</a>) <span class="keywordflow">Then</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__soil__moist__chk__mod.xhtml#a294a8f0163f19a057753fe25c5ff616b" title="Subroutine Rcf_Soil_Moist_Chk. ">rcf_soil_moist_chk</a>( fields_out, field_count_out, output_grid, &amp;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                           <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>, hdr_out, l_soil_change)<span class="keywordflow">End If</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">! Check some LSH fields for consistency with land-ice.</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">! We should always call this to make sure any pre-existing dumps are consistent</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">! even when not interpolating.</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keyword">CALL </span><a class="code" href="namespacercf__lsh__land__ice__chk__mod.xhtml#ae7d5f6f58e9d4c8ae25f08a6b4c9fa90" title="Subroutine rcf_lsh_land_ice_chk. ">rcf_lsh_land_ice_chk</a>( fields_out, field_count_out,              &amp;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                           <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>, hdr_out)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">! Adjust frozen/unfrozen soil if updated from ancillary</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__locate__mod.xhtml#a985682ce12dc3e8ce5c19ee7f9839d81" title="Subroutine Rcf_Locate - locates a field in a field array. ">rcf_locate</a>( <a class="code" href="namespacercf__stashcodes__mod.xhtml#a09c7b58f0b34584ef03611891c71de27" title="Magic numbers for stashcodes used in the reconfiguration. ">stashcode_prog_sec</a>, <a class="code" href="namespacercf__stashcodes__mod.xhtml#a388aadc57d98f3ad083a4a12553de866">stashcode_soil_temp</a>,            &amp;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                 fields_out, field_count_out, pos_st, .true. )</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">! Only need to correct if soil moisture/temperature are both in dump</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordflow">If</span> (pos_st /= 0 .AND. pos_sm /= 0) <span class="keywordflow">Then</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">If</span> ( data_source( pos_st ) % Source == <a class="code" href="namespacercf__data__source__mod.xhtml#aed20a99b437b95600fdeec4087c0ebe6">ancillary_file</a>  .OR. &amp;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;       data_source( pos_sm ) % Source == <a class="code" href="namespacercf__data__source__mod.xhtml#aed20a99b437b95600fdeec4087c0ebe6">ancillary_file</a>  .OR. &amp;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;       l_soil_change ) <span class="keywordflow">Then</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keyword">Call </span><a class="code" href="namespacercf__freeze__soil__mod.xhtml#a30cff531f12d8dca3598d3e20de3d65d" title="This subroutine is the interface to FREEZE_SOIL which reinitialises frozen/unfrozen soil moisture fie...">rcf_freeze_soil</a>( fields_out, field_count_out, hdr_out, &amp;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                          output_grid )</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keywordflow">  End If</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordflow">End If</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">! Check convective cloud base and top are sensible</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__conv__cld__chk__mod.xhtml#a397a3e7205764e31804103b70d67cd3f" title="Subroutine Rcf_Conv_Cld_Chk - sanity checks. ">rcf_conv_cld_chk</a>( fields_out, field_count_out, output_grid,  &amp;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                       <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>, hdr_out )</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">! Check that cloud fraction fields are consistent with q fields.</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keyword">Call </span><a class="code" href="namespacercf__cloud__frac__chk__mod.xhtml#acc792ffc78c3e720b74d7cec5f47fab8" title="Subroutine Rcf_Cloud_Frac_Chk. ">rcf_cloud_frac_chk</a>( fields_out, field_count_out, output_grid,  &amp;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                         <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>, hdr_out )</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">! Check for negative snow amounts</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordflow">If</span> (<a class="code" href="namespacercf__interp__weights__mod.xhtml#acbe250e83e0b0c75c419a45d96b2318b">h_int_active</a>) <span class="keywordflow">Then</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__snow__amount__chk__mod.xhtml#a45b1871ce66f86d93da0fc482c904ccb" title="Subroutine Rcf_Snow_Amount_Chk. ">rcf_snow_amount_chk</a>( fields_out, field_count_out,             &amp;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                            output_grid,  <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>, hdr_out )</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordflow">End If</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">! Check for small sea-ice fractions if interpolated</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keywordflow">If</span> (<a class="code" href="namespacercf__interp__weights__mod.xhtml#acbe250e83e0b0c75c419a45d96b2318b">h_int_active</a>) <span class="keywordflow">Then</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keyword">Call </span><a class="code" href="namespacercf__sea__ice__frac__chk__mod.xhtml#a178bcc4a0fde68277369e8aad0b9d576" title="Subroutine Rcf_Sea_Ice_Frac_Chk. ">rcf_sea_ice_frac_chk</a>( fields_out, field_count_out,            &amp;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                             <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>, hdr_out, data_source)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordflow">End If</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">! If appropriate, ensure scalar fields in the polar rows are uniform</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">!********************************************************************</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordflow">IF</span> ( output_grid % global .AND. <a class="code" href="namespacercf__recon__mod.xhtml#a90f30c452dc01657b0c7e97437479043" title="Check output dump for non-uniform polar rows. ">polar_check</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">IF</span> ( hdr_out % Fixhd(<a class="code" href="namespacercf__headaddress__mod.xhtml#a6388c19d76913de952b36571eec60513">fh_gridstagger</a>) == <a class="code" href="namespacercf__headaddress__mod.xhtml#aac45c7fceea7edb3c45819734466bffd">fh_gridstagger_endgame</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    errorstatus = -20</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keyword">WRITE</span>(cmessage,*) <span class="stringliteral">&#39;Polar row checking activated for an invalid grid &#39;</span>,  &amp;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                      <span class="stringliteral">&#39;- disabling test&#39;</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keyword">CALL </span><a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a>( routinename, errorstatus, cmessage )</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacercf__polar__rows__chk__mod.xhtml#a6b497da44b1031ad61910c382465ba6f" title="Subroutine Rcf_Polar_Rows_Chk. ">rcf_polar_rows_chk</a>( fields_out, field_count_out, output_grid,      &amp;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                             <a class="code" href="namespacedecomp__params.xhtml#a197e853bde7274df4b87ac6a3940a602">decomp_rcf_output</a>, hdr_out, <a class="code" href="namespacercf__lsm__mod.xhtml#ab522187082e89e62fee2ff81186100ab">local_lsm_out</a>,     &amp;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                             data_source )</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordflow">  END IF</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordflow">END IF</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;-<span class="comment">! Perform some modifications to headers. -! This would be better earlier in the code when the headers are setup! but there is logic after the headers are setup to turn on interpolation! due to change in orography ancillary.  This is the next best place to! perform this task.</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">IF</span> ( .NOT. <a class="code" href="namespacercf__v__int__ctl__mod.xhtml#a456ae80e5e11f90269e18bd5281dfbe5">v_int_active</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">IF</span> ( .NOT. <a class="code" href="namespacercf__interp__weights__mod.xhtml#acbe250e83e0b0c75c419a45d96b2318b">h_int_active</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">! Want to keep energy correction information if no interpolation    hdr_out % realc( rc_atmmoist   ) = hdr_in % realc( rc_atmmoist   )</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    hdr_out % realc( <a class="code" href="namespacercf__headaddress__mod.xhtml#a13f1d23b757acfa98dffa58696824d39">rc_atmmass</a>    ) = hdr_in % realc( <a class="code" href="namespacercf__headaddress__mod.xhtml#a13f1d23b757acfa98dffa58696824d39">rc_atmmass</a>    )</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    hdr_out % realc( <a class="code" href="namespacercf__headaddress__mod.xhtml#a65eade611f5446ecc7682cef8a503a4f">rc_atmenergy</a>  ) = hdr_in % realc( <a class="code" href="namespacercf__headaddress__mod.xhtml#a65eade611f5446ecc7682cef8a503a4f">rc_atmenergy</a>  )</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    hdr_out % realc( <a class="code" href="namespacercf__headaddress__mod.xhtml#af2ce94c142ba9fe6abe2878694fca3b3">rc_energycorr</a> ) = hdr_in % realc( <a class="code" href="namespacercf__headaddress__mod.xhtml#af2ce94c142ba9fe6abe2878694fca3b3">rc_energycorr</a> )</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordflow">  END IF</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">! We want to copy the rhcrit values across if not vertically interpolating.</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  hdr_out % levdepc(:,<a class="code" href="namespacercf__headaddress__mod.xhtml#a1155c000b3f5c5041232264acd1bf322">ldc_rhcrit</a>) = hdr_in % levdepc(:,<a class="code" href="namespacercf__headaddress__mod.xhtml#a1155c000b3f5c5041232264acd1bf322">ldc_rhcrit</a>)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">! Write out the header here again due to changes above.</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keyword">CALL </span><a class="code" href="namespacercf__writeumhdr__mod.xhtml#ae76c6ff1095ca036e35af7da3a4d424c">rcf_writeumhdr</a>( hdr_out )</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">END IF</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">! DEPENDS ON: timer</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordflow">If</span> (<a class="code" href="namespacercf__timer__switch.xhtml#acc4b204ab21882d55689b0e2ee93174c">ltimer</a>) <span class="keyword">Call </span><a class="code" href="timer-timer1a_8f90.xhtml#a9ec0272078965f809aa1a1cbc6a05ea4">timer</a>( routinename, 4)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">Return</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">End Subroutine </span><a class="code" href="namespacercf__post__process__mod.xhtml#abd81a99947cd0c226d25842ec46e1e95" title="Subroutine Rcf_Post_Process - process fields after `main loop&#39;. ">rcf_post_process_atmos</a></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keyword">End Module </span><a class="code" href="namespacercf__post__process__mod.xhtml" title="Post `main loop&#39; processing of data Post `main loop&#39; processing of data. ">rcf_post_process_mod</a></div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
