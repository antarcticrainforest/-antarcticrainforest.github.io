<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/atmosphere/UKCA/asad_diffun.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_1df14ea1ac826f73bc3062fa8a76e0c2.xhtml">atmosphere</a></li><li class="navelem"><a class="el" href="dir_3b087d695daa154bfcb7242bcfd0fbd3.xhtml">UKCA</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">asad_diffun.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="asad__diffun_8f90_source.xhtml">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a24e5f2651d02752cda4bae7c366a9f0e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfacesubroutine.xhtml">subroutine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asad__diffun_8f90.xhtml#a24e5f2651d02752cda4bae7c366a9f0e">asad_diffun</a> (kl)</td></tr>
<tr class="memdesc:a24e5f2651d02752cda4bae7c366a9f0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">(c) [University of Cambridge] [2008]. All rights reserved.  <a href="#a24e5f2651d02752cda4bae7c366a9f0e">More...</a><br /></td></tr>
<tr class="separator:a24e5f2651d02752cda4bae7c366a9f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a24e5f2651d02752cda4bae7c366a9f0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24e5f2651d02752cda4bae7c366a9f0e">&#9670;&nbsp;</a></span>asad_diffun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfacesubroutine.xhtml">subroutine</a> asad_diffun </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>, intent(in)&#160;</td>
          <td class="paramname"><em>kl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(c) [University of Cambridge] [2008]. All rights reserved. </p>
<p>(c) [University of Cambridge] [2008]. All rights reserved. This routine has been licensed to the Met Office for use and distribution under the UKCA collaboration agreement, subject!&gt; to the terms and conditions set out therein. [Met Office Ref SC138]!&gt; Purpose: Subroutine to calculates tendencies due to chemistry of the model tracers/families, by adding or equivalencing the tendencies of individual chemical species. Part of the UKCA model, a community model supported by The Met Office and NCAS, with components provided initially by The University of Cambridge, University of Leeds and The Met. Office. See www.ukca.ac.uk Called from ASAD_CDRIVE, ASAD_IMPACT, and ASAD_YCN Interface !&gt; kl - Inner loop limit over spatial points. Usually this is jpnl but some stiff integrators will compute one gridpt at a time in which case kl is set to 1. Note however that this severely hampers performance on a vector computer since the inner loop is vectorized. Method !&gt; For species which are in or out of the family depending on their lifetime, their tendency is only added to the family if it is in the family. Its species tendency is always copied to the fdot array as we always integrate it. If the species is in the family however, the integrated result will be overwritten with the steady state value. If dy/dt = P - Ly where P is the production and L is the loss rate, then the array prod holds 'P' and the array slos holds 'Ly'. Both P and L are positive. Since we only need to integrate those species used in the calling model, we can ignore non-family steady state species and species that are constant. A list of such species is held in nlf; actually twice because it's used for both product and loss calculations (see prls) so we only need to loop over the first half of the array. By ignoring these species we can save computer time. Externals !&gt; prls Calculates production and loss terms of individual species. This file belongs in section: UKCA Language: FORTRAN 90 This code is written to UMDP3 v6 programming standards. </p>
<p>Local variables</p>
<ol type="1">
<li>Initialise tracer/family chemistry tendencies<ul>
<li>- IF (lhook) CALL dr_hook('ASAD_DIFFUN',zhook_in,zhook_handle)</li>
</ul>
</li>
<li>Calculate production &amp; loss terms of individual species<ul>
<li>- - &ndash; &ndash; -!&gt; DEPENDS ON: asad_prls</li>
</ul>
</li>
<li>Calculate tendencies DO j = 1, nf </li>
</ol>

<p class="definition">Definition at line <a class="el" href="asad__diffun_8f90_source.xhtml#l00060">60</a> of file <a class="el" href="asad__diffun_8f90_source.xhtml">asad_diffun.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="asad__diffun_8f90_a24e5f2651d02752cda4bae7c366a9f0e_cgraph.svg" width="240" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="asad__diffun_8f90_a24e5f2651d02752cda4bae7c366a9f0e_icgraph.svg" width="100%" height="459"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
