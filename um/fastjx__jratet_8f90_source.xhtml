<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/atmosphere/UKCA/fastjx_jratet.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_1df14ea1ac826f73bc3062fa8a76e0c2.xhtml">atmosphere</a></li><li class="navelem"><a class="el" href="dir_3b087d695daa154bfcb7242bcfd0fbd3.xhtml">UKCA</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fastjx_jratet.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fastjx__jratet_8f90.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!  Description:</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!  Code Description:</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="fastjx__jratet_8f90.xhtml#a6109094af24eb5a0fdeebaa2a0642997" title="(c) [University of California] [2008]. All rights reserved. (c) [University of California] [2008]...">fastjx_jratet</a>(ppj,ttj,fff, valjl)</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="fastjx__jratet_8f90.xhtml#a6109094af24eb5a0fdeebaa2a0642997">   55</a></span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">!     Description: Routine which takes pressure profiles at edges of the grid</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">USE </span><a class="code" href="namespacefastjx__data.xhtml" title="(c) [University of California] [2008]. All rights reserved. (c) [University of California] [2008]...">fastjx_data</a></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">USE </span>fastjx_specs<span class="keywordtype">, ONLY</span>: titlej</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordtype">USE </span>yomhook<span class="keywordtype">,      ONLY</span>: lhook, dr_hook</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">USE </span>parkind1<span class="keywordtype">,     ONLY</span>: jprb, jpim</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordtype">REAL</span>,   <span class="keywordtype">INTENT(IN)</span>  ::  ppj((<a class="code" href="namespacefastjx__data.xhtml#a5ba2bc69af6fb8435964b256344ffa34">lpar</a>+1)+1)    <span class="comment">! pressure profile at edges</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">REAL</span>,   <span class="keywordtype">INTENT(IN)</span>  ::  ttj((<a class="code" href="namespacefastjx__data.xhtml#a5ba2bc69af6fb8435964b256344ffa34">lpar</a>+1))      <span class="comment">! temperatures at mid-level</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordtype">REAL</span>,   <span class="keywordtype">INTENT(IN)</span>  ::  fff(<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a>,<a class="code" href="namespacefastjx__data.xhtml#a4b373b5c16081806044d10e9f128d2b6">jpcl</a>)       <span class="comment">! mean actinic flux</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordtype">REAL</span>,   <span class="keywordtype">INTENT(OUT)</span> ::  valjl(<a class="code" href="namespacefastjx__data.xhtml#a4b373b5c16081806044d10e9f128d2b6">jpcl</a>,<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>)  <span class="comment">! photolysis rates</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordtype">REAL</span> :: valj(<a class="code" href="namespacefastjx__data.xhtml#acfaa1d161cea95874e68eb8dacb56a71">x_</a>)          <span class="comment">! temp for call j&#39;s at one l</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordtype">REAL</span> :: qo2tot(<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a>)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordtype">REAL</span> :: qo3tot(<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a>)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordtype">REAL</span> :: qo31dy(<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a>)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordtype">REAL</span> :: qo31d</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordtype">REAL</span> :: qo3p</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordtype">REAL</span> :: qqqt</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordtype">REAL</span> :: tfact</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordtype">REAL</span> :: tt                <span class="comment">! temperature at mid layer (K)</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordtype">REAL</span> :: pp                <span class="comment">! pressure at mid layer         REAL :: dd                ! density at mid layer          REAL :: tt200</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordtype">REAL</span> :: tfaca</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordtype">REAL</span> :: tfac0</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordtype">REAL</span> :: tfac1</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordtype">REAL</span> :: tfac2</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordtype">REAL</span> :: qqqa</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordtype">REAL</span> :: qq2</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordtype">REAL</span> :: qq1a</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordtype">REAL</span> :: qq1b</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="comment">! Loop variables</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordtype">INTEGER</span> ::  j,k,l, iv</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordtype">INTEGER(KIND=jpim)</span>, <span class="keywordtype">PARAMETER</span> :: zhook_in  = 0</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordtype">INTEGER(KIND=jpim)</span>, <span class="keywordtype">PARAMETER</span> :: zhook_out = 1</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordtype">REAL(KIND=jprb)</span>               :: zhook_handle</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="comment">!**************************************************************</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">! End of Header</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">IF</span> (lhook) <span class="keyword">CALL </span>dr_hook(<span class="stringliteral">&#39;FASTJX_JRATET&#39;</span>,zhook_in,zhook_handle)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">DO</span> l = 1,<a class="code" href="namespacefastjx__data.xhtml#a4b373b5c16081806044d10e9f128d2b6">jpcl</a>    <span class="comment">! master loop over layer = l</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">! Need temperature, pressure, and density at mid-layer (for some quantum yields):</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        tt   = ttj(l)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">IF</span> (l  ==  1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          pp = ppj(1)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          pp  = (ppj(l)+ppj(l+1))*0.5e0</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordflow">        END IF</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        dd = 7.24e18*pp/tt</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">! Initialise to 0</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">DO</span> j = 1,<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          valj(j) = 0.e0</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">! Interpolate temperatures</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">IF</span> (tt &lt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,1))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="keywordflow">IF</span> (tt &lt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,1))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            tfact = 0.e0</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            tfact = (tt -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,1))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,1) -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,1))</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;           qo2tot(k) = <a class="code" href="namespacefastjx__data.xhtml#ad6a30e74151e986b6b972394120d0ccc">qo2</a>(k,1) + (<a class="code" href="namespacefastjx__data.xhtml#ad6a30e74151e986b6b972394120d0ccc">qo2</a>(k,2) - <a class="code" href="namespacefastjx__data.xhtml#ad6a30e74151e986b6b972394120d0ccc">qo2</a>(k,1))*tfact</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <span class="keywordflow">IF</span> (tt &gt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(3,1))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            tfact = 1.e0</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            tfact = (tt -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,1))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(3,1) -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,1))</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;           qo2tot(k) = <a class="code" href="namespacefastjx__data.xhtml#ad6a30e74151e986b6b972394120d0ccc">qo2</a>(k,2) + (<a class="code" href="namespacefastjx__data.xhtml#ad6a30e74151e986b6b972394120d0ccc">qo2</a>(k,3) - <a class="code" href="namespacefastjx__data.xhtml#ad6a30e74151e986b6b972394120d0ccc">qo2</a>(k,2))*tfact</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordflow">        END IF</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         <span class="keywordflow">IF</span> (tt &lt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,2))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="keywordflow">IF</span> (tt &lt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,2))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            tfact = 0.e0</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            tfact = (tt -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,2))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,2) -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,2))</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;           qo3tot(k) = <a class="code" href="namespacefastjx__data.xhtml#a476161f46693b2691c004b0ad3e721c0">qo3</a>(k,1) + (<a class="code" href="namespacefastjx__data.xhtml#a476161f46693b2691c004b0ad3e721c0">qo3</a>(k,2) - <a class="code" href="namespacefastjx__data.xhtml#a476161f46693b2691c004b0ad3e721c0">qo3</a>(k,1))*tfact</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">IF</span> (tt &gt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(3,2))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            tfact = 1.e0</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            tfact = (tt -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,2))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(3,2) -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,2))</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;           qo3tot(k) = <a class="code" href="namespacefastjx__data.xhtml#a476161f46693b2691c004b0ad3e721c0">qo3</a>(k,2) + (<a class="code" href="namespacefastjx__data.xhtml#a476161f46693b2691c004b0ad3e721c0">qo3</a>(k,3) - <a class="code" href="namespacefastjx__data.xhtml#a476161f46693b2691c004b0ad3e721c0">qo3</a>(k,2))*tfact</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordflow">        END IF</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;         <span class="keywordflow">IF</span> (tt &lt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,3))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <span class="keywordflow">IF</span> (tt &lt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,3))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            tfact = 0.e0</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            tfact = (tt -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,3))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,3) -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,3))</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;           qo31dy(k) = <a class="code" href="namespacefastjx__data.xhtml#a756516540b5d619d732ac1dafccd7e6c">q1d</a>(k,1) + (<a class="code" href="namespacefastjx__data.xhtml#a756516540b5d619d732ac1dafccd7e6c">q1d</a>(k,2) - <a class="code" href="namespacefastjx__data.xhtml#a756516540b5d619d732ac1dafccd7e6c">q1d</a>(k,1))*tfact</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <span class="keywordflow">IF</span> (tt &gt;= <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(3,3))  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            tfact = 1.e0</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            tfact = (tt -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,3))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(3,3) -<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,3))</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;           qo31dy(k) = <a class="code" href="namespacefastjx__data.xhtml#a756516540b5d619d732ac1dafccd7e6c">q1d</a>(k,2) + (<a class="code" href="namespacefastjx__data.xhtml#a756516540b5d619d732ac1dafccd7e6c">q1d</a>(k,3) - <a class="code" href="namespacefastjx__data.xhtml#a756516540b5d619d732ac1dafccd7e6c">q1d</a>(k,2))*tfact</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordflow">        END IF</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;         <span class="comment">! Loop over wavelengths</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          qo31d  = qo31dy(k)*qo3tot(k)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          qo3p  = (1-qo31dy(k))*qo3tot(k)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          valj(1) = valj(1) + qo2tot(k)*fff(k,l)   <span class="comment">! O2 -&gt; O(3P) + O(3P)</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          valj(2) = valj(2) + qo3p*fff(k,l)        <span class="comment">! O3 -&gt; O2 + O(3P)</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          valj(3) = valj(3) + qo31d*fff(k,l)       <span class="comment">! O3 -&gt; O2 + O(1D)</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">DO</span> j = 4,<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          <span class="keywordflow">IF</span> (<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,j) &gt; <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,j)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;           tfact = max(0.0,min(1.0,(tt-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,j))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,j)-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,j))))</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;           tfact = 0.e0</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            qqqt    = <a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,j) + (<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,2,j) - <a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,j))*tfact</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            valj(j) = valj(j) + qqqt*fff(k,l)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">!*********Special case for methyl glyoxal************************************************</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">!         The cross section for methyl glyoxal is taken from the IUPAC assessments!         based on the work of Chen et al. (Y. Chen, W. Wang and L. Zhu, J. Phys. Chem. A,</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">!         104 11126 (2000).). This modifies the cross section with a wavelength dependent!         quantum yield:</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">!         1/j =1/j_0 + k*P(N_2 (torrs))*exp(-(5639/lambda(nm)))</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">!         Here k is a constant 19300, P is the pressure of nitrogen in torrs and lambda is!         the wavelength in nm. The value in the code (4.12*10-3) is a weighted average of!         this expression over all wavelengths used by fast-jx (weighting by incident solar</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">!         flux....not perfect but seems to work). This is an approximation used to avoid the</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">!         complexity of having a dependence of the j rate on wavelength online. It has been</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">!         shown to give a good description of the rate in the PHOTOCOMP comparison.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keywordflow">IF</span> (titlej(j) == <span class="stringliteral">&#39;jmkal&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            valj(j) = 1/((1/valj(j))+4.12e-3*pp)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;j-ref v8.3 includes blitz acetone q-yields--acetone <a class="code" href="stparam_8h.xhtml#aaa70885fffc800e7e244e43cb6660283">is</a> <a class="code" href="namespacerand__no__mcica.xhtml#aa9aa2ed2b68a52b1f05e55947969e83a">a</a> special case:   (as per blitz et al grl, 2004)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;-     61 = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>-1 = j1(acetone-<a class="code" href="namespacerand__no__mcica.xhtml#aa9aa2ed2b68a52b1f05e55947969e83a">a</a>) ==&gt; ch3co + ch3</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;-     62 = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>   = j2(acetone-b) ==&gt; ch3 + co + ch3</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">! Note we only use the first channel which means the original fast-jx code</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">! has been modified.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">IF</span> (titlej(<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>) == <span class="stringliteral">&#39;jaceto&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          valj(<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>) = 0.0</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;-iv=<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a> = xsect(total abs) for acetone - pre-calc temp interp factors</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          iv    = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          tfaca = (tt-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,iv)-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv))</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          tfaca = max(0.0, min(1.0, tfaca))</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;-<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+1   = q2 for acetone=&gt;(2), specifically designed for quadratic interp.</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          iv   = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+1</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          tfac0 = ( (tt-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,iv)-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv)) )**2</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          <span class="keywordflow">IF</span> (tt &lt; <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            tfac0 = (tt - 210.e0)/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv)-210.e0)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keywordflow">          END IF</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          tfac0 = max(0.0, min(1.0, tfac0))</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;-iv=<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+2 = q1a for acetone =&gt; (1), allow full range of t = 200k-300k</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          iv    = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+2</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          tt200 = min(300.0, max(200.0, tt))</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          tfac1 = (tt200-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,iv)-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv))</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;-iv=<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+3 = q1b for acetone =&gt; (1)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          iv    = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+3</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          tfac2 = (tt200-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv))/(<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(2,iv)-<a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv))</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;-<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a> = xsect(total abs) for acetone - integrate over wavelengths</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacefastjx__data.xhtml#aeb4afb0628770005f893d1ff7aa27f0b">w_</a></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            iv   = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            qqqa = <a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv) + (<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,2,iv)-<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv))*tfaca</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            -<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+1   = q2 for acetone=&gt;(2), specifically designed for quadratic interp.</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            iv   = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            qq2  = <a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv) + (<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,2,iv)-<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv))*tfac0</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">IF</span> (tt &lt; <a class="code" href="namespacefastjx__data.xhtml#a0920e0f363685e82fba277d6e522f62b">tqq</a>(1,iv)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;              qq2 = <a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv)*tfac0</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            -<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+2 = q1a for acetone =&gt; (1), allow full range of t = 200k-300k</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            iv   = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+2</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            qq1a = <a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv) + (<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,2,iv)-<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv))*tfac1</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            -<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+3 = q1b for acetone =&gt; (1)   <span class="comment">! scaled to [M]=2.5e19</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            iv   = <a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>+3</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            qq1b = <a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv) + (<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,2,iv)-<a class="code" href="namespacefastjx__data.xhtml#ab5306f564f2b6d30b89d5393eabbe6a9">qqq</a>(k,1,iv))*tfac2</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            qq1b = qq1b*4.e-20</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            -j(61)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            valj(<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>) = valj(<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a>)+ fff(k,l)*qqqa*(1.e0-qq2)/(qq1a + qq1b*dd)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        --load <a class="code" href="argspc_8h.xhtml#a3b51acbeb211391bb5a08eeb1d98132e">array</a> of j-values in native <a class="code" href="order_8f90.xhtml#a8b1a12e49ba3f175266fbeb9ddd6e23b" title="Bubble sort of STASH list by model/section/item/input code. ">order</a>, need to be indexed/scaled</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">!    by asad-related code later: zpj(l,jj) = valjl(l,jind(jj))*jfacta(jj)</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">DO</span> j=1,<a class="code" href="namespacefastjx__data.xhtml#aa6f55118dbb4f4b4820d62b35d7a07d6">njval</a></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          valjl(l,j) = valj(j)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordflow">        ENDDO</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordflow">      ENDDO</span>    <span class="comment">! master loop over l=1,jpcl</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">IF</span> (lhook) <span class="keyword">CALL </span>dr_hook(<span class="stringliteral">&#39;FASTJX_JRATET&#39;</span>,zhook_out,zhook_handle)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="fastjx__jratet_8f90.xhtml#a6109094af24eb5a0fdeebaa2a0642997" title="(c) [University of California] [2008]. All rights reserved. (c) [University of California] [2008]...">fastjx_jratet</a></div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
