<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: rfvsl_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">rfvsl_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>LL The U.M. version of this deck was made from the PP module PPRFILT.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8f0885c352e817334c1569d939c4d018"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfacesubroutine.xhtml">subroutine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacerfvsl__mod.xhtml#a8f0885c352e817334c1569d939c4d018">rfvsl</a> (F, N_ROWS, ROW_LENGTH, M_GRID, F_BOUNDARY, COSLAT, <a class="el" href="commg_8h.xhtml#a88c8d0d7520bfbac1e146aaf76816b42">DLAT</a>, <a class="el" href="commg_8h.xhtml#aa4488199dd321a24a8d84330cf846931">DLONG</a>, SCALE, NPASS)</td></tr>
<tr class="separator:a8f0885c352e817334c1569d939c4d018"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>LL The U.M. version of this deck was made from the PP module PPRFILT. </p>
<p>LL The U.M. version of this deck was made from the PP module PPRFILT LL To keep the two codes equivalent, changes should be made to LL PPRFILT, and the U.M. deck re-created from it. LL Instructions for doing this are in PPRFILT. This file belongs in section: AC Assimilation LL SUBROUTINE RFVSL LL RECURSIVE FILTER - VARIABLE COEFF - FOR A SCALAR LTD.AREA FIELD LL DOCUMENTATION: U.M. DOCUMENTATION PAPER 30 "THE ANALYSIS CORRECTION DATA ASSIMILATION SCHEME" SECTION 6.5 </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a8f0885c352e817334c1569d939c4d018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f0885c352e817334c1569d939c4d018">&#9670;&nbsp;</a></span>rfvsl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfacesubroutine.xhtml">subroutine</a> rfvsl_mod::rfvsl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(row_length,n_rows)&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>N_ROWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>ROW_LENGTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>M_GRID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>&#160;</td>
          <td class="paramname"><em>F_BOUNDARY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(n_rows)&#160;</td>
          <td class="paramname"><em>COSLAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>&#160;</td>
          <td class="paramname"><em>DLAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>&#160;</td>
          <td class="paramname"><em>DLONG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(row_length,n_rows)&#160;</td>
          <td class="paramname"><em>SCALE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>NPASS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>NPASS=2 WILL GIVE EQUIVALENT OF SOAR FUNCTION (USUAL) NPASS=LARGE WILL GIVE EQUIVALENT OF GAUSSIAN FUNCTION </td></tr>
  </table>
  </dd>
</dl>
<p>*!&gt; PROGRAMMING NOTES THE ORDER OF NESTING OF DOUBLE LOOPS ON JPT &amp; JROW IS OPTIONAL. SUCH LOOPS ARE INDICATED BY !&gt;)) ON THE ENDDO STATEMENT. THE LOOP IN THE DIRECTION OF FILTERING IS RECURSIVE, AND SO CANNOT BE VECTORIZED; HERE IT IS MADE THE OUTER LOOP. A SCALAR COMPUTER MAY BE MORE EFFICIENT WITH A RECURSIVE INNER</p>
<p>THE INPUT FIELD IS F FIRST PASS IN ONE DIRECTION GIVES G (OVERWRITING ARRAY F): G(I)=A(I)*G(I-1)+B(I)*F(I) : I=1,N PASS IN OPPOSITE DIRECTION GIVES H (OVERWRITING ARRAY F): H(I)=A(I)*H(I+1)+B(I)*G(I) : I=N,1 FOR FILTER ALONG ROW (CALLED E-W-E IN COMMENTS) THE GRID IS REGULAR, SO B=1-A, AND A IS PRECALCULATED. FOR FILTER OF LIMITED AREA THE GRID IS ASSUMED REGULAR, SO B=1-A, AND A IS PRECALCULATED. BECAUSE OF THIS APPROX, THE GRID SHOULD NOT GO NEAR POLE.</p>
<p>*L NO EXTERNAL SUBROUTINE CALLS</p>
<p>L*** PRECALCULATE COEFFICIENTS </p><pre class="fragment">   USING 6.5.13 &amp; 6.5.9 </pre><pre class="fragment">  STRICTLY, SCALE SHOULD BE AVERAGE JPT &amp; JPT+(-)1 FOR W-&gt;E (E-&gt;W)
   NOT DOING SO MAKES THE CODE SIMPLER.
   SINCE SCALE IS SMOOTH, THE DIFFERENCE IS NEGLIGABLE. </pre><pre class="fragment">   USING 6.5.13 &amp; 6.5.9 </pre><pre class="fragment">  STRICTLY, SCALE SHOULD BE AVERAGE JROW &amp; JROW+(-)1
   NOT DOING SO MAKES THE CODE SIMPLER.
   SINCE SCALE IS SMOOTH, THE DIFFERENCE IS NEGLIGABLE. </pre>
<p class="definition">Definition at line <a class="el" href="rfvsl_8f90_source.xhtml#l00025">25</a> of file <a class="el" href="rfvsl_8f90_source.xhtml">rfvsl.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacerfvsl__mod_a8f0885c352e817334c1569d939c4d018_cgraph.svg" width="226" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacerfvsl__mod_a8f0885c352e817334c1569d939c4d018_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
