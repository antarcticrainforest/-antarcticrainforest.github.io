<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/utility/fieldcalc/io_mod.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_0619a8f54b4fad7043a6de45be8fde0b.xhtml">utility</a></li><li class="navelem"><a class="el" href="dir_925d6107435631a137c191c3b43797c1.xhtml">fieldcalc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">io_mod.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="io__mod_8f90.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="namespaceio__mod.xhtml">    5</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespaceio__mod.xhtml" title="Module containing derived types used for IO in Fieldcalc. ">io_mod</a></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">! Description:</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespaceereport__mod.xhtml" title="This file belongs in section: Misc. ">ereport_mod</a><span class="keywordtype">, ONLY</span> : <a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="namespaceio__mod.xhtml#a3d023e0499687b513b267a53e94fafb1">   20</a></span>&#160;<span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: <a class="code" href="namespaceio__mod.xhtml#a3d023e0499687b513b267a53e94fafb1" title="Global Constants: ">lenfixhd</a> = 256   <span class="comment">! Length of Fixed_Length_Header</span></div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="namespaceio__mod.xhtml#a5596ff9637e218851596fb71eeb820d0">   21</a></span>&#160;<span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: <a class="code" href="namespaceio__mod.xhtml#a5596ff9637e218851596fb71eeb820d0">lenword</a>  = 64</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml">   24</a></span>&#160;<span class="keyword">TYPE</span> <a class="code" href="structio__mod_1_1pp__header__type.xhtml" title="Global Type Definitions: ">pp_header_type</a></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  sequence</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a57669672e2245e93c61a01a904ade7fb">   26</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: validyear    = -99  <span class="comment">! 1  LBYR   : Year       \ .</span></div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#aa4774a6742108da93efada3134889e54">   27</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: validmonth   = -99  <span class="comment">! 2  LBMON  : Month       \ .</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a10c3c8acb6d32fc96a011923fddc68c3">   28</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: validdate    = -99  <span class="comment">! 3  LBDAT  : Day          \  Validity time</span></div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a6830187b3f66f95e6f64643daa8e1b58">   29</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: validhour    = -99  <span class="comment">! 4  LBHR   : Hour         / .</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a8b991c007c6366226eda4e2f3b0f5bf0">   30</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: validmin     = -99  <span class="comment">! 5  LBMIN  : Minute      / .</span></div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a5ed43df5d21a6bff903388d192ababc7">   31</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: validsec     = -99  <span class="comment">! 6  LBSEC  : Second     / .</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a43f6e1481862bf5399463f41cee19ec1">   32</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: datayear     = -99  <span class="comment">! 7  LBYRD  : Year       \ .</span></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a540992f5ce2caa0ddb1222904ba86270">   33</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: datamonth    = -99  <span class="comment">! 8  LBMOND : Month       \ .</span></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a1b88bd72bb71fcbfef00a0b85aca523f">   34</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: datadate     = -99  <span class="comment">! 9  LBDATD : Day          \ Data time</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a16a2243d91906ca4594a48ee73df4088">   35</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: datahour     = -99  <span class="comment">! 10 LBHRD  : Hour         / .</span></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#afcf0095473fac9c09421702c67be95a2">   36</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: datamin      = -99  <span class="comment">! 11 LBMIND : Minute      / .</span></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a581feb8973f1c0e5f35689e2de253164">   37</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: datasec      = -99  <span class="comment">! 12 LBSECD : Second     / .</span></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#ac0c71a0c30805e87d20a09974dc41f08">   38</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a27c45d3289bc2f747dd0912b6909cae1">lbtim</a>        = -99  <span class="comment">! 13          Time indicator</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#ab781affa45936004c87a6416076af1d2">   39</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: fcrange      = -99  <span class="comment">! 14 LBFT   : Forecast range (hrs)</span></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#aa92af31a3fc37588d0f6498a9e6c1f8c">   40</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#ab82991ff70c45e8f733b4446f83e0556">lblrec</a>       = -99  <span class="comment">! 15          Length of data record</span></div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a7f0e10f97a76fa9019ab12288e4707bf">   41</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a9ceed0d519c54f7fa8446efa09279428">lbcode</a>       = -99  <span class="comment">! 16          Grid type code</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a49432cd538e60d3f5bb72c16dd243011">   42</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a1a73e7452b09315ded35e3b6ef082e6b">lbhem</a>        = -99  <span class="comment">! 17          Hemisphere indicator</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a9842c6791148e8a556ef3e4b050a0ee7">   43</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: numrows      = -99  <span class="comment">! 18 LBROW  : Number of rows in grid</span></div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a268a27765a1cd028ad336c44a89eeb28">   44</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: numcols      = -99  <span class="comment">! 19 LBNPT  : Number of columns in grid</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a399bf89eac9d0171e56cac73ba8752e0">   45</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a36fe53c5769dee10ac1c6609f9fa6c2d">lbext</a>        = -99  <span class="comment">! 20          Length of extra data</span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#ad8a3c1fd41fecab07b9bd9982b96938e">   46</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a506fad965bad508479cafb725dd659f1">lbpack</a>       = -99  <span class="comment">! 21          Packing method indicator</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a64794275816cc71b4d45d879fe8a32ea">   47</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#aca3499f4f66ac530900eed38efcd282d">lbrel</a>        = -99  <span class="comment">! 22          Header release number</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a0696cd5fc0312f80f7695697cc4733af">   48</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: ppcode       = -99  <span class="comment">! 23 LBFC   : Field code</span></div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#abbca754ce420fa14f2362cfd7e838030">   49</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a2966aa1e49d6db3ab951f80a5b207ca2">lbcfc</a>        = -99  <span class="comment">! 24          Second field code</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a8fd2ec867c7bd1e98589717a061a159e">   50</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a6d3e005221e5b6baf748473338310a4d">lbproc</a>       = -99  <span class="comment">! 25          Processing code</span></div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a3718b66008f7040eb01e90984f7ce577">   51</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#ac5368d5328a741c1544bc7034ae08ca9">lbvc</a>         = -99  <span class="comment">! 26          Vertical co-ordinate type</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a166eb5ceb671ea185f69556676225a2a">   52</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#add55cfea58254f3473f97e61f8805f5f">lbrvc</a>        = -99  <span class="comment">! 27          Vert co-ord type for reference</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a0cc863e6aab0cd8bd1c389a3b61ec8e3">   53</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a86abca3a266da7a50eaa22a400b5c981">lbexp</a>        = -99  <span class="comment">! 28          Experiment number</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a2cd1c6b460bd39d576fb2b7383085207">   54</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: datapos      = -99  <span class="comment">! 29 LBEGIN : Word address of data</span></div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a6047eca38091e68e43a923436a58930c">   55</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a7fbd5df41f854a6fd5c4d35c0942742e">lbnrec</a>       = -99  <span class="comment">! 30          Disk length / No. records</span></div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#ae1c8cf4d860e33014fb897b020f9314f">   56</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: mo8proj      = -99  <span class="comment">! 31 LBPROJ : MetO8 Projection number</span></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a99bf14b6c302dc4cdcc53bcec369b63b">   57</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: mo8type      = -99  <span class="comment">! 32 LBTYP  : MetO8 Field Type</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a638e38f549aa7f0173b64393976ae7a2">   58</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: mo8level     = -99  <span class="comment">! 33 LBLEV  : MetO8 Level code</span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a1d760948c26e212e1b0025f8f20508f8">   59</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lbrsvd(4)    = -99  <span class="comment">! 34-37       PP-Package use</span></div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a62f4d273461781cdbb37aa7bd0110747">   60</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#ac178e82d12ff823280549231208bfd06">lbsrce</a>       = -99  <span class="comment">! 38          Version &amp; Model</span></div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a221801ae6b67d69089a31dab011d100a">   61</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lbuser1      = -99  <span class="comment">! 39          Data type (real, etc.) (UM only)</span></div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a12fe5d339470bef5f6986f0492976e55">   62</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lbuser2      = -99  <span class="comment">! 40          Start address in DATA (UM only)</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#ae0be2bc83a843a7648ed4a4eb52618cf">   63</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a84e97776b87c2cbd9045f416117be038">lbuser3</a>      = -99  <span class="comment">! 41          No. periods for timeseries</span></div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a8c7e670b1556ce3392566945e7ac7b7d">   64</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: stcode       = -99  <span class="comment">! 42          STASH code (UM only)</span></div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a7b5bdc65d0c8546194587eaafbc572bc">   65</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lbuser5      = -99  <span class="comment">! 43          STASH pseudo dimension (UM only)</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a8f70b200823ef1a723eaa6d860ca496d">   66</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelookup__addresses.xhtml#a4a19df2a3e312b29a477f86438c119f7">lbuser6</a>      = -99  <span class="comment">! 44          Free (used by FIELDCOS)</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#af96fdc3a20c615699bacc20a71db6d33">   67</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lbuser7      = -99  <span class="comment">! 45          Sub-model number (UM only)</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#afde1bded8efa4aaeead8ea52c7b416b5">   68</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#ab6de8d16584bb54653563c6a291060ec">bulev</a>        = -99. <span class="comment">! 46          Upper layer boundary</span></div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a6874350dea548de9d525b6d7a17112b8">   69</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#a4cc6195029c0a3039a8f62cc875613ed">bhulev</a>       = -99. <span class="comment">! 47          Upper layer boundary</span></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a6d4469dde983a17441f8fa0293091027">   70</a></span>&#160;  <span class="keywordtype">REAL</span>    :: brsvd(2)     = -99. <span class="comment">! 48-49       PP-Package use</span></div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a16d9f6dd122daf9a3ffe5f56d709ae47">   71</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#a34b7cbb87375ff891391c99701e2123b">bdatum</a>       = -99. <span class="comment">! 50          Datum value</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a7e84affee4bd182011179a182b761eb8">   72</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#a82f90fd378e614ed7aabca4f5aaeae8d">bacc</a>         = -99. <span class="comment">! 51          Packing accuracy</span></div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a00166ffd2a0e4cd89112dd7d284ded47">   73</a></span>&#160;  <span class="keywordtype">REAL</span>    :: rlevel       = -99. <span class="comment">! 52 BLEV   : Level (B or Zsea for hybrid)</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#ab262201496ba2cde093df663c7cfc911">   74</a></span>&#160;  <span class="keywordtype">REAL</span>    :: reflevel     = -99. <span class="comment">! 53 BRLEV  : Reference level - lower layer bd</span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#ae407a1e60fc9c252ad5eca474397e0be">   75</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#a4b23775daa91e9b4713768ad387e843e">bhlev</a>        = -99. <span class="comment">! 54          Level (A or C for hybrid)</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a8d7e7de06968c0b5862a3dee395bc8a2">   76</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#a42310048e52394f48d32c5e0610e902f">bhrlev</a>       = -99. <span class="comment">! 55          Lower layer boundary</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a50fbcd75faa653c35b282e40ddc9029c">   77</a></span>&#160;  <span class="keywordtype">REAL</span>    :: pseudolat    = -99. <span class="comment">! 56 BPLAT  : Real lat of &#39;pseudo&#39; N Pole</span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a1ceb7e093de43a64138b83e005c424d8">   78</a></span>&#160;  <span class="keywordtype">REAL</span>    :: pseudolon    = -99. <span class="comment">! 57 BPLON  : Real lon of &#39;pseudo&#39; N Pole</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a5725623bd243c42727fac11be406822e">   79</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#a89887ae484e3d32ef5a3d888e631f926">bgor</a>         = -99. <span class="comment">! 58          Grid orientation</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#accb8b5055aabb0940a6b94ee40443478">   80</a></span>&#160;  <span class="keywordtype">REAL</span>    :: zerothlat    = -99. <span class="comment">! 59 BZY    : Zeroth latitude</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a198de692450c5128649a693427d0211d">   81</a></span>&#160;  <span class="keywordtype">REAL</span>    :: latint       = -99. <span class="comment">! 60 BDY    : Latitude interval</span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a6e9a0cb766e909c541d0fd5a81044bb3">   82</a></span>&#160;  <span class="keywordtype">REAL</span>    :: zerothlon    = -99. <span class="comment">! 61 BZX    : Zeroth longitude</span></div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a348b29e86bbe44f846ff5bbc7f24d644">   83</a></span>&#160;  <span class="keywordtype">REAL</span>    :: lonint       = -99. <span class="comment">! 62 BDX    : Longitude interval</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#a80427f6bc3bd7e0d14d9f5f12d698575">   84</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#aab140d56b5d424c50e71824cdee926c5">bmdi</a>         = -99. <span class="comment">! 63          Missing data indicator</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__header__type.xhtml#af4f29f32607f18e326e6a045aa060fda">   85</a></span>&#160;  <span class="keywordtype">REAL</span>    :: <a class="code" href="namespacelookup__addresses.xhtml#ae1943e1fea075c215b137cecfb4ca168">bmks</a>         = -99. <span class="comment">! 64          M.K.S. scaling factor</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">END TYPE </span><a class="code" href="structio__mod_1_1pp__header__type.xhtml" title="Global Type Definitions: ">pp_header_type</a></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__field__type.xhtml">   89</a></span>&#160;<span class="keyword">TYPE</span> <a class="code" href="structio__mod_1_1pp__field__type.xhtml">pp_field_type</a></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__field__type.xhtml#a7c80a3ef95e29ea0e818d16655e0edb5">   91</a></span>&#160;  <span class="keywordtype">INTEGER</span>              :: lookuppos   <span class="comment">! No of header in lookup</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__field__type.xhtml#a777eea587f0390e44fbbd377570c83e0">   92</a></span>&#160;  <span class="keywordtype">INTEGER</span>              :: arraypos    <span class="comment">! No of header in Fields array</span></div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__field__type.xhtml#a82e26e902844b0ef876e6c4f6ba3f8f7">   93</a></span>&#160;  <span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span>        :: rdata(:,:) =&gt; null()</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structio__mod_1_1pp__field__type.xhtml#a2e198e752364338846344eedcf98eefe">   94</a></span>&#160;  <span class="keywordtype">TYPE</span>(<a class="code" href="structio__mod_1_1pp__header__type.xhtml" title="Global Type Definitions: ">pp_header_type</a>) :: hdr</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">END TYPE </span><a class="code" href="structio__mod_1_1pp__field__type.xhtml">pp_field_type</a></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml">   98</a></span>&#160;<span class="keyword">TYPE</span> <a class="code" href="structio__mod_1_1um__header__type.xhtml">um_header_type</a></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a52e1857d81825754d27ea5f575671040">  100</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lenintc       <span class="comment">! Length of Integer_Constants array</span></div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a23311d3cb077d2bbba511eac25d7e424">  101</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lenrealc      <span class="comment">! Length of Real_Constants array</span></div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a5204564f3c3ed8ee14326fc558c81d3c">  102</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len1levdepc   <span class="comment">! 1st dim \ Level_Dependent_Constants</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#aef5f5eac318550d7dbf042a8ba748319">  103</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len2levdepc   <span class="comment">! 2nd dim / array</span></div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#ab53a09a8fbda76cf3607c34968345110">  104</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len1rowdepc   <span class="comment">! 1st dim \ Row_Dependent_Constants</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a8e93e97b2f7d16b975b7be81858b45c0">  105</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len2rowdepc   <span class="comment">! 2nd dim / array</span></div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a840afc966ea87b8aabf9f1c481c0e952">  106</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len1coldepc   <span class="comment">! 1st dim \ Column_Dependent_Constants</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a5caf8c996287c7bfdf3559133c4226ff">  107</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len2coldepc   <span class="comment">! 2nd dim / array</span></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a5730f24463e0be8b75a4035e83742396">  108</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len1fldsofc   <span class="comment">! 1st dim \ Fields_Of_Constants</span></div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#ada47e8e70d6253580d261031c2868c2e">  109</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len2fldsofc   <span class="comment">! 2nd dim / array</span></div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#aa136afb83bfcba1f41bcf61595969960">  110</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lenextrac     <span class="comment">! Length of Extra_Constants array</span></div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#ae5953f74d6895c1d26992b07fee5e202">  111</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lenhistfile   <span class="comment">! Length of Temp_History_File</span></div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#aaac7988371d65a64223e87686819cb9c">  112</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lencompfldi1  <span class="comment">! Length of Compressed_Field_Index1</span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a92fd121dc38c1fc7c14f8ffef8713a82">  113</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lencompfldi2  <span class="comment">! Length of Compressed_Field_Index2</span></div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#adb020a5faf358f9d8374311e6f26608b">  114</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lencompfldi3  <span class="comment">! Length of Compressed_Field_Index3</span></div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#aeb08455a35905c5053e59b8516edb708">  115</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len1lookup    <span class="comment">! 1st dim \ Lookup table</span></div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a4acc626248efd38db229c462e404ef87">  116</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: len2lookup    <span class="comment">! 2nd dim /</span></div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#acdbbad1d45b000f4bbe61ae38175027e">  117</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: lendata       <span class="comment">! Length of Data array</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a0e67fe1f18df8d7009ac7a1dd9b7cbf8">  118</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: startdata     <span class="comment">! Position of start of Data array</span></div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a40a050d470343d72f7cc888bf344de73">  119</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: numflds       <span class="comment">! Number of Data fields</span></div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#ac372a8a7f60630c8c0c40b087a382f59">  120</a></span>&#160;  <span class="keywordtype">INTEGER</span> :: unitnum       <span class="comment">! Unit number associated with UM dump</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#af50705a429b04afd3b3a72d08683fd44">  122</a></span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">POINTER</span> :: fixhd(:)     =&gt; null()   <span class="comment">! Fixed_Length_Header</span></div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#abe23f48b4d6e4bd01697b1d1e30d0614">  123</a></span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">POINTER</span> :: intc(:)      =&gt; null()   <span class="comment">! Integer_Constants array</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#ae79147da4ef39975e44df9aca47d1373">  124</a></span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">POINTER</span> :: compfldi1(:) =&gt; null()   <span class="comment">! Compressed_Field_Index1 array</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#ab11a8dabf7fb44b02429ca526161cd89">  125</a></span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">POINTER</span> :: compfldi2(:) =&gt; null()   <span class="comment">! Compressed_Field_Index2 array</span></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a18d27fe32f55e74297dbe656ded0428b">  126</a></span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">POINTER</span> :: compfldi3(:) =&gt; null()   <span class="comment">! Compressed_Field_Index3 array</span></div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#afce30e90daf0e0959d628b816c3afc44">  127</a></span>&#160;  <span class="keywordtype">TYPE</span>(<a class="code" href="structio__mod_1_1pp__header__type.xhtml" title="Global Type Definitions: ">pp_header_type</a>), <span class="keywordtype">POINTER</span> :: lookup(:) =&gt; null() <span class="comment">! Lookup table</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#abf1de5a6115d5f8254729e4985584806">  129</a></span>&#160;  <span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: realc(:)    =&gt; null()</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a45aaddb6f6ee19dd5e591d13cb7216cc">  130</a></span>&#160;  <span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: levdepc(:)  =&gt; null()</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#ae19edb6afd0e9d105fffed27b3967f92">  131</a></span>&#160;  <span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: rowdepc(:)  =&gt; null()</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a2639cf6ce873846a13021b074e8e74f9">  132</a></span>&#160;  <span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: coldepc(:)  =&gt; null()</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a7f421748a4df449703fad9f12c70e12c">  133</a></span>&#160;  <span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: fldsofc(:)  =&gt; null()</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a64a8ebe89d3cfd1f7787652abdc3fab7">  134</a></span>&#160;  <span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: extrac(:)   =&gt; null()</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a0b05d8c6d56f7efc80ea30859c0866f9">  135</a></span>&#160;  <span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: histfile(:) =&gt; null()</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structio__mod_1_1um__header__type.xhtml#a766a554d822d4c35a842733bc6041821">  137</a></span>&#160;  <span class="keywordtype">CHARACTER(LEN=16)</span> :: filenameenv</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">END TYPE </span><a class="code" href="structio__mod_1_1um__header__type.xhtml">um_header_type</a></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">! Needed to unpack land/sea-packed fields - requires SAVE attribute due to</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">! default initialisation within PP_Field_type and is inside a module.</span></div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="namespaceio__mod.xhtml#a00c316d0e956ece7ec75edd79516401e">  143</a></span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structio__mod_1_1pp__field__type.xhtml">pp_field_type</a>), <span class="keywordtype">SAVE</span>  :: <a class="code" href="namespaceio__mod.xhtml#a00c316d0e956ece7ec75edd79516401e">lsmfield</a>       <span class="comment">! Land-sea mask PP-Field</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">CONTAINS</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="namespaceio__mod.xhtml#a945e6990ceb804a96255b3b8fd1459b8">buffin_um_lookup</a>(header,length,error)</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="namespaceio__mod.xhtml#a945e6990ceb804a96255b3b8fd1459b8">  147</a></span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceio.xhtml" title="Code Owner: See Unified Model Code owners HTML page. ">io</a><span class="keywordtype">, ONLY</span> :              &amp;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        buffin,                 &amp;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="namespaceio.xhtml#a6eff09a3646b168907ebda58a5355b2a">setpos</a></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceerr__mod.xhtml" title="Module containing error codes for Fieldcalc. ">err_mod</a><span class="keywordtype">, ONLY</span>:          &amp;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="namespaceerr__mod.xhtml#ae2b7f5c34be48b8e246e1fa3c003dce8" title="Method: ">statusok</a>,               &amp;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="namespaceerr__mod.xhtml#abef63b1aad05f1f96cfa12dbf6091abc">statuswarning</a></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceereport__mod.xhtml" title="This file belongs in section: Misc. ">ereport_mod</a><span class="keywordtype">, ONLY</span> : <a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structio__mod_1_1um__header__type.xhtml">um_header_type</a>), <span class="keywordtype">INTENT(INOUT)</span> :: header</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(OUT)</span> :: length</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(OUT)</span>    :: error</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">INTEGER</span>              :: ErrorStatus</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: buffer(:)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespaceio.xhtml#a6eff09a3646b168907ebda58a5355b2a">setpos</a> ( header % UnitNum, header % FixHd(150)-1, errorstatus )</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">IF</span> ( errorstatus /= <a class="code" href="namespaceerr__mod.xhtml#ae2b7f5c34be48b8e246e1fa3c003dce8" title="Method: ">statusok</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a>( <span class="stringliteral">&quot;io_mod::buffin_um_lookup&quot;</span>,   &amp;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          errorstatus, <span class="stringliteral">&quot;Failure in SETPOS&quot;</span> )</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keywordflow">    END IF</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keyword">ALLOCATE</span>(buffer(header % Len1Lookup * header % Len2Lookup))</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keyword">CALL </span>buffin(header % UnitNum, buffer,         &amp;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        header % Len1Lookup * header % Len2Lookup,length,error)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">CALL </span>um_memcpy_f( header % lookup , buffer ,  &amp;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        header % Len1Lookup * header % Len2Lookup)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">DEALLOCATE</span>(buffer)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="namespaceio__mod.xhtml#a945e6990ceb804a96255b3b8fd1459b8">buffin_um_lookup</a></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="namespaceio__mod.xhtml#a852adf88d39b2a2f9de414a308c76421">buffout_um_lookup</a>(header,length,error)</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="namespaceio__mod.xhtml#a852adf88d39b2a2f9de414a308c76421">  179</a></span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceio.xhtml" title="Code Owner: See Unified Model Code owners HTML page. ">io</a><span class="keywordtype">, ONLY</span> :              &amp;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        buffout,                &amp;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="namespaceio.xhtml#a6eff09a3646b168907ebda58a5355b2a">setpos</a></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceerr__mod.xhtml" title="Module containing error codes for Fieldcalc. ">err_mod</a><span class="keywordtype">, ONLY</span>:          &amp;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="namespaceerr__mod.xhtml#ae2b7f5c34be48b8e246e1fa3c003dce8" title="Method: ">statusok</a>,               &amp;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <a class="code" href="namespaceerr__mod.xhtml#abef63b1aad05f1f96cfa12dbf6091abc">statuswarning</a></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceereport__mod.xhtml" title="This file belongs in section: Misc. ">ereport_mod</a><span class="keywordtype">, ONLY</span> : <a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structio__mod_1_1um__header__type.xhtml">um_header_type</a>), <span class="keywordtype">INTENT(IN)</span> :: header</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(OUT)</span> :: length</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(OUT)</span>    :: error</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">INTEGER</span>              :: ErrorStatus</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: buffer(:)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespaceio.xhtml#a6eff09a3646b168907ebda58a5355b2a">setpos</a> ( header % UnitNum, header % FixHd(150)-1, errorstatus )</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">IF</span> ( errorstatus /= <a class="code" href="namespaceerr__mod.xhtml#ae2b7f5c34be48b8e246e1fa3c003dce8" title="Method: ">statusok</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a>( <span class="stringliteral">&quot;io_mod::buffout_um_lookup&quot;</span>,   &amp;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          errorstatus, <span class="stringliteral">&quot;Failure in SETPOS&quot;</span> )</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordflow">    END IF</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">! Even though we only have &quot;header % NumFlds&quot; values we also want to write</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">! out the unused lookup to allow other programs to recognise when the lookups</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">! end.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keyword">ALLOCATE</span>(buffer(header % Len1Lookup * header % Len2Lookup))</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keyword">CALL </span>um_memcpy_f(buffer, header % lookup ,     &amp;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        header % Len1Lookup * header % Len2Lookup)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">CALL </span>buffout(header % UnitNum, buffer,         &amp;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        header % Len1Lookup * header % Len2Lookup,length,error)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keyword">DEALLOCATE</span>(buffer)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="namespaceio__mod.xhtml#a852adf88d39b2a2f9de414a308c76421">buffout_um_lookup</a></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespaceio__mod.xhtml" title="Module containing derived types used for IO in Fieldcalc. ">io_mod</a></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
