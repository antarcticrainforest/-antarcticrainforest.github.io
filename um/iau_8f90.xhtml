<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/atmosphere/AC_assimilation/iau.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_1df14ea1ac826f73bc3062fa8a76e0c2.xhtml">atmosphere</a></li><li class="navelem"><a class="el" href="dir_5477e5296db3a3418fff85838c21a0ef.xhtml">AC_assimilation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">iau.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="iau_8f90_source.xhtml">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a0f8a69ad9f632c479e55cb582efcb452"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfacesubroutine.xhtml">subroutine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iau_8f90.xhtml#a0f8a69ad9f632c479e55cb582efcb452">iau</a> ( include</td></tr>
<tr class="memdesc:a0f8a69ad9f632c479e55cb582efcb452"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main routine for IAU scheme.  <a href="#a0f8a69ad9f632c479e55cb582efcb452">More...</a><br /></td></tr>
<tr class="separator:a0f8a69ad9f632c479e55cb582efcb452"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a0f8a69ad9f632c479e55cb582efcb452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f8a69ad9f632c479e55cb582efcb452">&#9670;&nbsp;</a></span>iau()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfacesubroutine.xhtml">subroutine</a> iau </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>include</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main routine for IAU scheme. </p>
<p>Main routine for IAU scheme </p>
<p>Main routine for the Incremental Analysis Update (IAU) scheme, as described in UMDP 31.</p>
<p>Model fields can be updated in two ways:</p>
<ol type="1">
<li>Directly, via corresponding increment fields in a series of IAU increment files.</li>
<li>Indirectly, via the increments to other variables.</li>
</ol>
<p>Currently, direct incrementing is supported for the following fields:</p>
<p>u, v, w, theta, rho, exner, p, q, qCL, qCF, murk (aerosol), ozone, sfctemp, soilm, dust_div1-6</p>
<p>theta, rho and exner may also be updated indirectly via the following relationships:</p>
<p>theta - hydrostatic equation rho - equation of state exner - expression in terms of p</p>
<p>These three options are activated via namelist switches. When one of these is activated, direct updates to the corresponding field are switched off.</p>
<p>As well as the above set of fields, the IAU increment files may also contain increments to the total specific humidity qT. When qT increments are available, there are two options: (1) use the routine Var_DiagCloud to diagnose increments to q, qCL and (optionally) qCF, or (2) add qT' to q.!&gt; Direct and indirect increments to q, qCL or qCF are not allowed on the same timestep.</p>
<p>When the PC2 cloud scheme is in use, direct updates to q, qCL or qCF are followed up by adjustments to q, qCL and theta to ensure compatibilty with the scheme.</p>
<p>There is also an option to pass the level-one temperature increments on to the surface temperature fields (TStar and TStar_tile) at land points, and the top-level soil temperature (TSoil(1)) field.</p>
<p>Sfctemp and soilm are used as initial perturbations in ensemble forecasts. Sfctemp is passed to TStar (at all points) and to TStar_tile and TSoil(1) over land. Soilm is passed to all levels of smcl. These fields are automatically processed if present in the increment file.</p>
<p>Increments to u, v, and w are always passed on to their advected counterparts u_adv, v_adv and w_adv. !&gt; At the end of the routine two options are available to limit humidity and cloud. The first option is to remove supersaturation wrt water. The second is to apply limits to tropospheric and non-troposphere humidities via the routine QLimits, which also removes cloud outside the troposphere. The frequency with which QLimits is called is controlled via a namelist variable. For example, it can be called on every IAU call for which increments are to be added, or only at the end of the IAU insertion period.</p>
<p>Finally, in order to minimise problems with the spin-down in precipitation following the addition of an analysis increment, options are available to modify the output of the cloud incrementing operator (Var_DiagCloud). Also, the removal of supersaturation noted above can be done with respect to a scaled value of qsat.</p>
<p>This file belongs in section: AC Assimilation</p>
<p>Language: Fortran 90. This code is written to UMDP3 version 8.1 programming standards.</p>
<p>Declarations: </p>

<p class="definition">Definition at line <a class="el" href="iau_8f90_source.xhtml#l00007">7</a> of file <a class="el" href="iau_8f90_source.xhtml">iau.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="iau_8f90_a0f8a69ad9f632c479e55cb582efcb452_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="iau_8f90_a0f8a69ad9f632c479e55cb582efcb452_icgraph.svg" width="618" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
