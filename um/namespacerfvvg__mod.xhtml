<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: rfvvg_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">rfvvg_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>LL The U.M. version of this deck was made from the PP module PPRFILT.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a9bcaa92aa58cd494d033a974d3a61edb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfacesubroutine.xhtml">subroutine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacerfvvg__mod.xhtml#a9bcaa92aa58cd494d033a974d3a61edb">rfvvg</a> (U, <a class="el" href="arg__atm__fields_8h.xhtml#a1aa25504a992d05a2170c5376ad453fc">V</a>, N_ROWS, ROW_LENGTH, M_GRID, COSLAT, FIRSTROW, <a class="el" href="commg_8h.xhtml#a88c8d0d7520bfbac1e146aaf76816b42">DLAT</a>, <a class="el" href="commg_8h.xhtml#aa4488199dd321a24a8d84330cf846931">DLONG</a>, SCALE, NPASS)</td></tr>
<tr class="separator:a9bcaa92aa58cd494d033a974d3a61edb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>LL The U.M. version of this deck was made from the PP module PPRFILT. </p>
<p>LL The U.M. version of this deck was made from the PP module PPRFILT LL To keep the two codes equivalent, changes should be made to LL PPRFILT, and the U.M. deck re-created from it. LL Instructions for doing this are in PPRFILT. LL This file belongs in section: AC Assimilation LL SUBROUTINE RFVVG LL RECURSIVE FILTER - VARIABLE COEFF - FOR A VECTOR GLOBAL FIELD LL DOCUMENTATION: </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a9bcaa92aa58cd494d033a974d3a61edb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bcaa92aa58cd494d033a974d3a61edb">&#9670;&nbsp;</a></span>rfvvg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfacesubroutine.xhtml">subroutine</a> rfvvg_mod::rfvvg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(row_length,n_rows)&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(row_length,n_rows)&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>N_ROWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>ROW_LENGTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>M_GRID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(n_rows)&#160;</td>
          <td class="paramname"><em>COSLAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>&#160;</td>
          <td class="paramname"><em>FIRSTROW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>&#160;</td>
          <td class="paramname"><em>DLAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>&#160;</td>
          <td class="paramname"><em>DLONG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(row_length,n_rows)&#160;</td>
          <td class="paramname"><em>SCALE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>NPASS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">firstrow</td><td>EXCEPT FOR ROWS AT POLE, WHICH HAVE COSLAT(1)=COSLAT(2)/8 &amp; COSLAT(NNS)=COSLAT(NNS-1)/8 IF M_GRID=1. TO ALLOW FOR THE NON-ZERO AREA OF GRID TRIANGLE SEGMENTS AT POLE</td></tr>
    <tr><td class="paramname">u</td><td>NPASS=2 WILL GIVE EQUIVALENT OF SOAR FUNCTION (USUAL) NPASS=LARGE WILL GIVE EQUIVALENT OF GAUSSIAN FUNCTION </td></tr>
  </table>
  </dd>
</dl>
<p>*!&gt; PROGRAMMING NOTES THE ORDER OF NESTING OF DOUBLE LOOPS ON JPT &amp; JROW IS OPTIONAL. SUCH LOOPS ARE INDICATED BY !&gt;)) ON THE ENDDO STATEMENT. THE LOOP IN THE DIRECTION OF FILTERING IS RECURSIVE, AND SO CANNOT BE VECTORIZED; HERE IT IS MADE THE OUTER LOOP, AND ZU IS A TEMPORARY VECTOR, SO THE INNER LOOP CAN BE VECTORIZED. A SCALAR COMPUTER MAY BE MORE EFFICIENT WITH A RECURSIVE INNER LOOP, WITH ZU IN A TEMPORARY SCALAR.</p>
<p>THIS FILTER IS THE SAME AS THAT OF A SCALAR FIELD (SEE RFVSG) EXCEPT FOR A ROTATION COSLAT*DLONG FROM PT TO PT ALONG EACH ROW.</p>
<p>THE INPUT FIELD IS A VECTOR F=(U,V) FIRST PASS IN ONE DIRECTION GIVES VECTOR G (OVERWRITING ARRAY F): G(I)=A(I)*G(I-1)+B(I)*F(I) : I=1,N PASS IN OPPOSITE DIRECTION GIVES VECTOR H (OVERWRITING ARRAY F): H(I)=C(I)*H(I+1)+D(I)*G(I) : I=N,1 FOR FILTER ALONG ROW (CALLED E-W-E IN COMMENTS) THE GRID IS REGULAR, SO D=B=1-C=1-A, AND A IS PRECALCULATED. FOR FILTER ALONG COLUMNS (CALLED N-S-N IN COMMENTS) THE GRID BOX SIZE CHANGES, SO A B C D ARE CALCULATED TO ALLOW FOR THIS. A B C D ARE ALPHA BETA GAMA DELTA IN DOCUMENTATION C IS STORED IN A, D IS STORED IN B.</p>
<p>*L NO EXTERNAL SUBROUTINE CALLS </p>

<p class="definition">Definition at line <a class="el" href="rfvvg_8f90_source.xhtml#l00024">24</a> of file <a class="el" href="rfvvg_8f90_source.xhtml">rfvvg.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacerfvvg__mod_a9bcaa92aa58cd494d033a974d3a61edb_cgraph.svg" width="236" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacerfvvg__mod_a9bcaa92aa58cd494d033a974d3a61edb_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
