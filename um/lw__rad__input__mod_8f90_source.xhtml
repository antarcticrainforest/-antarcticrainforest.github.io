<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/atmosphere/radiation_control/lw_rad_input_mod.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_1df14ea1ac826f73bc3062fa8a76e0c2.xhtml">atmosphere</a></li><li class="navelem"><a class="el" href="dir_f3ced4ca4d97f20ad26ce2534c2046c2.xhtml">radiation_control</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">lw_rad_input_mod.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lw__rad__input__mod_8f90.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">! Description:</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml">   12</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacelw__rad__input__mod.xhtml" title="Input control for lw radiation. Input control for lw radiation. ">lw_rad_input_mod</a></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keywordtype">USE </span>sat_opt_mod</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacelw__control__struct.xhtml" title="This module defines the controlling structure for LW calculations. ">lw_control_struct</a><span class="keywordtype">, ONLY</span>: <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>, <a class="code" href="namespacelw__control__struct.xhtml#a8e06397e033009a7d93c7fa852647656">n_lwcall</a></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemissing__data__mod.xhtml" title="*****************************COPYRIGHT************************************** ************************...">missing_data_mod</a><span class="keywordtype">, ONLY</span>: <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a99a86df3108252d30a3ef8e3a9a879d5">   19</a></span>&#160;<span class="keywordtype">CHARACTER  (LEN=132)</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a99a86df3108252d30a3ef8e3a9a879d5">spectral_file_lw</a>    <span class="comment">!       Spectral file</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a4d494f3637d26793afad39774a9e1b3a">   22</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a4d494f3637d26793afad39774a9e1b3a" title="Options for trace gases: ">l_n2o_lw</a>            <span class="comment">! flag for nitrous oxideLOGICAL :: l_ch4_lw            ! flag for methane</span></div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#ae67f50c8cd0517a92b88177a5247d400">   23</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#ae67f50c8cd0517a92b88177a5247d400">l_cfc11_lw</a>          <span class="comment">! flag for cfc11LOGICAL :: l_cfc12_lw          ! flag for cfc12</span></div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#afd917fdcee60977e87b296c72d69d0a0">   24</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#afd917fdcee60977e87b296c72d69d0a0">l_cfc113_lw</a>         <span class="comment">! flag for cfc113LOGICAL :: l_cfc114_lw         ! flag for cfc114</span></div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a028b3c5a32a7e8e473c6a7d856e14690">   25</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a028b3c5a32a7e8e473c6a7d856e14690">l_hcfc22_lw</a>         <span class="comment">! flag for hcfc22LOGICAL :: l_hfc125_lw         ! flag for hfc125LOGICAL :: l_hfc134a_lw        ! flag for hfc134a</span></div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#ac567b9c0e1a4dc55a9fdea3b51b77400">   26</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#ac567b9c0e1a4dc55a9fdea3b51b77400">l_solar_tail_flux</a>   <span class="comment">! Flag for adding solar tail flux to LWLOGICAL :: l_microphysics_lw   ! Flag for microphysics in LW</span></div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#aee49c41b728d8156d9f95c90e11ab8ee">   27</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#aee49c41b728d8156d9f95c90e11ab8ee">i_scatter_method_lw</a> <span class="comment">! treatment of scattering</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a989b275ce25a5d87da0c5dcbc30320bd">   28</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a989b275ce25a5d87da0c5dcbc30320bd">i_gas_overlap_lw</a>    <span class="comment">! treatment of gaseous overlaps</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#af67220d17cee9f0106d2aef596cad5f0">   30</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#af67220d17cee9f0106d2aef596cad5f0" title="types of droplets or ice crystals used for parametrisations ">i_st_water_lw</a>             <span class="comment">! type for stratiform waterINTEGER :: i_cnv_water_lw            ! type for convective waterINTEGER :: i_st_ice_lw               ! type for stratiform ice INTEGER :: i_cnv_ice_lw              ! type for convective ice</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a0777b9abcdf45ec272e2e77d87644a4e">   32</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a0777b9abcdf45ec272e2e77d87644a4e" title="Second set of control options for the second radiation call:CHARACTER (LEN=132) :: spectral_file_lw2L...">l_ch4_lw2logical</a> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#ad10bdc6cab8f27dec7a4b565e4320c67">l_cfc11_lw2</a></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a627069ff9f80462c0b6d7fed8bf9741d">   33</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a627069ff9f80462c0b6d7fed8bf9741d">l_cfc12_lw2logical</a> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#ae8db2a337715969bcc7c830679db9e57">l_cfc113_lw2</a></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#acd867d55e10ed9e4cbd39e40f2be592a">   34</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a1ff6c691ed95786be627c59b49a5f958">l_cfc114_lw2logical</a> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#acd867d55e10ed9e4cbd39e40f2be592a">l_hcfc22_lw2</a></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#adc5b3d8dc289be824786211c6900be95">   35</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#adc5b3d8dc289be824786211c6900be95">l_hfc125_lw2</a></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a2334f0214667dedff411ff42356536bb">   36</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a2334f0214667dedff411ff42356536bb">l_hfc134a_lw2</a></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a8fc21f4fdb0fa36dd9fabee47d488b78">   37</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a8fc21f4fdb0fa36dd9fabee47d488b78">l_solar_tail_flux_2</a></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a93a69bce98498da67abef4008e695d54">   38</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a93a69bce98498da67abef4008e695d54">l_microphysics_lw2integer</a> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#afd5acc905ef82d532dce344d22ee708a">i_scatter_method_lw2</a></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#ab5ca2e885a1b4346f6ae98b3ecb3d309">   39</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a72fa23d755cc6ab792522532c8961939">i_gas_overlap_lw2integer</a> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#ab5ca2e885a1b4346f6ae98b3ecb3d309">i_st_water_lw2integer</a> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#ac8c1c577315c801b81bf794f8e11e31f">i_cnv_water_lw2integer</a> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#ac69129661a95871e24092508e4024ec2">i_st_ice_lw2</a></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a882b0d1ae150112446d6e0b2dc7f3b7b">   40</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespacelw__rad__input__mod.xhtml#a882b0d1ae150112446d6e0b2dc7f3b7b">i_cnv_ice_lw2</a></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordtype">NAMELIST</span>/r2lwncal/<a class="code" href="namespacelw__control__struct.xhtml#a8e06397e033009a7d93c7fa852647656">n_lwcall</a></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keywordtype">NAMELIST</span>/r2lwclnl/                                                      &amp;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#a99a86df3108252d30a3ef8e3a9a879d5">spectral_file_lw</a>, spectral_file_lw2,                               &amp;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#ac567b9c0e1a4dc55a9fdea3b51b77400">l_solar_tail_flux</a>, <a class="code" href="namespacelw__rad__input__mod.xhtml#a8fc21f4fdb0fa36dd9fabee47d488b78">l_solar_tail_flux_2</a>,                            &amp;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#a989b275ce25a5d87da0c5dcbc30320bd">i_gas_overlap_lw</a>, i_gas_overlap_lw2,                               &amp;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#a4d494f3637d26793afad39774a9e1b3a" title="Options for trace gases: ">l_n2o_lw</a>, l_n2o_lw2, l_ch4_lw, l_ch4_lw2,                          &amp;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#ae67f50c8cd0517a92b88177a5247d400">l_cfc11_lw</a>, <a class="code" href="namespacelw__rad__input__mod.xhtml#ad10bdc6cab8f27dec7a4b565e4320c67">l_cfc11_lw2</a>, l_cfc12_lw, l_cfc12_lw2,                  &amp;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#afd917fdcee60977e87b296c72d69d0a0">l_cfc113_lw</a>, <a class="code" href="namespacelw__rad__input__mod.xhtml#ae8db2a337715969bcc7c830679db9e57">l_cfc113_lw2</a>, l_cfc114_lw, l_cfc114_lw2,              &amp;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#a028b3c5a32a7e8e473c6a7d856e14690">l_hcfc22_lw</a>, <a class="code" href="namespacelw__rad__input__mod.xhtml#acd867d55e10ed9e4cbd39e40f2be592a">l_hcfc22_lw2</a>, l_hfc125_lw, <a class="code" href="namespacelw__rad__input__mod.xhtml#adc5b3d8dc289be824786211c6900be95">l_hfc125_lw2</a>,              &amp;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;     l_hfc134a_lw, <a class="code" href="namespacelw__rad__input__mod.xhtml#a2334f0214667dedff411ff42356536bb">l_hfc134a_lw2</a>,                                       &amp;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#af67220d17cee9f0106d2aef596cad5f0" title="types of droplets or ice crystals used for parametrisations ">i_st_water_lw</a>, i_st_water_lw2, i_cnv_water_lw, i_cnv_water_lw2,    &amp;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;     i_st_ice_lw, <a class="code" href="namespacelw__rad__input__mod.xhtml#ac69129661a95871e24092508e4024ec2">i_st_ice_lw2</a>, i_cnv_ice_lw, <a class="code" href="namespacelw__rad__input__mod.xhtml#a882b0d1ae150112446d6e0b2dc7f3b7b">i_cnv_ice_lw2</a>,            &amp;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;     <a class="code" href="namespacelw__rad__input__mod.xhtml#aee49c41b728d8156d9f95c90e11ab8ee">i_scatter_method_lw</a>, <a class="code" href="namespacelw__rad__input__mod.xhtml#afd5acc905ef82d532dce344d22ee708a">i_scatter_method_lw2</a>,                         &amp;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;     l_microphysics_lw, l_microphysics_lw2</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">SUBROUTINE </span><a class="code" href="namespacelw__rad__input__mod.xhtml#a48607bce855ffd5182323be32b0dee40" title="CONTAINS. ">lw_input</a></div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="namespacelw__rad__input__mod.xhtml#a48607bce855ffd5182323be32b0dee40">   65</a></span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacecheck__iostat__mod.xhtml">check_iostat_mod</a></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacerad__pcf.xhtml" title="Radiation Program Configuration File. ">rad_pcf</a><span class="keywordtype">, ONLY</span>: <a class="code" href="namespacerad__pcf.xhtml#aa6bb2ded6902baf3dc05462648abb51e">ip_cloud_mix_max</a>, <a class="code" href="namespacerad__pcf.xhtml#af29c1b6b06fc280ad274dadbe5d9e939">ip_cloud_mix_random</a>,               &amp;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#a24676eb6045eefb6af1544bad252c977">ip_cloud_triple</a>, <a class="code" href="namespacerad__pcf.xhtml#abbe859e26207b03f7218a1ea6358daec">ip_cloud_part_corr</a>, <a class="code" href="namespacerad__pcf.xhtml#a0029bd144797b8004433b6a082dd15f1">ip_cloud_part_corr_cnv</a>,          &amp;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#a3e0388f3761d38be1d8f207b51cdf9cd">ip_cloud_mcica</a>,                                                       &amp;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#aec534367cc0e0029534909eca591b8f0">ip_solver_homogen_direct</a>, <a class="code" href="namespacerad__pcf.xhtml#a3d5453699d15c72d6dda44b3220d0e16">ip_solver_mix_direct_hogan</a>,                 &amp;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#a6ede366e36b613a46d5ce1c493e58548">ip_solver_triple_hogan</a>, <a class="code" href="namespacerad__pcf.xhtml#a231cf18709f7b19b3ecb16eafbb996c1">ip_solver_triple_app_scat</a>,                    &amp;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#ad08fd31557ab5437d24f4bec1d0c713c">ip_solver_mix_app_scat</a>, <a class="code" href="namespacerad__pcf.xhtml#ad3c2eff75b80fb72fcbcd6d12131f3f4">ip_solver_no_scat</a>,                            &amp;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#aa96461a47038c8ac4b40e97d2110ca1d">ip_cloud_homogen</a>, <a class="code" href="namespacerad__pcf.xhtml#a1299e163cd41fccaf89afbaef6e94d2d">ip_cloud_ice_water</a>, <a class="code" href="namespacerad__pcf.xhtml#ada46611c6bd457d260ee222f9cee54a0">ip_cloud_conv_strat</a>,            &amp;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#a011bf40a227f49aa770a14df388da88f">ip_cloud_csiw</a>,                                                        &amp;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#ad4d69fb884d5fd66c8386769df8e04d1">ip_scaling</a>, <a class="code" href="namespacerad__pcf.xhtml#ac5b14223ead32c15b7ca9bf6f3eb89d6">ip_mcica</a>,                                                 &amp;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  ip_max_rand, <a class="code" href="namespacerad__pcf.xhtml#a89beae8fcd92635b7e822fad323e4a16">ip_exponential_rand</a>, <a class="code" href="namespacerad__pcf.xhtml#a0ec4c6567c10872c05403c9fde7c4f55">ip_rand</a>,                            &amp;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="namespacerad__pcf.xhtml#a1220ea58461ae232a1aba794c3bc4e03">ip_scatter_approx</a>, <a class="code" href="namespacerad__pcf.xhtml#a6d46db30d4c6a535638790efa57cb87d">ip_no_scatter_abs</a>, <a class="code" href="namespacerad__pcf.xhtml#af010f0e02aef0151cf61f833c3038e98">ip_no_scatter_ext</a></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keywordtype">USE </span>parkind1<span class="keywordtype">, ONLY</span>: jpim, jprb</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">USE </span>yomhook<span class="keywordtype">,  ONLY</span>: lhook, dr_hook</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespaceereport__mod.xhtml" title="This file belongs in section: Misc. ">ereport_mod</a><span class="keywordtype">, ONLY</span> : <a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacerad__input__mod.xhtml" title="Input control for radiation. Input control for radiation. ">rad_input_mod</a></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordtype">INTEGER</span> :: j,                        &amp;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;     errorstatus      <span class="comment">! Return code : 0 Normal Exit : &gt;0 Error</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keywordtype">INTEGER(KIND=jpim)</span>, <span class="keywordtype">PARAMETER</span> :: zhook_in  = 0</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keywordtype">INTEGER(KIND=jpim)</span>, <span class="keywordtype">PARAMETER</span> :: zhook_out = 1</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordtype">REAL(KIND=jprb)</span>               :: zhook_handle</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keywordtype">CHARACTER(LEN=*)</span> RoutineName</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<a class="code" href="namespaceukca__radaer__struct__mod.xhtml#a7b11899c3ce190bb3d00d3a633af780e">parameter</a>(   routinename=<span class="stringliteral">&#39;sw_rad_input_mod&#39;</span>)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keywordtype">CHARACTER(LEN=256)</span> :: CMessage         <span class="comment">! Error message if Errorstatus &gt;0</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keywordflow">IF</span> (lhook) <span class="keyword">CALL </span>dr_hook(<span class="stringliteral">&#39;lw_input&#39;</span>,zhook_in,zhook_handle)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#a99a86df3108252d30a3ef8e3a9a879d5">spectral_file_lw</a>           = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#ac567b9c0e1a4dc55a9fdea3b51b77400">l_solar_tail_flux</a>          = .false.</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#a989b275ce25a5d87da0c5dcbc30320bd">i_gas_overlap_lw</a>           = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#a4d494f3637d26793afad39774a9e1b3a" title="Options for trace gases: ">l_n2o_lw</a>                   = .false.</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  l_ch4_lw                   = .false.</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#ae67f50c8cd0517a92b88177a5247d400">l_cfc11_lw</a>                 = .false.</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  l_cfc12_lw                 = .false.</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#afd917fdcee60977e87b296c72d69d0a0">l_cfc113_lw</a>                = .false.</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  l_cfc114_lw                = .false.</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#a028b3c5a32a7e8e473c6a7d856e14690">l_hcfc22_lw</a>                = .false.</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  l_hfc125_lw                = .false.</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  l_hfc134a_lw               = .false.</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#af67220d17cee9f0106d2aef596cad5f0" title="types of droplets or ice crystals used for parametrisations ">i_st_water_lw</a>              = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  i_cnv_water_lw             = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  i_st_ice_lw                = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  i_cnv_ice_lw               = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#aee49c41b728d8156d9f95c90e11ab8ee">i_scatter_method_lw</a>        = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  l_microphysics_lw          = .false.</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  spectral_file_lw2          = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#a8fc21f4fdb0fa36dd9fabee47d488b78">l_solar_tail_flux_2</a>        = .false.</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  i_gas_overlap_lw2          = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  l_n2o_lw2                  = .false.</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  l_ch4_lw2                  = .false.</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#ad10bdc6cab8f27dec7a4b565e4320c67">l_cfc11_lw2</a>                = .false.</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  l_cfc12_lw2                = .false.</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#ae8db2a337715969bcc7c830679db9e57">l_cfc113_lw2</a>               = .false.</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  l_cfc114_lw2               = .false.</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#acd867d55e10ed9e4cbd39e40f2be592a">l_hcfc22_lw2</a>               = .false.</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#adc5b3d8dc289be824786211c6900be95">l_hfc125_lw2</a>               = .false.</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#a2334f0214667dedff411ff42356536bb">l_hfc134a_lw2</a>              = .false.</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  i_st_water_lw2             = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  i_cnv_water_lw2            = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#ac69129661a95871e24092508e4024ec2">i_st_ice_lw2</a>               = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#a882b0d1ae150112446d6e0b2dc7f3b7b">i_cnv_ice_lw2</a>              = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="namespacelw__rad__input__mod.xhtml#afd5acc905ef82d532dce344d22ee708a">i_scatter_method_lw2</a>       = <a class="code" href="namespacemissing__data__mod.xhtml#aff73e8cc7491c6c6a6b2bcc14c172e20">imdi</a></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  l_microphysics_lw2         = .false.</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">! Options for the longwave</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">#if defined(SCMA)</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor"></span>  <span class="keyword">READ</span> (10, r2lwclnl)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#else   READ (UNIT=5, NML= r2lwclnl, IOSTAT=errorstatus)</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor"></span>  <span class="keyword">CALL </span><a class="code" href="namespacecheck__iostat__mod.xhtml#a566da52c3f5db6d5e0fe66bec78e47f8">check_iostat</a>(errorstatus, <span class="stringliteral">&quot;namelist R2LWCLNL&quot;</span>)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#endif </span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor"></span><span class="keywordflow">DO</span> j=1, <a class="code" href="namespacelw__control__struct.xhtml#a8e06397e033009a7d93c7fa852647656">n_lwcall</a></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">! Set default values of control variables.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">! Note: to allow a simple interface for ROSE only the commonly used</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">! items are now set via the namelist. In order to set further variables</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">! (eg. for radiance diagnostics) a branch must now be used.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">! DEPENDS ON: lw_control_default</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keyword">CALL </span><a class="code" href="lw__control__default_8f90.xhtml#a253422b4271d1988ace1066d4f9a8e94" title="Subroutine to set the default values of the control structure. ">lw_control_default</a>(<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j))</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">! Transfer namelist items to the data structure.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">IF</span> (j==2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%spectral_file          = spectral_file_lw2</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_solar_tail_flux      = <a class="code" href="namespacelw__rad__input__mod.xhtml#a8fc21f4fdb0fa36dd9fabee47d488b78">l_solar_tail_flux_2</a></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_gas_overlap          = i_gas_overlap_lw2</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud_representation = <a class="code" href="namespacerad__input__mod.xhtml#afc3230062e62c5fa827155d33da99d3e">i_cloud_representation_2</a></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_fsd                  = <a class="code" href="namespacerad__input__mod.xhtml#a07c62634f233d01eae320c9e1056a021">i_fsd_2</a></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap              = <a class="code" href="namespacerad__input__mod.xhtml#a1c12d5e0565d37afb4ff20fc70cd07a7">i_overlap_2</a></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_inhom                = <a class="code" href="namespacerad__input__mod.xhtml#aec43a4eef1e4cfeaa09c15eca694a378">i_inhom_2</a></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_n2o                  = l_n2o_lw2</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_ch4                  = l_ch4_lw2</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_cfc11                = <a class="code" href="namespacelw__rad__input__mod.xhtml#ad10bdc6cab8f27dec7a4b565e4320c67">l_cfc11_lw2</a></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_cfc12                = l_cfc12_lw2</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_cfc113               = <a class="code" href="namespacelw__rad__input__mod.xhtml#ae8db2a337715969bcc7c830679db9e57">l_cfc113_lw2</a></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_cfc114               = l_cfc114_lw2</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_hcfc22               = <a class="code" href="namespacelw__rad__input__mod.xhtml#acd867d55e10ed9e4cbd39e40f2be592a">l_hcfc22_lw2</a></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_hfc125               = <a class="code" href="namespacelw__rad__input__mod.xhtml#adc5b3d8dc289be824786211c6900be95">l_hfc125_lw2</a></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_hfc134a              = <a class="code" href="namespacelw__rad__input__mod.xhtml#a2334f0214667dedff411ff42356536bb">l_hfc134a_lw2</a></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_st_water             = i_st_water_lw2</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cnv_water            = i_cnv_water_lw2</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_st_ice               = <a class="code" href="namespacelw__rad__input__mod.xhtml#ac69129661a95871e24092508e4024ec2">i_st_ice_lw2</a></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cnv_ice              = <a class="code" href="namespacelw__rad__input__mod.xhtml#a882b0d1ae150112446d6e0b2dc7f3b7b">i_cnv_ice_lw2</a></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_scatter_method       = <a class="code" href="namespacelw__rad__input__mod.xhtml#afd5acc905ef82d532dce344d22ee708a">i_scatter_method_lw2</a></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_microphysics         = l_microphysics_lw2</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%spectral_file          = <a class="code" href="namespacelw__rad__input__mod.xhtml#a99a86df3108252d30a3ef8e3a9a879d5">spectral_file_lw</a></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_solar_tail_flux      = <a class="code" href="namespacelw__rad__input__mod.xhtml#ac567b9c0e1a4dc55a9fdea3b51b77400">l_solar_tail_flux</a></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_gas_overlap          = <a class="code" href="namespacelw__rad__input__mod.xhtml#a989b275ce25a5d87da0c5dcbc30320bd">i_gas_overlap_lw</a></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud_representation = <a class="code" href="namespacerad__input__mod.xhtml#adeabbf9d5c2d98a03831f0869dd1187c">i_cloud_representation</a></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_fsd                  = <a class="code" href="namespacerad__input__mod.xhtml#ae79ad3d2be3771571272057a3776f773">i_fsd</a></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap              = <a class="code" href="namespacerad__input__mod.xhtml#ab5d71140737381d081360a950714b9f5">i_overlap</a></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_inhom                = <a class="code" href="namespacerad__input__mod.xhtml#a894d806defc0cf8d90da07f13a57daaa">i_inhom</a></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_n2o                  = <a class="code" href="namespacelw__rad__input__mod.xhtml#a4d494f3637d26793afad39774a9e1b3a" title="Options for trace gases: ">l_n2o_lw</a></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_ch4                  = l_ch4_lw</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_cfc11                = <a class="code" href="namespacelw__rad__input__mod.xhtml#ae67f50c8cd0517a92b88177a5247d400">l_cfc11_lw</a></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_cfc12                = l_cfc12_lw</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_cfc113               = <a class="code" href="namespacelw__rad__input__mod.xhtml#afd917fdcee60977e87b296c72d69d0a0">l_cfc113_lw</a></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_cfc114               = l_cfc114_lw</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_hcfc22               = <a class="code" href="namespacelw__rad__input__mod.xhtml#a028b3c5a32a7e8e473c6a7d856e14690">l_hcfc22_lw</a></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_hfc125               = l_hfc125_lw</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_hfc134a              = l_hfc134a_lw</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_st_water             = <a class="code" href="namespacelw__rad__input__mod.xhtml#af67220d17cee9f0106d2aef596cad5f0" title="types of droplets or ice crystals used for parametrisations ">i_st_water_lw</a></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cnv_water            = i_cnv_water_lw</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_st_ice               = i_st_ice_lw</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cnv_ice              = i_cnv_ice_lw</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_scatter_method       = <a class="code" href="namespacelw__rad__input__mod.xhtml#aee49c41b728d8156d9f95c90e11ab8ee">i_scatter_method_lw</a></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%l_microphysics         = l_microphysics_lw</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordflow">  END IF</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordflow">END DO</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">! Set i_cloud from combination of i_overlap, i_fsd and! i_representation</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordflow">DO</span> j=1,<a class="code" href="namespacelw__control__struct.xhtml#a8e06397e033009a7d93c7fa852647656">n_lwcall</a></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud_representation                          &amp;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        == <a class="code" href="namespacerad__pcf.xhtml#aa96461a47038c8ac4b40e97d2110ca1d">ip_cloud_homogen</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_solver=<a class="code" href="namespacerad__pcf.xhtml#aec534367cc0e0029534909eca591b8f0">ip_solver_homogen_direct</a></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_inhom == <a class="code" href="namespacerad__pcf.xhtml#ac5b14223ead32c15b7ca9bf6f3eb89d6">ip_mcica</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#a3e0388f3761d38be1d8f207b51cdf9cd">ip_cloud_mcica</a></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == ip_max_rand) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#aa6bb2ded6902baf3dc05462648abb51e">ip_cloud_mix_max</a></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == <a class="code" href="namespacerad__pcf.xhtml#a89beae8fcd92635b7e822fad323e4a16">ip_exponential_rand</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#abbe859e26207b03f7218a1ea6358daec">ip_cloud_part_corr</a></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == <a class="code" href="namespacerad__pcf.xhtml#a0ec4c6567c10872c05403c9fde7c4f55">ip_rand</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#af29c1b6b06fc280ad274dadbe5d9e939">ip_cloud_mix_random</a></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        errorstatus = 100</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        cmessage = <span class="stringliteral">&#39;The selected cloud overlap is not available&#39;</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keyword">CALL </span><a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a>(routinename, errorstatus, cmessage)<span class="keywordflow">      END IF</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordflow">    END IF</span> </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud_representation                      &amp;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;       == <a class="code" href="namespacerad__pcf.xhtml#a1299e163cd41fccaf89afbaef6e94d2d">ip_cloud_ice_water</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_inhom == <a class="code" href="namespacerad__pcf.xhtml#ac5b14223ead32c15b7ca9bf6f3eb89d6">ip_mcica</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#a3e0388f3761d38be1d8f207b51cdf9cd">ip_cloud_mcica</a></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">IF</span> ( (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_scatter_method == <a class="code" href="namespacerad__pcf.xhtml#a6d46db30d4c6a535638790efa57cb87d">ip_no_scatter_abs</a>) .OR.   &amp;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;           (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_scatter_method == <a class="code" href="namespacerad__pcf.xhtml#af010f0e02aef0151cf61f833c3038e98">ip_no_scatter_ext</a>) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_solver=<a class="code" href="namespacerad__pcf.xhtml#ad3c2eff75b80fb72fcbcd6d12131f3f4">ip_solver_no_scat</a></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_solver=<a class="code" href="namespacerad__pcf.xhtml#aec534367cc0e0029534909eca591b8f0">ip_solver_homogen_direct</a></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordflow">      END IF</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_scatter_method == <a class="code" href="namespacerad__pcf.xhtml#a1220ea58461ae232a1aba794c3bc4e03">ip_scatter_approx</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_solver=<a class="code" href="namespacerad__pcf.xhtml#ad08fd31557ab5437d24f4bec1d0c713c">ip_solver_mix_app_scat</a></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_solver=<a class="code" href="namespacerad__pcf.xhtml#a3d5453699d15c72d6dda44b3220d0e16">ip_solver_mix_direct_hogan</a></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keywordflow">      END IF</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == ip_max_rand) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#aa6bb2ded6902baf3dc05462648abb51e">ip_cloud_mix_max</a></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == <a class="code" href="namespacerad__pcf.xhtml#a89beae8fcd92635b7e822fad323e4a16">ip_exponential_rand</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#abbe859e26207b03f7218a1ea6358daec">ip_cloud_part_corr</a></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == <a class="code" href="namespacerad__pcf.xhtml#a0ec4c6567c10872c05403c9fde7c4f55">ip_rand</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#af29c1b6b06fc280ad274dadbe5d9e939">ip_cloud_mix_random</a></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        errorstatus = 100</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        cmessage = <span class="stringliteral">&#39;The selected cloud overlap is not available&#39;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keyword">CALL </span><a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a>(routinename, errorstatus, cmessage)<span class="keywordflow">      END IF</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="keywordflow">    END IF</span> </div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ((<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud_representation                     &amp;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;           == <a class="code" href="namespacerad__pcf.xhtml#ada46611c6bd457d260ee222f9cee54a0">ip_cloud_conv_strat</a>) .OR.                              &amp;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;           (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud_representation                     &amp;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;           == <a class="code" href="namespacerad__pcf.xhtml#a011bf40a227f49aa770a14df388da88f">ip_cloud_csiw</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_inhom == <a class="code" href="namespacerad__pcf.xhtml#ac5b14223ead32c15b7ca9bf6f3eb89d6">ip_mcica</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      errorstatus = 100</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      cmessage = <span class="stringliteral">&#39;McICA is not compatible with the selected&#39;</span>//       &amp;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                 <span class="stringliteral">&#39; cloud representation&#39;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keyword">CALL </span><a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a>(routinename, errorstatus, cmessage)    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_scatter_method == <a class="code" href="namespacerad__pcf.xhtml#a1220ea58461ae232a1aba794c3bc4e03">ip_scatter_approx</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_solver=<a class="code" href="namespacerad__pcf.xhtml#a231cf18709f7b19b3ecb16eafbb996c1">ip_solver_triple_app_scat</a></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_solver=<a class="code" href="namespacerad__pcf.xhtml#a6ede366e36b613a46d5ce1c493e58548">ip_solver_triple_hogan</a></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordflow">      END IF</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;       <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == ip_max_rand) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#a24676eb6045eefb6af1544bad252c977">ip_cloud_triple</a></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == <a class="code" href="namespacerad__pcf.xhtml#a89beae8fcd92635b7e822fad323e4a16">ip_exponential_rand</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#a0029bd144797b8004433b6a082dd15f1">ip_cloud_part_corr_cnv</a></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_overlap == <a class="code" href="namespacerad__pcf.xhtml#a0ec4c6567c10872c05403c9fde7c4f55">ip_rand</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_cloud=<a class="code" href="namespacerad__pcf.xhtml#af29c1b6b06fc280ad274dadbe5d9e939">ip_cloud_mix_random</a></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        errorstatus = 100</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        cmessage = <span class="stringliteral">&#39;The selected cloud overlap is not available&#39;</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keyword">CALL </span><a class="code" href="interfaceereport__mod_1_1ereport.xhtml">ereport</a>(routinename, errorstatus, cmessage)<span class="keywordflow">      END IF</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">    END IF</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordflow">  END IF</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacelw__control__struct.xhtml#a06fce3d06cdb9b5aaf3114dc61d9957e">lw_control</a>(j)%i_inhom == <a class="code" href="namespacerad__pcf.xhtml#ad4d69fb884d5fd66c8386769df8e04d1">ip_scaling</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="namespacerad__input__mod.xhtml#a058ba149ec326e2b533d7ac9f473e84d" title="Needed in glue_rad-rad_ctl3c. Switch for the solar zenith angle correction to surface fluxes using th...">l_inhom_cloud</a>=.true.</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keywordflow">  END IF</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordflow">END DO</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordflow">IF</span> (lhook) <span class="keyword">CALL </span>dr_hook(<span class="stringliteral">&#39;lw_input&#39;</span>,zhook_out,zhook_handle)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keyword">END SUBROUTINE </span><a class="code" href="namespacelw__rad__input__mod.xhtml#a48607bce855ffd5182323be32b0dee40" title="CONTAINS. ">lw_input</a></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacelw__rad__input__mod.xhtml" title="Input control for lw radiation. Input control for lw radiation. ">lw_rad_input_mod</a></div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
