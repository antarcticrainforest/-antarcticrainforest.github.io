<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/atmosphere/UKCA/ukca_deriv.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_1df14ea1ac826f73bc3062fa8a76e0c2.xhtml">atmosphere</a></li><li class="navelem"><a class="el" href="dir_3b087d695daa154bfcb7242bcfd0fbd3.xhtml">UKCA</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ukca_deriv.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ukca__deriv_8f90.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">! Description:</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!  Code Description:</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="ukca__deriv_8f90.xhtml#a16d234beeb33da426397ebfda4283a57" title="To perform a chemical integration using the Backward Euler. ">ukca_deriv</a>(nr, n_be_calls, n_pnts,                    &amp;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                          rc, wdep, ddep, dj,                          &amp;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                          h2o, m, o2,                                  &amp;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                          dts, y)</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="ukca__deriv_8f90.xhtml#a16d234beeb33da426397ebfda4283a57">   25</a></span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordtype">USE </span>ukca_option_mod<span class="keywordtype">, ONLY</span>: jpspec, jppj, nit</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordtype">USE </span>yomhook<span class="keywordtype">, ONLY</span>: lhook, dr_hook</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordtype">USE </span>parkind1<span class="keywordtype">, ONLY</span>: jprb, jpim</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordtype">USE </span>um_parvars</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;typsize.h&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor"></span>           <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: nr         <span class="comment">! No. reactions</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: n_be_calls <span class="comment">! No. chemical steps</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: n_pnts     <span class="comment">! Actual no. calculations</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: dts                 <span class="comment">! timestep</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: rc(n_pnts,nr)       <span class="comment">! rxn rate coeffs</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: dj(n_pnts,jppj)     <span class="comment">! photol rates</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: wdep(n_pnts,jpspec) <span class="comment">! wet dep rates</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: ddep(n_pnts,jpspec) <span class="comment">! dry dep rates</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: h2o(n_pnts)         <span class="comment">! h2o concn</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: m(n_pnts)           <span class="comment">! air density</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: o2(n_pnts)          <span class="comment">! o2 density</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(INOUT)</span> :: y(n_pnts,jpspec)    <span class="comment">! species concn</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordtype">INTEGER</span> :: i, j, n                         <span class="comment">! loop variables</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                 <span class="keywordtype">REAL</span> :: p(n_pnts)                          <span class="comment">! production rate</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordtype">REAL</span> :: p1(n_pnts)                         <span class="comment">! working array</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">REAL</span> :: p2(n_pnts)                         <span class="comment">! working array</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordtype">REAL</span> :: r1(n_pnts)                         <span class="comment">! working array</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordtype">REAL</span> :: r2(n_pnts)                         <span class="comment">! working array</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordtype">REAL</span> :: l(n_pnts)                          <span class="comment">! loss rate</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordtype">REAL</span> :: l1(n_pnts)                         <span class="comment">! working array</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordtype">REAL</span> :: l2(n_pnts)                         <span class="comment">! working array</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordtype">REAL</span> :: l3(n_pnts)                         <span class="comment">! working array</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordtype">REAL</span> :: yp(n_pnts,jpspec)                  <span class="comment">! previous species concn</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">INTEGER(KIND=jpim)</span>, <span class="keywordtype">PARAMETER</span> :: zhook_in  = 0</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">INTEGER(KIND=jpim)</span>, <span class="keywordtype">PARAMETER</span> :: zhook_out = 1</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">REAL(KIND=jprb)</span>               :: zhook_handle</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">IF</span> (lhook) <span class="keyword">CALL </span>dr_hook(<span class="stringliteral">&#39;UKCA_DERIV&#39;</span>,zhook_in,zhook_handle)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">DO</span> n = 1, n_be_calls           <span class="comment">! loop over chemical timesteps</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                   <span class="keywordflow">DO</span> j = 1,jpspec</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          yp(:,j) = y(:,j)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordflow">        END DO</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       <span class="comment">!       Set constant fields</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        yp(:,12) = 5.0e-7*m(:)     <span class="comment">! H2</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        yp(:,16) = 350.0e-6*m(:)   <span class="comment">! CO2</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        yp(:,19) = h2o(:)          <span class="comment">! H2O</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        yp(:,22) = o2(:)           <span class="comment">! O2</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        yp(:,23) = m(:) - o2(:)    <span class="comment">! N2</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                               y(:,12) = yp(:,12)        <span class="comment">! H2</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        y(:,16) = yp(:,16)        <span class="comment">! CO2</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        y(:,19) = yp(:,19)        <span class="comment">! H2O        y (:,22) = yp(:,22)        ! O2</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        y(:,23) = yp(:,23)        <span class="comment">! N2      </span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">DO</span> i=1,nit                   <span class="comment">! loop over iterations</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       <span class="comment">!         O(3P)        Y( 1)</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,15) *y(:,3 ))                                  &amp;                &amp;           +(dj(:,12) *y(:,5 ))        +(dj(:,13) *y(:,22)*2.00) &amp;                 &amp;           +(rc(:,76) *y(:,10)*y(:,10))+(dj(:,10) *y(:,6 ))      &amp;                 &amp;           +(rc(:,49) *y(:,2 )*y(:,23))                          &amp;     &amp;           +(rc(:,50) *y(:,2 )*y(:,22))                    l(:) = ddep(:,1) + wdep(:,1)                                 &amp;     &amp;           +(rc(:,44) *y(:,3 ))                                  &amp;     &amp;           +(rc(:,83) *y(:,6 ))+(rc(:,96) *y(:,22))                y(:, 1) = p(:)/l(:)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,14) *y(:,3 ))                                                        l(:) = ddep(:,2) + wdep(:,2)                                 &amp;     &amp;           +(rc(:,48) *y(:,19))+(rc(:,49) *y(:,23))              &amp;     &amp;           +(rc(:,50) *y(:,22))                                  &amp;     &amp;           +(rc(:,45) *y(:,14))+(rc(:,46) *y(:,14))              &amp;     &amp;           +(rc(:,47) *y(:,14))                y(:, 2) = p(:)/l(:)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,1)  *y(:,34))        +(dj(:,1)  *y(:,39))      &amp;                &amp;           +(dj(:,17) *y(:,21))        +(dj(:,1)  *y(:,33))      &amp;                 &amp;           +(dj(:,6)  *y(:,9 ))        +(dj(:,1)  *y(:,20))      &amp;                 &amp;           +(dj(:,1)  *y(:,26))        +(dj(:,2)  *y(:,13)*2.00) &amp;                 &amp;           +(rc(:,82) *y(:,10)*y(:,34))                          &amp;     &amp;           +(rc(:,85) *y(:,45)*y(:,44))                          &amp;     &amp;           +(rc(:,72) *y(:,10)*y(:,39))                          &amp;     &amp;           +(rc(:,80) *y(:,10)*y(:,33))                          &amp;     &amp;           +(rc(:,57) *y(:,10)*y(:,26))                          &amp;     &amp;           +(rc(:,66) *y(:,10)*y(:,20))                          &amp;     &amp;           +(rc(:,45) *y(:,2 )*y(:,14))                          &amp;     &amp;           +(rc(:,48) *y(:,2 )*y(:,19)*2.00)                     &amp;     &amp;           +(rc(:,3)  *y(:,11)*y(:,3 ))                          &amp;     &amp;           +(rc(:,10) *y(:,11)*y(:,28))                          &amp;     &amp;           +(rc(:,1)  *y(:,11)*y(:,4 ))                          &amp;     &amp;           +(rc(:,2)  *y(:,11)*y(:,5 ))                                    l(:) = ddep(:,10) + wdep(:,10)                               &amp;     &amp;           +(rc(:,99) *y(:,10))                                  &amp;                &amp;           +(rc(:,97) *y(:,4 ))+(rc(:,98) *y(:,6 ))              &amp;     &amp;           +(rc(:,99) *y(:,10))                                  &amp;     &amp;           +(rc(:,80) *y(:,33))+(rc(:,81) *y(:,34))              &amp;     &amp;           +(rc(:,82) *y(:,34))                                  &amp;     &amp;           +(rc(:,77) *y(:,29))+(rc(:,78) *y(:,40))              &amp;     &amp;           +(rc(:,79) *y(:,33))                                  &amp;     &amp;           +(rc(:,75) *y(:,3 ))+(rc(:,76) *y(:,10))              &amp;     &amp;           +(rc(:,76) *y(:,10))                                  &amp;     &amp;           +(rc(:,72) *y(:,39))+(rc(:,73) *y(:,27))              &amp;     &amp;           +(rc(:,74) *y(:,5 ))                                  &amp;     &amp;           +(rc(:,69) *y(:,37))+(rc(:,70) *y(:,37))              &amp;     &amp;           +(rc(:,71) *y(:,39))                                  &amp;     &amp;           +(rc(:,66) *y(:,20))+(rc(:,67) *y(:,20))              &amp;     &amp;           +(rc(:,68) *y(:,41))                                  &amp;     &amp;           +(rc(:,63) *y(:,8 ))+(rc(:,64) *y(:,9 ))              &amp;     &amp;           +(rc(:,65) *y(:,21))                                  &amp;     &amp;           +(rc(:,60) *y(:,13))+(rc(:,61) *y(:,17))              &amp;     &amp;           +(rc(:,62) *y(:,11))                                  &amp;     &amp;           +(rc(:,57) *y(:,26))+(rc(:,58) *y(:,26))              &amp;     &amp;           +(rc(:,59) *y(:,12))                                  &amp;     &amp;           +(rc(:,54) *y(:,30))+(rc(:,55) *y(:,15))              &amp;     &amp;           +(rc(:,56) *y(:,35))                                  &amp;     &amp;           +(rc(:,51) *y(:,14))+(rc(:,52) *y(:,24))              &amp;     &amp;           +(rc(:,53) *y(:,30))                y(:,10) = p(:)/l(:)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,96) *y(:,1 )*y(:,22))                          &amp;                 &amp;           +(rc(:,9)  *y(:,11)*y(:,28))                          &amp;     &amp;           +(rc(:,14) *y(:,11)*y(:,36))                    l(:) = ddep(:,3) + wdep(:,3)                                 &amp;     &amp;           +(dj(:,15) )                                          &amp;                 &amp;           +(rc(:,44) *y(:,1 ))                                  &amp;     &amp;           +(rc(:,75) *y(:,10))+(dj(:,14) )                      &amp;     &amp;           +(rc(:,3)  *y(:,11))+(rc(:,37) *y(:,4 ))              &amp;     &amp;           +(rc(:,38) *y(:,6 ))                y(:, 3) = (yp(:, 3)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,11) *y(:,5 ))        +(dj(:,17) *y(:,21))      &amp;                 &amp;           +(rc(:,83) *y(:,1 )*y(:,6 ))+(dj(:,10) *y(:,6 ))                            l(:) = ddep(:,4) + wdep(:,4)                                 &amp;     &amp;           +(rc(:,36) *y(:,5 ))+(rc(:,37) *y(:,3 ))              &amp;     &amp;           +(rc(:,97) *y(:,10))                                  &amp;     &amp;           +(rc(:,30) *y(:,32))+(rc(:,32) *y(:,36))              &amp;     &amp;           +(rc(:,34) *y(:,38))                                  &amp;     &amp;           +(rc(:,23) *y(:,25))+(rc(:,26) *y(:,28))              &amp;     &amp;           +(rc(:,28) *y(:,31))                                  &amp;     &amp;           +(rc(:,1)  *y(:,11))+(rc(:,16) *y(:,18))              &amp;     &amp;           +(rc(:,17) *y(:,18))                                            y(:, 4) = (yp(:, 4)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,20) *y(:,41))                                  &amp;                 &amp;           +(dj(:,16) *y(:,29))        +(dj(:,16) *y(:,40))      &amp;                 &amp;           +(dj(:,9)  *y(:,7 ))        +(dj(:,12) *y(:,5 ))      &amp;                 &amp;           +(dj(:,5)  *y(:,8 ))        +(dj(:,6)  *y(:,9 ))      &amp;                 &amp;           +(rc(:,94) *y(:,7 ))        +(rc(:,101)*y(:,40))      &amp;                 &amp;           +(rc(:,91) *y(:,8 ))        +(rc(:,93) *y(:,29))      &amp;                 &amp;           +(rc(:,77) *y(:,10)*y(:,29))                          &amp;     &amp;           +(rc(:,78) *y(:,10)*y(:,40))                          &amp;     &amp;           +(rc(:,68) *y(:,10)*y(:,41))                          &amp;     &amp;           +(rc(:,74) *y(:,10)*y(:,5 ))                          &amp;     &amp;           +(rc(:,63) *y(:,10)*y(:,8 ))                          &amp;     &amp;           +(rc(:,65) *y(:,10)*y(:,21))                          &amp;     &amp;           +(rc(:,36) *y(:,4 )*y(:,5 )*2.00)                     &amp;     &amp;           +(rc(:,37) *y(:,4 )*y(:,3 ))                          &amp;     &amp;           +(rc(:,34) *y(:,38)*y(:,4 ))                          &amp;     &amp;           +(rc(:,35) *y(:,38)*y(:,5 ))                          &amp;     &amp;           +(rc(:,32) *y(:,36)*y(:,4 ))                          &amp;     &amp;           +(rc(:,33) *y(:,36)*y(:,5 ))                          &amp;     &amp;           +(rc(:,30) *y(:,32)*y(:,4 ))                          &amp;     &amp;           +(rc(:,31) *y(:,32)*y(:,5 ))                          &amp;     &amp;           +(rc(:,28) *y(:,31)*y(:,4 ))                          &amp;     &amp;           +(rc(:,29) *y(:,31)*y(:,5 ))                          &amp;     &amp;           +(rc(:,26) *y(:,28)*y(:,4 ))                          &amp;     &amp;           +(rc(:,27) *y(:,28)*y(:,5 ))                          &amp;     &amp;           +(rc(:,23) *y(:,25)*y(:,4 ))                          &amp;     &amp;           +(rc(:,24) *y(:,25)*y(:,5 ))                          &amp;     &amp;           +(rc(:,16) *y(:,18)*y(:,4 ))                          &amp;     &amp;           +(rc(:,18) *y(:,18)*y(:,5 ))                          &amp;     &amp;           +(rc(:,1)  *y(:,11)*y(:,4 ))                          &amp;     &amp;           +(rc(:,2)  *y(:,11)*y(:,5 ))                    l(:) = ddep(:,6) + wdep(:,6)                                 &amp;     &amp;           +(rc(:,100)*y(:,36))+(dj(:,10) )                      &amp;                 &amp;           +(rc(:,92) *y(:,28))+(rc(:,95) *y(:,5 ))              &amp;     &amp;           +(rc(:,98) *y(:,10))                                  &amp;     &amp;           +(rc(:,38) *y(:,3 ))+(rc(:,83) *y(:,1 ))              &amp;     &amp;           +(rc(:,90) *y(:,11))                y(:, 6) = (yp(:, 6)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          p1(:) = 0.0                                                  &amp;     &amp;            +(rc(:,38) *y(:,6 )*y(:,3 ))                         &amp;     &amp;            +(rc(:,64) *y(:,10)*y(:,9 ))                  l(:) = ddep(:,5) + wdep(:,5)                                 &amp;     &amp;           +(dj(:,11) )        +(dj(:,12) )                      &amp;                 &amp;           +(rc(:,42) *y(:,37))+(rc(:,74) *y(:,10))              &amp;     &amp;           +(rc(:,95) *y(:,6 ))                                  &amp;     &amp;           +(rc(:,39) *y(:,17))+(rc(:,40) *y(:,27))              &amp;     &amp;           +(rc(:,41) *y(:,35))                                  &amp;     &amp;           +(rc(:,33) *y(:,36))+(rc(:,35) *y(:,38))              &amp;     &amp;           +(rc(:,36) *y(:,4 ))                                  &amp;     &amp;           +(rc(:,27) *y(:,28))+(rc(:,29) *y(:,31))              &amp;     &amp;           +(rc(:,31) *y(:,32))                                  &amp;     &amp;           +(rc(:,2)  *y(:,11))+(rc(:,18) *y(:,18))              &amp;     &amp;           +(rc(:,24) *y(:,25))             p2(:) = 0.0          r1(:) = rc(:,94) + dj(:,9)          r2(:) = rc(:,95) *y(:,6 )          l1(:) = ddep(:,7) + wdep(:,7)                                &amp;     &amp;            +(rc(:,43) *y(:,19))+(rc(:,94) )        +(dj(:,9)  )               l2(:) = 1.0+l(:)*dts          l3(:) = 1.0+l1(:)*dts          y(:,5) = (l3(:)*(yp(:,5)+p1(:)*dts)+r1(:)*dts*yp(:,7))/      &amp;     &amp;               ((l3(:)*l2(:))-r1(:)*r2(:)*dts**2)          y(:,7) = (yp(:,7) + p2(:)*dts + r2(:)*dts*y(:,5))/l3(:)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">!         HO2NO2       Y( 8)</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,90) *y(:,11)*y(:,6 ))                                                l(:) = ddep(:,8) + wdep(:,8)                                 &amp;     &amp;           +(rc(:,63) *y(:,10))+(rc(:,91) )        +(dj(:,5)  )                        y(:, 8) = (yp(:, 8)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">!         HONO2        Y( 9)</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,43) *y(:,7 )*y(:,19)*2.00)                     &amp;     &amp;           +(rc(:,98) *y(:,10)*y(:,6 ))                          &amp;     &amp;           +(rc(:,41) *y(:,5 )*y(:,35))                          &amp;     &amp;           +(rc(:,42) *y(:,5 )*y(:,37))                          &amp;     &amp;           +(rc(:,39) *y(:,5 )*y(:,17))                          &amp;     &amp;           +(rc(:,40) *y(:,5 )*y(:,27))                                    l(:) = ddep(:,9) + wdep(:,9)                                 &amp;     &amp;           +(rc(:,64) *y(:,10))+(dj(:,6)  )                                           y(:, 9) = (yp(:, 9)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">!         HO2          Y(11)</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,1)  *y(:,34))        +(dj(:,20) *y(:,41))      &amp;                 &amp;           +(dj(:,18) *y(:,35))        +(dj(:,1)  *y(:,33))      &amp;                 &amp;           +(dj(:,7)  *y(:,27))        +(dj(:,1)  *y(:,20))      &amp;                 &amp;           +(dj(:,3)  *y(:,17)*2.00)        +(dj(:,5)  *y(:,8 )) &amp;                 &amp;           +(rc(:,91) *y(:,8 ))        +(dj(:,1)  *y(:,26))      &amp;                 &amp;           +(rc(:,75) *y(:,10)*y(:,3 ))                          &amp;     &amp;           +(rc(:,84) *y(:,46)*y(:,44))                          &amp;     &amp;           +(rc(:,61) *y(:,10)*y(:,17))                          &amp;     &amp;           +(rc(:,74) *y(:,10)*y(:,5 ))                          &amp;     &amp;           +(rc(:,59) *y(:,10)*y(:,12))                          &amp;     &amp;           +(rc(:,60) *y(:,10)*y(:,13))                          &amp;     &amp;           +(rc(:,47) *y(:,2 )*y(:,14)*2.00)                     &amp;     &amp;           +(rc(:,55) *y(:,10)*y(:,15))                          &amp;     &amp;           +(rc(:,31) *y(:,32)*y(:,5 ))                          &amp;     &amp;           +(rc(:,39) *y(:,5 )*y(:,17))                          &amp;     &amp;           +(rc(:,29) *y(:,31)*y(:,5 ))                          &amp;     &amp;           +(rc(:,30) *y(:,32)*y(:,4 ))                          &amp;     &amp;           +(rc(:,25) *y(:,25)*y(:,28))                          &amp;     &amp;           +(rc(:,28) *y(:,31)*y(:,4 ))                          &amp;     &amp;           +(rc(:,23) *y(:,25)*y(:,4 ))                          &amp;     &amp;           +(rc(:,24) *y(:,25)*y(:,5 ))                          &amp;     &amp;           +(rc(:,20) *y(:,18)*y(:,18)*2.00)                     &amp;     &amp;           +(rc(:,21) *y(:,18)*y(:,28))                          &amp;     &amp;           +(rc(:,16) *y(:,18)*y(:,4 ))                          &amp;     &amp;           +(rc(:,18) *y(:,18)*y(:,5 ))                                    l(:) = ddep(:,11) + wdep(:,11)                               &amp;     &amp;           +(rc(:,89) *y(:,11))+(rc(:,90) *y(:,6 ))              &amp;                 &amp;           +(rc(:,15) *y(:,38))+(rc(:,62) *y(:,10))              &amp;     &amp;           +(rc(:,89) *y(:,11))                                  &amp;     &amp;           +(rc(:,12) *y(:,32))+(rc(:,13) *y(:,36))              &amp;     &amp;           +(rc(:,14) *y(:,36))                                  &amp;     &amp;           +(rc(:,9)  *y(:,28))+(rc(:,10) *y(:,28))              &amp;     &amp;           +(rc(:,11) *y(:,31))                                  &amp;     &amp;           +(rc(:,6)  *y(:,18))+(rc(:,7)  *y(:,25))              &amp;     &amp;           +(rc(:,8)  *y(:,28))                                  &amp;     &amp;           +(rc(:,4)  *y(:,11))+(rc(:,4)  *y(:,11))              &amp;     &amp;           +(rc(:,5)  *y(:,18))                                  &amp;     &amp;           +(rc(:,1)  *y(:,4 ))+(rc(:,2)  *y(:,5 ))              &amp;     &amp;           +(rc(:,3)  *y(:,3 ))                y(:,11) = (yp(:,11)+dts*p(:))/(1.0+dts*l(:)) </div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">!         H2O2         Y(13)</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,99) *y(:,10)*y(:,10))                          &amp;                 &amp;           +(rc(:,4)  *y(:,11)*y(:,11))                          &amp;     &amp;           +(rc(:,89) *y(:,11)*y(:,11))                    l(:) = ddep(:,13) + wdep(:,13)                               &amp;     &amp;           +(rc(:,60) *y(:,10))+(dj(:,2)  )                                            y(:,13) = (yp(:,13)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">!         CH4          Y(14)</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,8)  *y(:,27))                                                        l(:) = ddep(:,14) + wdep(:,14)                               &amp;     &amp;           +(rc(:,51) *y(:,10))                                  &amp;                 &amp;           +(rc(:,45) *y(:,2 ))+(rc(:,46) *y(:,2 ))              &amp;     &amp;           +(rc(:,47) *y(:,2 ))                y(:,14) = (yp(:,14)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">!         CO           Y(15)</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,18) *y(:,35))                                  &amp;                 &amp;           +(dj(:,7)  *y(:,27))        +(dj(:,8)  *y(:,27))      &amp;                 &amp;           +(dj(:,3)  *y(:,17))        +(dj(:,4)  *y(:,17))      &amp;                 &amp;           +(rc(:,39) *y(:,5 )*y(:,17))                          &amp;     &amp;           +(rc(:,61) *y(:,10)*y(:,17))                    l(:) = ddep(:,15) + wdep(:,15)                               &amp;     &amp;           +(rc(:,55) *y(:,10))                                                        y(:,15) = (yp(:,15)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">!         HCHO         Y(17)</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,20) *y(:,41))                                  &amp;                  &amp;           +(dj(:,1)  *y(:,20))        +(dj(:,1)  *y(:,39))      &amp;                  &amp;           +(rc(:,68) *y(:,10)*y(:,41))                          &amp;     &amp;           +(rc(:,77) *y(:,10)*y(:,29))                          &amp;     &amp;           +(rc(:,47) *y(:,2 )*y(:,14))                          &amp;     &amp;           +(rc(:,66) *y(:,10)*y(:,20))                          &amp;     &amp;           +(rc(:,35) *y(:,38)*y(:,5 ))                          &amp;     &amp;           +(rc(:,46) *y(:,2 )*y(:,14))                          &amp;     &amp;           +(rc(:,22) *y(:,18)*y(:,28))                          &amp;     &amp;           +(rc(:,34) *y(:,38)*y(:,4 ))                          &amp;     &amp;           +(rc(:,20) *y(:,18)*y(:,18)*2.00)                     &amp;     &amp;           +(rc(:,21) *y(:,18)*y(:,28))                          &amp;     &amp;           +(rc(:,18) *y(:,18)*y(:,5 ))                          &amp;     &amp;           +(rc(:,19) *y(:,18)*y(:,18))                          &amp;     &amp;           +(rc(:,6)  *y(:,11)*y(:,18))                          &amp;     &amp;           +(rc(:,16) *y(:,18)*y(:,4 ))                    l(:) = ddep(:,17) + wdep(:,17)                               &amp;     &amp;           +(dj(:,4)  )                                          &amp;                   &amp;           +(rc(:,39) *y(:,5 ))+(rc(:,61) *y(:,10))+(dj(:,3)  )                        y(:,17) = (yp(:,17)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">!         MeOO         Y(18)</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,7)  *y(:,27))        +(dj(:,19) *y(:,37))      &amp;                  &amp;           +(rc(:,51) *y(:,10)*y(:,14))                          &amp;     &amp;           +(rc(:,67) *y(:,10)*y(:,20))                          &amp;     &amp;           +(rc(:,27) *y(:,28)*y(:,5 ))                          &amp;     &amp;           +(rc(:,45) *y(:,2 )*y(:,14))                          &amp;     &amp;           +(rc(:,25) *y(:,25)*y(:,28))                          &amp;     &amp;           +(rc(:,26) *y(:,28)*y(:,4 ))                          &amp;     &amp;           +(rc(:,10) *y(:,11)*y(:,28))                          &amp;     &amp;           +(rc(:,21) *y(:,18)*y(:,28))                    l(:) = ddep(:,18) + wdep(:,18)                               &amp;     &amp;           +(rc(:,21) *y(:,28))+(rc(:,22) *y(:,28))              &amp;                      &amp;           +(rc(:,19) *y(:,18))+(rc(:,20) *y(:,18))              &amp;     &amp;           +(rc(:,20) *y(:,18))                                  &amp;     &amp;           +(rc(:,17) *y(:,4 ))+(rc(:,18) *y(:,5 ))              &amp;     &amp;           +(rc(:,19) *y(:,18))                                  &amp;     &amp;           +(rc(:,5)  *y(:,11))+(rc(:,6)  *y(:,11))              &amp;     &amp;           +(rc(:,16) *y(:,4 ))                           y(:,18) = (yp(:,18)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">!         MeOOH        Y(20)</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,5)  *y(:,11)*y(:,18))                                                l(:) = ddep(:,20) + wdep(:,20)                               &amp;     &amp;           +(rc(:,66) *y(:,10))+(rc(:,67) *y(:,10))+(dj(:,1)  )                        y(:,20) = (yp(:,20)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">!         HONO         Y(21)</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,97) *y(:,10)*y(:,4 ))                                                l(:) = ddep(:,21) + wdep(:,21)                               &amp;     &amp;           +(rc(:,65) *y(:,10))+(dj(:,17) )                                             y(:,21) = (yp(:,21)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">!         C2H6         Y(24)</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          p(:) = 0.0          l(:) = ddep(:,24) + wdep(:,24)                               &amp;     &amp;           +(rc(:,52) *y(:,10))                                                        y(:,24) = (yp(:,24)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">!         EtOO         Y(25)</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,18) *y(:,35))                                  &amp;             &amp;           +(rc(:,52) *y(:,10)*y(:,24))                          &amp;     &amp;           +(rc(:,58) *y(:,10)*y(:,26))                          &amp;     &amp;           +(rc(:,32) *y(:,36)*y(:,4 ))                          &amp;     &amp;           +(rc(:,33) *y(:,36)*y(:,5 ))                    l(:) = ddep(:,25) + wdep(:,25)                               &amp;     &amp;           +(rc(:,25) *y(:,28))                                  &amp;              &amp;           +(rc(:,7)  *y(:,11))+(rc(:,23) *y(:,4 ))              &amp;     &amp;           +(rc(:,24) *y(:,5 ))                y(:,25) = (yp(:,25)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">!         EtOOH        Y(26)</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,7)  *y(:,11)*y(:,25))                                                l(:) = ddep(:,26) + wdep(:,26)                               &amp;                            &amp;           +(rc(:,57) *y(:,10))+(rc(:,58) *y(:,10))+(dj(:,1)  )                        y(:,26) = (yp(:,26)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">!         MeCHO        Y(27)</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,78) *y(:,10)*y(:,40))+(dj(:,1)  *y(:,26))      &amp;             &amp;           +(rc(:,25) *y(:,25)*y(:,28))                          &amp;     &amp;           +(rc(:,57) *y(:,10)*y(:,26))                          &amp;     &amp;           +(rc(:,23) *y(:,25)*y(:,4 ))                          &amp;     &amp;           +(rc(:,24) *y(:,25)*y(:,5 ))                    l(:) = ddep(:,27) + wdep(:,27)                               &amp;     &amp;           +(dj(:,8)  )                                          &amp;                  &amp;           +(rc(:,40) *y(:,5 ))+(rc(:,73) *y(:,10))+(dj(:,7)  )                        y(:,27) = (yp(:,27)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">!         MeCO3        Y(28)</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,19) *y(:,37))        +(dj(:,1)  *y(:,39))      &amp;             &amp;           +(rc(:,93) *y(:,29))        +(dj(:,16) *y(:,29))      &amp;             &amp;           +(rc(:,40) *y(:,5 )*y(:,27))                          &amp;     &amp;           +(rc(:,73) *y(:,10)*y(:,27))                          &amp;     &amp;           +(rc(:,34) *y(:,38)*y(:,4 ))                          &amp;     &amp;           +(rc(:,35) *y(:,38)*y(:,5 ))                    l(:) = ddep(:,28) + wdep(:,28)                               &amp;     &amp;           +(rc(:,26) *y(:,4 ))+(rc(:,27) *y(:,5 ))              &amp;     &amp;           +(rc(:,92) *y(:,6 ))                                  &amp;     &amp;           +(rc(:,21) *y(:,18))+(rc(:,22) *y(:,18))              &amp;     &amp;           +(rc(:,25) *y(:,25))                                  &amp;     &amp;           +(rc(:,8)  *y(:,11))+(rc(:,9)  *y(:,11))              &amp;     &amp;           +(rc(:,10) *y(:,11))                y(:,28) = (yp(:,28)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">!         PAN          Y(29)</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,92) *y(:,28)*y(:,6 ))                                                l(:) = ddep(:,29) + wdep(:,29)                               &amp;     &amp;           +(rc(:,77) *y(:,10))+(rc(:,93) )        +(dj(:,16) )                        y(:,29) = (yp(:,29)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">!         C3H8         Y(30)</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          p(:) = 0.0          l(:) = ddep(:,30) + wdep(:,30)                               &amp;     &amp;           +(rc(:,53) *y(:,10))+(rc(:,54) *y(:,10))                                    y(:,30) = (yp(:,30)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">!         n-PrOO       Y(31)</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,53) *y(:,10)*y(:,30))                          &amp;     &amp;           +(rc(:,79) *y(:,10)*y(:,33))                    l(:) = ddep(:,31) + wdep(:,31)                               &amp;     &amp;           +(rc(:,11) *y(:,11))+(rc(:,28) *y(:,4 ))              &amp;     &amp;           +(rc(:,29) *y(:,5 ))                y(:,31) = (yp(:,31)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">!         i-PrOO       Y(32)</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,54) *y(:,10)*y(:,30))                          &amp;     &amp;           +(rc(:,81) *y(:,10)*y(:,34))                    l(:) = ddep(:,32) + wdep(:,32)                               &amp;     &amp;           +(rc(:,12) *y(:,11))+(rc(:,30) *y(:,4 ))              &amp;     &amp;           +(rc(:,31) *y(:,5 ))                y(:,32) = (yp(:,32)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">!         n-PrOOH      Y(33)</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,11) *y(:,11)*y(:,31))                                                l(:) = ddep(:,33) + wdep(:,33)                               &amp;     &amp;           +(rc(:,79) *y(:,10))+(rc(:,80) *y(:,10))+(dj(:,1)  )                        y(:,33) = (yp(:,33)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">!         i-PrOOH      Y(34)</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,12) *y(:,11)*y(:,32))                                                l(:) = ddep(:,34) + wdep(:,34)                               &amp;     &amp;           +(rc(:,81) *y(:,10))+(rc(:,82) *y(:,10))+(dj(:,1)  )                        y(:,34) = (yp(:,34)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">!         EtCHO        Y(35)</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,80) *y(:,10)*y(:,33))+(dj(:,1)  *y(:,33))      &amp;             &amp;           +(rc(:,28) *y(:,31)*y(:,4 ))                          &amp;     &amp;           +(rc(:,29) *y(:,31)*y(:,5 ))                    l(:) = ddep(:,35) + wdep(:,35)                               &amp;     &amp;           +(rc(:,41) *y(:,5 ))                                  &amp;     &amp;           +(rc(:,56) *y(:,10))+(dj(:,18) )                        y(:,35) = (yp(:,35)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">!         EtCO3        Y(36)</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,101)*y(:,40))        +(dj(:,16) *y(:,40))      &amp;               &amp;           +(rc(:,41) *y(:,5 )*y(:,35))                          &amp;     &amp;           +(rc(:,56) *y(:,10)*y(:,35))                                        l(:) = ddep(:,36) + wdep(:,36)                               &amp;             &amp;           +(rc(:,33) *y(:,5 ))+(rc(:,100)*y(:,6 ))              &amp;             &amp;           +(rc(:,13) *y(:,11))+(rc(:,14) *y(:,11))              &amp;     &amp;           +(rc(:,32) *y(:,4 ))                y(:,36) = (yp(:,36)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">!         Me2CO        Y(37)</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,82) *y(:,10)*y(:,34))+(dj(:,1)  *y(:,34))      &amp;              &amp;           +(rc(:,30) *y(:,32)*y(:,4 ))                          &amp;     &amp;           +(rc(:,31) *y(:,32)*y(:,5 ))                    l(:) = ddep(:,37) + wdep(:,37)                               &amp;     &amp;           +(dj(:,19) )                                          &amp;              &amp;           +(rc(:,42) *y(:,5 ))+(rc(:,69) *y(:,10))              &amp;     &amp;           +(rc(:,70) *y(:,10))               y(:,37) = (yp(:,37)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">!         MeCOCH2O     Y(38)</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,70) *y(:,10)*y(:,37))                          &amp;     &amp;           +(rc(:,71) *y(:,10)*y(:,39))                          &amp;     &amp;           +(rc(:,42) *y(:,5 )*y(:,37))                          &amp;     &amp;           +(rc(:,69) *y(:,10)*y(:,37))                    l(:) = ddep(:,38) + wdep(:,38)                               &amp;     &amp;           +(rc(:,15) *y(:,11))+(rc(:,34) *y(:,4 ))              &amp;     &amp;           +(rc(:,35) *y(:,5 ))                y(:,38) = (yp(:,38)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">!         MeCOCH2O     Y(39)</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,15) *y(:,11)*y(:,38))                                                l(:) = ddep(:,39) + wdep(:,39)                               &amp;     &amp;           +(rc(:,71) *y(:,10))+(rc(:,72) *y(:,10))+(dj(:,1)  )                        y(:,39) = (yp(:,39)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">!         PPAN         Y(40)</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,100)*y(:,36)*y(:,6 ))                                                l(:) = ddep(:,40) + wdep(:,40)                               &amp;     &amp;           +(rc(:,78) *y(:,10))+(rc(:,101))        +(dj(:,16) )                        y(:,40) = (yp(:,40)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">!         MeONO2       Y(41)</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,17) *y(:,18)*y(:,4 ))                                                l(:) = ddep(:,41) + wdep(:,41)                               &amp;     &amp;           +(rc(:,68) *y(:,10))+(dj(:,20) )                                            y(:,41) = (yp(:,41)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">!         O(3P)S       Y(42)</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,15) *y(:,44))                                  &amp;             &amp;           +(rc(:,87) *y(:,43)*y(:,23))                          &amp;     &amp;           +(rc(:,88) *y(:,43)*y(:,22))                    l(:) = ddep(:,42) + wdep(:,42)                               &amp;     &amp;           +(rc(:,102)*y(:,22))                                                        y(:,42) = (yp(:,42)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">!         O(1D)S       Y(43)</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(dj(:,14) *y(:,44))                                                          l(:) = ddep(:,43) + wdep(:,43)                               &amp;     &amp;           +(rc(:,86) *y(:,19))+(rc(:,87) *y(:,23))              &amp;     &amp;           +(rc(:,88) *y(:,22))                y(:,43) = (yp(:,43)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">!         O3S          Y(44)</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          p(:) = 0.0                                                   &amp;     &amp;           +(rc(:,102)*y(:,42)*y(:,22))                                                l(:) = ddep(:,44) + wdep(:,44)                               &amp;     &amp;           +(dj(:,15) )                                          &amp;             &amp;           +(rc(:,84) *y(:,46))+(rc(:,85) *y(:,45))+(dj(:,14) )                        y(:,44) = (yp(:,44)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">!         OHS          Y(45)</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          p(:) = 0.0          l(:) = ddep(:,45) + wdep(:,45)                               &amp;     &amp;           +(rc(:,85) *y(:,44))                                                        y(:,45) = (yp(:,45)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">!         HO2S         Y(46)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          p(:) = 0.0          l(:) = ddep(:,46) + wdep(:,46)                               &amp;     &amp;           +(rc(:,84) *y(:,44))                                                        y(:,46) = (yp(:,46)+dts*p(:))/(1.0+dts*l(:))</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keywordflow">        END DO</span> <span class="comment">! End of iteration loop stop</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordflow">      END DO</span>  <span class="comment">! n_be_calls</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;           <span class="keywordflow">IF</span> (lhook) <span class="keyword">CALL </span>dr_hook(<span class="stringliteral">&#39;UKCA_DERIV&#39;</span>,zhook_out,zhook_handle)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">      END SUBROUTINE </span><a class="code" href="ukca__deriv_8f90.xhtml#a16d234beeb33da426397ebfda4283a57" title="To perform a chemical integration using the Backward Euler. ">ukca_deriv</a></div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
