<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/control/top_level/atm_step_local_mod.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_b81b067251166617f9d0a8c0cfc3a4a9.xhtml">control</a></li><li class="navelem"><a class="el" href="dir_b65d766d7948d607099cfdc8ce198b76.xhtml">top_level</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">atm_step_local_mod.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="atm__step__local__mod_8f90.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml">    8</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespaceatm__step__local.xhtml" title="Declares variables and allocatable arrays which are local to atm_step!&gt; (and below) ...">atm_step_local</a></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a71305d4d41859bf485f72eab17d16b7d">   12</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a71305d4d41859bf485f72eab17d16b7d">l_rad_step</a>       <span class="comment">! T :activate radiation this timestep</span></div><div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a33673747109255dd3f0a54eeb7d09bad">   13</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a33673747109255dd3f0a54eeb7d09bad">l_rad_step_diag</a>  <span class="comment">! T :activate fast radiation this timestepLOGICAL :: l_rad_step_prog  ! T :activate slow radiation this timestep</span></div><div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a03fba7b4d1d57b221260946461a10b1b">   14</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a03fba7b4d1d57b221260946461a10b1b">l_do_rims</a></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a13486ea259da21475815db979817adea">   16</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a13486ea259da21475815db979817adea">l_do_inc_vels</a></div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7d48e67143f07dc84bbb6e2005b30bbe">   17</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7d48e67143f07dc84bbb6e2005b30bbe">l_do_inc_rho</a>     <span class="comment">! flag for rho incr diagnostic</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ac1e7f35dc4f0a5bdd7f2f131a8be5b17">   19</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ac1e7f35dc4f0a5bdd7f2f131a8be5b17">cycleno</a> <span class="comment">! Number of cycles (iterations) for iterative SISL</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ad2fda277da4e2d42cbbbc79c15998683">   21</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad2fda277da4e2d42cbbbc79c15998683">tr_size</a> <span class="comment">! size of a single tracer - FLUME variable</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a9a967d53011d059c9bb0b3a88f88f962">   23</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a9a967d53011d059c9bb0b3a88f88f962">l_tracer</a> <span class="comment">! T if *any* tracer variables present</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a4a4204b6eb15fd12778194b32c1510dd">   25</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a4a4204b6eb15fd12778194b32c1510dd">l_print_l2norms</a> <span class="comment">! diagnostic printing of l2norms</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a762f5d8b1f9592b541b86772566045bf">   27</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a762f5d8b1f9592b541b86772566045bf">first_constant_r_rho_level</a>    <span class="comment">! 1st rho level with r constant</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7827dcef4c6c4f275d70f4ac41a62f54">   28</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7827dcef4c6c4f275d70f4ac41a62f54">first_constant_r_rho_level_m1</a> <span class="comment">! Max (1,first_constant_r_rho_level)</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a5f7ed3146d953f4ebe151d1508f3fd3c">   30</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a5f7ed3146d953f4ebe151d1508f3fd3c">i_start</a></div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aaaa9651616843bcb3fd778258ef029a8">   31</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a6d5aef7fb2020649d0fdbde0a3d577fe">i_stopinteger</a> :: <a class="code" href="namespaceatm__step__local.xhtml#aaaa9651616843bcb3fd778258ef029a8">j_start</a></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a41457108ba73d20738434349a01d43cc">   32</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a41457108ba73d20738434349a01d43cc">j_stop</a></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ad42231f5185e80e3db2f3619400429da">   33</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad42231f5185e80e3db2f3619400429da">j_begin</a></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a9bca2dd61b2d9f7aca93304c57340a21">   34</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a9bca2dd61b2d9f7aca93304c57340a21">j_end</a></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a4b2b8e9af181670e819b8dfcd988bee1">   36</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a4b2b8e9af181670e819b8dfcd988bee1">lambda_start</a> <span class="comment">! pointer for start of lambda_p/lambda_u on this pe</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a5c3ca1695ceb4b1e5bc03301cc686d86">   39</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a5c3ca1695ceb4b1e5bc03301cc686d86" title="used in interpolation code - no. of levels to check for whether the departure!&gt; point lies inside the...">check_bottom_levels</a></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a730c7ef3fe7f812aa7dde8d184f3d793">   40</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a730c7ef3fe7f812aa7dde8d184f3d793">rhc_row_length</a></div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a217ebe56b5ab86930d953a43559fedf1">   41</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a217ebe56b5ab86930d953a43559fedf1">rhc_rows</a></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aabfce04318610e500fb88db221e6703b">   45</a></span>&#160;<span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aabfce04318610e500fb88db221e6703b" title="Dummy variables for SCM Diagnostics, for passing down to atmos_physics1 and 2 routines. ">nscmdpkgs</a> = 12</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#abaac83d3330c429e39bbf6e1b3708438">   46</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#abaac83d3330c429e39bbf6e1b3708438">l_scmdiags</a>(<a class="code" href="namespaceatm__step__local.xhtml#aabfce04318610e500fb88db221e6703b" title="Dummy variables for SCM Diagnostics, for passing down to atmos_physics1 and 2 routines. ">nscmdpkgs</a>)</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a425ec76a1f20e5049e9a44188a167e4a">   47</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a425ec76a1f20e5049e9a44188a167e4a">l_flux_bc</a>    <span class="comment">! T if prescribed surface fluxes to be used</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a8babedbcecf7b37bf515773b9ecb2a8a">   51</a></span>&#160;<span class="keywordtype">REAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a10e3c1c60e56091d112a36d588e13e6f" title="time-stepping weights. Values may be different at different cycles (UMUI controlled). ">alpha1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0bbb2eca6125963214e36b295299fd25">alpha2</a>, <a class="code" href="namespaceatm__step__local.xhtml#a950732d89c3d56542f3b6944ffbafb69">alpha3</a>, <a class="code" href="namespaceatm__step__local.xhtml#a8babedbcecf7b37bf515773b9ecb2a8a">alpha4</a></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#af843e14b9f2f7947b21bf989223a37d6">   53</a></span>&#160;<span class="keywordtype">REAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#af843e14b9f2f7947b21bf989223a37d6">increment_factor</a> <span class="comment">! For calculating value of LBC at next TL</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae05abd26701f64e242a7a76732af84d1">   56</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ae05abd26701f64e242a7a76732af84d1" title="Variables required for call to SET_LATERAL_BOUNDARIES. ">lbc_size</a>        <span class="comment">! size of a single level of LBC</span></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a81565438746cf7a05f0760bf149ec1dc">   57</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a81565438746cf7a05f0760bf149ec1dc">l_do_halos</a>      <span class="comment">! update the halos?</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7e2311d6643ea89042cbd22fe5e97d51">   58</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7e2311d6643ea89042cbd22fe5e97d51">l_do_boundaries</a> <span class="comment">! update the boundaries?</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a36936e4f0b544eeb40f5e9dad814bd8e">   61</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a2c5d764048ae4ade2418e8a356f089a6" title="REAL, DIMENSION(:,:,:), ALLOCATABLE:: inc_u, inc_v, inc_w, inc_t, inc_rhoREAL, DIMENSION(:,:,:), ALLOCATABLE:: inc_q, inc_qcl, inc_qcf, inc_cf, inc_cfl. ">inc_cff</a>, <a class="code" href="namespaceatm__step__local.xhtml#a36936e4f0b544eeb40f5e9dad814bd8e">inc_qrain</a>, <a class="code" href="namespaceatm__step__local.xhtml#a211d728420e972ceccb2233f071f14c5">inc_qgraup</a>, <a class="code" href="namespaceatm__step__local.xhtml#aa44df5affd84828447d18112ff58850b">inc_qcf2</a></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ac9395fa689137ab2cd6d4cf168abaed8">   63</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ac9395fa689137ab2cd6d4cf168abaed8">nd_o3</a>  <span class="comment">! Total size of ozone array supplied</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ab8b552765ceb89b2b66c4bf5d0c43fa9">   67</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ab8b552765ceb89b2b66c4bf5d0c43fa9" title="Code to do with tropopause diagnostics from O3_to_3D Declare logicals for Stash Diagnostics used in c...">l_o3_trop_level</a>   <span class="comment">! stash code 2,280</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a64b73494602fe76e08e125d6854e60ea">   68</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a64b73494602fe76e08e125d6854e60ea">l_o3_trop_height</a>  <span class="comment">! stash code 2,281</span></div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ad778ddf90c304a56204d8a0c7e32d159">   69</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad778ddf90c304a56204d8a0c7e32d159">l_t_trop_level</a>    <span class="comment">! stash code 2,282</span></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae1e278836ed6954d6872855f26535238">   70</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ae1e278836ed6954d6872855f26535238">l_t_trop_height</a>   <span class="comment">! stash code 2,283</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7978690bf923d7b85ff11a74494656f6">   72</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7978690bf923d7b85ff11a74494656f6">land_pts_trif</a> <span class="comment">! For dimensioning variables in NI_bl_ctl</span></div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a254d7b89e5ca568b9aded8940d561479">   73</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a254d7b89e5ca568b9aded8940d561479">npft_trif</a>     <span class="comment">! Depending on whether TRIFFID is in useREAL, POINTER :: cs(:)  =&gt; NULL() ! soil carbon content &amp; accum soil respirationREAL, POINTER :: rsa(:) =&gt; NULL() ! (target varies according to l_TRIFFID)</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#acc69694f1f2bbeecdbf17757ca10e303">   75</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#acc69694f1f2bbeecdbf17757ca10e303">dim_cs1</a> <span class="comment">! soil C dimension: 1 for single, 4 for RothC</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#afb2f57aeece69e9a6be83f45ab953a3d">   76</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#afb2f57aeece69e9a6be83f45ab953a3d">dim_cs2</a> <span class="comment">! soil C dimension: 1 for single, LAND_FIELD for RothC</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aa59d7912d847ed3441df5598d5f4dbb5">   78</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa59d7912d847ed3441df5598d5f4dbb5">co2_dim_len</a> <span class="comment">! For dimension 3-D CO2 field to be passed</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7e7d818fbd1228458af54bdbdedb32b9">   79</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7e7d818fbd1228458af54bdbdedb32b9">co2_dim_row</a> <span class="comment">!     to NI_bl_ctl</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a4b5af02fe3a3484ef2341b5c3048f9bd">   80</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a4b5af02fe3a3484ef2341b5c3048f9bd">co2_dim_lev</a> <span class="comment">!     and NI_rad_ctl</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aca7f8242debbaae2d7a08c2ec7d352b1">   83</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aca7f8242debbaae2d7a08c2ec7d352b1" title="Array dimensions for sea-salt aerosol. ">salt_dim1</a></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae68b1d9b7711ae3c49fdd8d07d153057">   84</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a63396aff18801bc5f5e6766385b52db5">salt_dim2integer</a> :: <a class="code" href="namespaceatm__step__local.xhtml#ae68b1d9b7711ae3c49fdd8d07d153057">salt_dim3</a></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aa4e98157e4b4f31d33bce1b19a7352f8">   87</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa4e98157e4b4f31d33bce1b19a7352f8" title="Array dimensions for Aero_Ctl. ">aero_dim1</a></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7345ebd3c6c0f3ae3837d631e001717e">   88</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa88191e9b910876971df81678efee405">aero_dim2integer</a> :: <a class="code" href="namespaceatm__step__local.xhtml#a7345ebd3c6c0f3ae3837d631e001717e">aero_dim3</a></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a59ee5f281c45a746952edf7fbb9c1a71">   91</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a59ee5f281c45a746952edf7fbb9c1a71" title="Declare the tropopause variables output for O3_to_3D as allocatable. ">o3_trop_level</a></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#af1e8cad32e4192a3380a4294d868f58c">   92</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#af1e8cad32e4192a3380a4294d868f58c">t_trop_level</a></div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ac15b5dc4367aa726fa5d5321e89d64b3">   93</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#ac15b5dc4367aa726fa5d5321e89d64b3">o3_trop_height</a></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a46cc450b480f61405943a53c4e275789">   94</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a46cc450b480f61405943a53c4e275789">t_trop_height</a></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7f4053b6d0b6b97d85c6d4cbb5589f9c">   97</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a7f4053b6d0b6b97d85c6d4cbb5589f9c" title="3d ozone (expanded from zonal) for radiation ">ozone3d</a></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a4ac6972539f2293061d3ab4dbd477b4b">  100</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a4ac6972539f2293061d3ab4dbd477b4b" title="Local Arrays to store microphysics fields. ">qcf2_star</a>(:,:,:)</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae79b6e94529efa3b4e6c5b70f4c18f3b">  101</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ae79b6e94529efa3b4e6c5b70f4c18f3b">qrain_star</a>(:,:,:)</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a6eb2b8c7da89a35308e4f55da9771a68">  102</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a6eb2b8c7da89a35308e4f55da9771a68">qgraup_star</a>(:,:,:)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">! Local arrays for when using mixing ratios</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a6f0597ce7defcf80a80fbd78b3294c83">  105</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a6f0597ce7defcf80a80fbd78b3294c83">mix_v</a>, <a class="code" href="namespaceatm__step__local.xhtml#a5863e049c7838ebdde91ffa3b217fcf0">mix_cl</a>, <a class="code" href="namespaceatm__step__local.xhtml#adf480fe1c112a671cd8aacba439a7e8f">mix_cf</a></div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#acdfc8483e16ebf13e79da9a823e89db1">  106</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#acdfc8483e16ebf13e79da9a823e89db1">mix_v_inter</a>, <a class="code" href="namespaceatm__step__local.xhtml#ae1f2236d69ca9faaf97e9a61abeef5f6">mix_cl_inter</a>, <a class="code" href="namespaceatm__step__local.xhtml#abcf1e2391e206674fd00f3b6cbdcd484">mix_cf_inter</a></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a0d63daeba345a5ed8b06b07fc9f16851">  107</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a8e048930bb440cc0f5af97861f6dd1ae">mix_cf2</a>, <a class="code" href="namespaceatm__step__local.xhtml#a80777efbd779fcab140c4f9830ce25ea">mix_rain</a>, <a class="code" href="namespaceatm__step__local.xhtml#ac1b3e1d94c2b428bdaf3277160e66d1d">mix_graup</a> <span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a5f0133a3bdba12679b59192e4bd00458">mix_cf2_inter</a>, <a class="code" href="namespaceatm__step__local.xhtml#ac3503b47613224e78bf66bf8a23c6cc7">mix_rain_inter</a></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a484fabdecc7b98f05d2e6b055d0153e0">  108</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a484fabdecc7b98f05d2e6b055d0153e0">mix_graup_inter</a></div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a5e1f95191c2c992252150b548cacf64f">  109</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a93fa7bc6b87fe6faf3c20f7cec35064f">q_store</a>, <a class="code" href="namespaceatm__step__local.xhtml#a4d7e37c294c47593058e0f1e119806e8">qcl_store</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0691f3e7a2e865792d6ee6cf432bfaed">qcf_store</a> <span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa86dfc99ceef43c13be2eeca14ba1f27">qcf2_store</a>, <a class="code" href="namespaceatm__step__local.xhtml#a5e1f95191c2c992252150b548cacf64f">qrain_store</a>, <a class="code" href="namespaceatm__step__local.xhtml#aa7249d35d2d4ec7a899b9253540d2c45">qgraup_store</a></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">!    Local arrays for when using mixing ratios</span></div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a2fcdac4453a29d660639f241ce584206">  112</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2fcdac4453a29d660639f241ce584206">mix_v_star</a>(:,:,:)</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a2e9f52d8f0ee4fee97c2c46249627f6b">  113</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2e9f52d8f0ee4fee97c2c46249627f6b">mix_cl_star</a>(:,:,:)</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ac50153474963d955f79db7f03d2da656">  114</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ac50153474963d955f79db7f03d2da656">mix_cf_star</a>(:,:,:)</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a23a9ed5735405a62275028f0518b094d">  115</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a23a9ed5735405a62275028f0518b094d">mix_cf2_star</a>(:,:,:)</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a2b4c46ff99a37e1ff5e37b77cfb2ecc9">  116</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2b4c46ff99a37e1ff5e37b77cfb2ecc9">mix_rain_star</a>(:,:,:)</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ac6360c0f0085cdaaa8374a1a77449d9e">  117</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ac6360c0f0085cdaaa8374a1a77449d9e">mix_graup_star</a>(:,:,:)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">!  stashworki = stashwork for section i</span></div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#afd1a6a943e9e28b0a4f996b2cee25461">  120</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#af25a47399bc8aeba93ac1c0d5fe43323">stashwork1</a>,<a class="code" href="namespaceatm__step__local.xhtml#a017a59c94f14d5e2263f8e84873fcfdc">stashwork2</a>,<a class="code" href="namespaceatm__step__local.xhtml#afd1a6a943e9e28b0a4f996b2cee25461">stashwork3</a></div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a67687431533406280fc51dd7f293fe3c">  121</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a99da8163b35a60665fb1841d36d62a25">stashwork4</a>,<a class="code" href="namespaceatm__step__local.xhtml#a6c9da3969a3954453123d34eb789de42">stashwork5</a>,<a class="code" href="namespaceatm__step__local.xhtml#a67687431533406280fc51dd7f293fe3c">stashwork6</a></div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#af149bd61446109aa252806942b069aa2">  122</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#aa7a32cdee98cd23c8e79ad9101863e03">stashwork8</a>,<a class="code" href="namespaceatm__step__local.xhtml#af149bd61446109aa252806942b069aa2">stashwork9</a>,<a class="code" href="namespaceatm__step__local.xhtml#aefb970ad4d5d1a8f4a93d5f2a9e7289c">stashwork12</a></div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a04b07b7bd13b86bb4d5672af933416b6">  123</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a7cf74b4a217fae24e5e2778c8672fc77">stashwork13</a>,<a class="code" href="namespaceatm__step__local.xhtml#a30ba958238516f1ac5e02e7f00627b46">stashwork14</a>,<a class="code" href="namespaceatm__step__local.xhtml#a04b07b7bd13b86bb4d5672af933416b6">stashwork17</a></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ab7de4dd2e7bde327fa94a3641c2e8694">  124</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#ad7ee363bef459c7c97ba502e91d167bd">stashwork19</a>,<a class="code" href="namespaceatm__step__local.xhtml#a127d4b71e67b762912c8b74a16b90935">stashwork26</a>,<a class="code" href="namespaceatm__step__local.xhtml#ab7de4dd2e7bde327fa94a3641c2e8694">stashwork30</a></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aea9ff46543d27d47f70cdd340fa93248">  125</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a8642ae7b0b9113cc10fbe40a272d0ebb">stashwork10</a>,<a class="code" href="namespaceatm__step__local.xhtml#a7c735881895c9e6d5f7bdb2eafb13be8">stashwork18</a>,<a class="code" href="namespaceatm__step__local.xhtml#aea9ff46543d27d47f70cdd340fa93248">stashwork35</a></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aa436af594c94212cd50f0b7cffa745eb">  126</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#aa436af594c94212cd50f0b7cffa745eb">stashwork39</a></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a41b7ec2d47f7c3e5e1ac5c01cf6d4860">  128</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a41b7ec2d47f7c3e5e1ac5c01cf6d4860">stashwork21</a>(:)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">! Local dynamic arrays for phys1 and phys2 increments for moisture:</span></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a3db2349cc05bb89ab6aca0c20f0523a0">  131</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a02824d936d1d3b70e911a74d721fc89f">q_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a3db2349cc05bb89ab6aca0c20f0523a0">qcl_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#ad090cfce6c8305e62e10b00df1e0e378">qcf_phys1</a></div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aff2d00d420eea3e19cc48c67cd1c213f">  132</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a6d8030d4d24f543a5fd0a3c6137c4622">q_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#aff2d00d420eea3e19cc48c67cd1c213f">qcl_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#ac60bb0c212891ab8edf00fba61c3f431">qcf_phys2</a></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a83aed3fb4f90580d39d27c2cb73e03c4">  133</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa973a14a7ffc948b3a2a87ee270a4f6b">qcf2_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a83aed3fb4f90580d39d27c2cb73e03c4">qrain_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a79dec7ca5ce457236050763ba596cd6b">qgraup_phys1</a></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7f8a8d0084962364f72cfe7fb19548ea">  134</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a0b315ed9e5152bdc039a2bf98bde7dbb">qcf2_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#a7f8a8d0084962364f72cfe7fb19548ea">qrain_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#af271dff313fcf68bac3ebf14c97c2915">qgraup_phys2</a></div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a51228e8f5a7392aad8b74cac809f91ee">  135</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a51228e8f5a7392aad8b74cac809f91ee">mix_v_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a028de52d666a900fe573cc18a7e653d9">mix_cl_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#ae7ac73f90f10949d26775a697927b218">mix_cf_phys1</a></div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a31873b256a489eeec702787684ae5c91">  136</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a31873b256a489eeec702787684ae5c91">mix_v_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#a9469c4548ae41c82307259dc0294c70f">mix_cl_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#ab40f12c4446501b42c508182486bad24">mix_cf_phys2</a></div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a0bb205fdc571a4ae61320b0fc67b0d4a">  137</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a1060def82a7acedac5d0f867546d4827">mix_cf2_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0bb205fdc571a4ae61320b0fc67b0d4a">mix_rain_phys1</a></div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae4f77e8539550717724813ce1d8ba53d">  138</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a86fea8eaf7f2f83e1c8067e7fb7f0576">mix_cf2_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#ae4f77e8539550717724813ce1d8ba53d">mix_rain_phys2</a></div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a298efb40e2c48267b4c95eb8243df1db">  139</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a38453438e38540a0cb7b65a4dc046025">mix_graup_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a298efb40e2c48267b4c95eb8243df1db">mix_graup_phys2</a></div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a0ea5ebf59ca9ce0b3c9314bd73692fce">  140</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ac046cf0908da6ce5317a4446eb8d5a15">cf_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0ea5ebf59ca9ce0b3c9314bd73692fce">cfl_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a68df7ea49c121350ec2f3085fb773f1a">cff_phys1</a></div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a42a65dbe73f0f99ee29fce02fbcbd0ca">  141</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2fb07737544ed74e6d9c93f22de543b0">cf_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#a42a65dbe73f0f99ee29fce02fbcbd0ca">cfl_phys2</a>, <a class="code" href="namespaceatm__step__local.xhtml#a43f48d0342165836aea03cf298dd804d">cff_phys2</a></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">! local dynamic arrays for PC2</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a4eac350f391eaed58dfab33f0be8cce1">  144</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a4eac350f391eaed58dfab33f0be8cce1">t_inc_pres</a>, <a class="code" href="namespaceatm__step__local.xhtml#a4526a2e34da115728f2f4f4d93938ef3">q_inc_pres</a>, <a class="code" href="namespaceatm__step__local.xhtml#a83da96758a0651a2faf8abf5f9b4a4a0">qcl_inc_pres</a></div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a385b3462d021a8d2252b2bbf77b3cabd">  145</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2d3c4699c72d5dfbd67d328c4479e25b">qcf_inc_pres</a>, <a class="code" href="namespaceatm__step__local.xhtml#aeef8c109685b5b5b02d47862a17c84b4">cf_inc_presreal</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad7c7dc5d57f1a1feb271aa49e3a6e6ee">cfl_inc_pres</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0cf8f8288994528348becc2e31e4f213">cff_inc_presreal</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a385b3462d021a8d2252b2bbf77b3cabd">t_dini</a>, <a class="code" href="namespaceatm__step__local.xhtml#acc9db68989de1fe226d76929c4236053">q_dini</a>, <a class="code" href="namespaceatm__step__local.xhtml#ab756e377d714d66fd139495e52c3e95d">qcl_dini</a></div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7e9e04bebeec52c6f3de524f9cff6bfe">  146</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7e9e04bebeec52c6f3de524f9cff6bfe">qcf_dini</a>, <a class="code" href="namespaceatm__step__local.xhtml#a01c5998b4e3be6b573443df65ddbfb68">cf_dini</a></div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a2634aaeb52c2a3f92f3d6b8cffafa718">  147</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a0db09b9c93546176998539df3111fffa">cfl_dini</a>, <a class="code" href="namespaceatm__step__local.xhtml#af0cd3f1ec48822471f6011c5e3a29d38">cff_dini</a>, <a class="code" href="namespaceatm__step__local.xhtml#a1f44dae1ddd29196211b2065e0c47028">rhtsreal</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aacbfbc75a9c3cc7f7c0ab82fc0d7f914">qtts</a>, <a class="code" href="namespaceatm__step__local.xhtml#a2634aaeb52c2a3f92f3d6b8cffafa718">tlts</a>, <a class="code" href="namespaceatm__step__local.xhtml#a4932ec4daa7b640df336aa3db978ccf1">ptts</a></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">! Extra variables needed for cycling</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">! Vars ending in _phys1 are copies holding the value the original</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">! variable had after exiting phys1.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">! Vars ending in _np1 are tn+1 estimates holding the value the original</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">! variable had at the end of the last cycle (provided that CycleNo&gt;1).</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">! obtained from the last</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">! cycle when CycleNo&gt;1.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#af0e33b2acf5f6e8e2562acdd6419a6ca">  157</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad1d540ad23c89a9cb946e8060f93e172">r_u_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#af0e33b2acf5f6e8e2562acdd6419a6ca">r_v_phys1</a></div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a611e0d8e1e27f0f79153a48582006f96">  158</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a611e0d8e1e27f0f79153a48582006f96">thetastar_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a4615e585dfedcf7730bb98027b4a04e5">qstar_phys1</a></div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a0a9b8c65edda9698da2777fb38468827">  159</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a0a9b8c65edda9698da2777fb38468827">qclstar_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a6e47621d78b3fe923e97216fd3501848">qcfstar_phys1</a></div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a0374fdb1bc8d3744a4a65e65a762b1d7">  160</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a315910564fb4120541ed8c52a3a5116a">qcf2_star_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0374fdb1bc8d3744a4a65e65a762b1d7">qrain_star_phys1</a></div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ababf0b2dbf5e59dccd7e7160e66c7b9b">  161</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ae2bc5fcbe4deca98e8785634a732cf2d">qgraup_star_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#ababf0b2dbf5e59dccd7e7160e66c7b9b">ti_phys1</a></div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a752ab32e69e95372ecaf16f212e1a9b5">  162</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a752ab32e69e95372ecaf16f212e1a9b5">cca_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#aa76587ffc7fb1c66c384b34c4493d724">area_cld_frac_phys1</a></div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a9a3699f3853d6233b20ce0eafb5a0cd5">  163</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a1feca79ad8ae41bcffb143aa33354720">bulk_cld_frac_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a9a3699f3853d6233b20ce0eafb5a0cd5">bulk_cld_liq_phys1</a></div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a11b4f12cb6049466d1f98269b29c4647">  164</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a11b4f12cb6049466d1f98269b29c4647">bulk_cld_fr_phys1</a></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ac86ccd5165cf367211dfa8e8e05fe1c3">  166</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ac86ccd5165cf367211dfa8e8e05fe1c3">wetrho_r_sq_np1</a>(:,:,:)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a106dc8a0dbb24dec7f15485bdce58444">  168</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a106dc8a0dbb24dec7f15485bdce58444">u_np1</a>(:,:,:)</div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a11a7145a990ac092321fa2841a5af354">  169</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a11a7145a990ac092321fa2841a5af354">v_np1</a>(:,:,:)</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7367df0d4f0c53dcc16498f99cabd88c">  170</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7367df0d4f0c53dcc16498f99cabd88c">w_np1</a>(:,:,:)</div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a965617644a1b0ed3b7bd423f0ff0bdfa">  171</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a965617644a1b0ed3b7bd423f0ff0bdfa">theta_np1</a>(:,:,:)</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae1eff15e21ecc99ccdf70dc51580f931">  172</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ae1eff15e21ecc99ccdf70dc51580f931">dryrho_np1</a>(:,:,:)</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a2b5247c3d1aafc91b8d63f4e086b0c65">  173</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2b5247c3d1aafc91b8d63f4e086b0c65">rho_np1</a>(:,:,:)</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a17ed2f9990402fbb5356c2b4289bc966">  174</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a17ed2f9990402fbb5356c2b4289bc966">q_np1</a>(:,:,:)</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a56df13120ccdd621728cb13b5416f5c4">  175</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a56df13120ccdd621728cb13b5416f5c4">qcf_np1</a>(:,:,:)</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ab66a5721788fddae4927c765c38aa655">  176</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ab66a5721788fddae4927c765c38aa655">qcl_np1</a>(:,:,:)</div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a86aaf92eb2198dc71bc6f3d0bfadf535">  177</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a86aaf92eb2198dc71bc6f3d0bfadf535">qcf2_np1</a>(:,:,:)</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a403e0d0217fcbdcbfcffc2111cf4c790">  178</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a403e0d0217fcbdcbfcffc2111cf4c790">qrain_np1</a>(:,:,:)</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae5e6fee9e9bb6b94ec127473012b5caa">  179</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ae5e6fee9e9bb6b94ec127473012b5caa">qgraup_np1</a>(:,:,:)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7f92373a898c7a11a6c330e47e0c7b97">  181</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7f92373a898c7a11a6c330e47e0c7b97">etadot_np1</a>(:,:,:)</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a5da60cc5c8f3225393806859da605481">  182</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a5da60cc5c8f3225393806859da605481">thetav_np1</a>(:,:,:)</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aa90cbe19d5f10e3771843e4ad4d607c6">  183</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa90cbe19d5f10e3771843e4ad4d607c6">exner_np1</a>(:,:,:)</div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#afaaceba8335c3547682486fa151450fa">  184</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#afaaceba8335c3547682486fa151450fa">exner_surf_np1</a>(:,:)</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae5a777111bec02d8bf05c04a82a17a96">  185</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ae5a777111bec02d8bf05c04a82a17a96">m_v_np1</a>(:,:,:)</div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a94f70948b082e714f290899102bfff51">  186</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a94f70948b082e714f290899102bfff51">m_cl_np1</a>(:,:,:)</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a60b92da1b481a821db715722ea871225">  187</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a5051cdd5c147aa23fc557b774d9b5079">m_cf_np1</a>(:,:,:)                    <span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2b36499a51b3565eae553b7cc236e475">m_r_np1</a>(:,:,:)</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aff7bb87ff465f956c84d0489562f2efd">  188</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aff7bb87ff465f956c84d0489562f2efd">m_gr_np1</a>(:,:,:)</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ade8ff1e3d3023d456e20ff738595e183">  189</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">SAVE</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">TARGET</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ade8ff1e3d3023d456e20ff738595e183">m_cf2_np1</a>(:,:,:)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a58ea26721f3aecd79039aa8b6d34c0b1">  192</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#af3556f1b0c79f235f323ccb6f140a9a2">z0msea_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a58ea26721f3aecd79039aa8b6d34c0b1">zh_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#ae759957f6fcf9c94982148192dfeb636">ddmfx_phys1</a>, &amp;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                     <a class="code" href="namespaceatm__step__local.xhtml#ab4e29ec120778585e5199ce031cedc2e">ti_gb_phys1</a></div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ad021e8553a686c985c9ffb2e57a56367">  194</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a0d671601bdb7c2848a58ba07e96a133c">deep_flag_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#ad021e8553a686c985c9ffb2e57a56367">past_precip_phys1</a>,&amp;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                     <a class="code" href="namespaceatm__step__local.xhtml#aaa8e404ede624a725257143df9eea374">past_conv_ht_phys1</a></div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a9fd695ad3c4a2d75b2eaf7b252d55af5">  196</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a9fd695ad3c4a2d75b2eaf7b252d55af5">t_land_ctile_phys1</a></div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#af24cbc1461ee70f57cd9690842b5528c">  197</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#af24cbc1461ee70f57cd9690842b5528c">t_sice_ctile_phys1</a></div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a6a017d1c872e5067a9c0e04d78213566">  198</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a6a017d1c872e5067a9c0e04d78213566">t_surf_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a8523744020ff4960da9b355667a0259d">t_sf_tile_phys1</a></div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a956d4403cd822a52a2cbfe88856e1674">  199</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a956d4403cd822a52a2cbfe88856e1674">snow_tile_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#acd4a512d835257426ea731ab9952e6c5">dolr_phys1</a></div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a26e3953bdcde80c72750151b06f10816">  200</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: <a class="code" href="namespaceatm__step__local.xhtml#a26e3953bdcde80c72750151b06f10816">rho_lbc_real_tend</a></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a0489e1352c0a874374e6376deb54540f">  202</a></span>&#160;<span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ab08148fb6eef717fda68faaeb9b176a3">ccb_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0489e1352c0a874374e6376deb54540f">cct_phys1</a></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">! Additional variables needed for cycling when mixing ratios are used</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a42319e6ab36576e7b3fa97b25aa1e02e">  206</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a42319e6ab36576e7b3fa97b25aa1e02e">mix_v_star_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0f4f80ed8f95fbcff25e380af5465427">mix_cl_star_phys1real</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ab6cdb251d1cffed13f4df51ab8ba0103">mix_cf_star_phys1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a2e1a078e9f846776a7b91b1eb3b10a2f">mix_cf2_star_phys1</a></div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#af7af299f73ef31d18cc7dcf0d7c1ecd4">  207</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#af7af299f73ef31d18cc7dcf0d7c1ecd4">mix_rain_star_phys1</a></div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#adc0ea8625579d50360f16af5e927a712">  208</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a91be16e2281b0051f7e109abfbe219a2">mix_graup_star_phys1real</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#adc0ea8625579d50360f16af5e927a712">mix_v_np1</a>, <a class="code" href="namespaceatm__step__local.xhtml#adb6be48450d076f6a79cd4bfb2d5c83a">mix_cl_np1</a>, <a class="code" href="namespaceatm__step__local.xhtml#a2831343dccf9647da7312bd56e742637">mix_cf_np1real</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a8b8a25ed2ebc2ef1d3b0589d628ea259">mix_cf2_np1</a>, <a class="code" href="namespaceatm__step__local.xhtml#ae4dbba74af4f8ac68d9b6b2f07065f8b">mix_rain_np1</a></div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7106ed0a102c83d64e7382079c863e70">  209</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7106ed0a102c83d64e7382079c863e70">mix_graup_np1</a></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">! Variables required for ice category selection</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ac523f5a73a5c68cdbbf2373f57ceeea4">  212</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ac523f5a73a5c68cdbbf2373f57ceeea4">p_ti</a>(:,:,:)        =&gt; null()</div><div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a20a759ce714f9a24ac7a9ee33cfefb00">  213</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a20a759ce714f9a24ac7a9ee33cfefb00">p_ice_fract</a>(:,:,:) =&gt; null()</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7a9610de47a8a62f71b17d20b19eec66">  214</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7a9610de47a8a62f71b17d20b19eec66">p_ice_thick</a>(:,:,:) =&gt; null()</div><div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a044aa570c733f1b60d5734643554a8f6">  215</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a044aa570c733f1b60d5734643554a8f6">p_tstar_sice</a>(:,:,:) =&gt; null()</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a2b0292ad9d1123484938db08f38bc184">  216</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2b0292ad9d1123484938db08f38bc184">p_snodep_sice</a>(:,:,:) =&gt; null()</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a925f33873d9b99cc92b0811e7fa3c26f">  217</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a925f33873d9b99cc92b0811e7fa3c26f">p_ice_thick_rad</a>(:,:,:) =&gt; null()</div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#abe8b87a1755680fb0319edcb765b4686">  218</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">POINTER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#abe8b87a1755680fb0319edcb765b4686">p_ice_fract_rad</a>(:,:,:) =&gt; null()</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">! increment diagnostics:</span></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a3507d02536104370e06b0350880cbc30">  221</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad58352ad357ff16230aa96a58de1a795">u_incr_diagnostic</a>, <a class="code" href="namespaceatm__step__local.xhtml#a3507d02536104370e06b0350880cbc30">v_incr_diagnostic</a></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a5a373d6f9279d268eeb7960dc4276b95">  222</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a5a373d6f9279d268eeb7960dc4276b95">t_incr_diagnosticreal</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a635ffd53a9d370f7dc41eb96bacb2914">q_incr_diagnosticreal</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2f64d15c28d1cef2535c235512425995">qcl_incr_diagnostic</a></div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a6873d117289da13466a08b5eb2c8df22">  223</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a9fa9f89369f1bfe89425f15a3561f49a">qcf_incr_diagnosticreal</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a6873d117289da13466a08b5eb2c8df22">qrain_incr_diagnostic</a></div><div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a353125403d7088ca06719dad3127a776">  224</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a353125403d7088ca06719dad3127a776">qgraup_incr_diagnostic</a></div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a6672a2cd443b51226aa5aaef57643c99">  225</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a6672a2cd443b51226aa5aaef57643c99">qcf2_incr_diagnostic</a></div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ae81da8981b5def1c22766ccdcabf5ae0">  226</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ae81da8981b5def1c22766ccdcabf5ae0">cf_incr_diagnostic</a></div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a3a2c65d9465850efabcfac7e65125b3c">  227</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a3a2c65d9465850efabcfac7e65125b3c">cfl_incr_diagnostic</a></div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a91aa21be090a5fafd088245774db0b42">  228</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a91aa21be090a5fafd088245774db0b42">cff_incr_diagnostic</a></div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a368078f487355104ba94dbbae0dbddbb">  229</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a368078f487355104ba94dbbae0dbddbb">w_incr_diagnostic</a></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#adbb0fe657041bc4ea0249900245b28a3">  231</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#adbb0fe657041bc4ea0249900245b28a3">w_local_mask</a></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">! Allocatable arrays for use in AC_CTL call</span></div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a1602c9d47617ea1b858d54ffd1ef3c04">  234</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a5798fa376d3bd70d10d3b881ad3605af">work_q</a>, <a class="code" href="namespaceatm__step__local.xhtml#a1602c9d47617ea1b858d54ffd1ef3c04">work_qcl</a>, <a class="code" href="namespaceatm__step__local.xhtml#aa8202a3bf54b22287632950d1cda1ebf">work_qcf</a></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">! Workspace defined as allocatable arrays, since they each communicate</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">! fields between near adjacent calls and only need to use memory for</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">! a subset of the total routine.</span></div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a02661a070d0f387564abf17a7ca75276">  239</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a02661a070d0f387564abf17a7ca75276">exner_prime</a> <span class="comment">! soln to helmholtz solver</span></div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#af26425e90047c6397346afd095dbc74c">  240</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#af26425e90047c6397346afd095dbc74c">dtheta_dr_termreal</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a2f83326b1a325154539f782b8bb17d96">depart_lambda</a>, <a class="code" href="namespaceatm__step__local.xhtml#a7b3fed4c8b0c44287fea6bdebe8e287e">depart_phireal</a>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a6ee20d32d046013c850b0d83d2a4fcf5">depart_r_theta</a>, <a class="code" href="namespaceatm__step__local.xhtml#a398ce6e035668f3c362f62782f982d80">depart_r_w</a></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ad9a5f8afb1e329eebd03c88032de709f">  242</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad9a5f8afb1e329eebd03c88032de709f">rhcpt</a>(:,:,:)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">!LOGICAL ::  gather   ! Convert to sea_ice points within BL code</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<a class="code" href="namespaceukca__radaer__struct__mod.xhtml#a7b11899c3ce190bb3d00d3a633af780e">parameter</a>( gather = .true. ) <span class="comment">! (was l_compress_seaice)</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a818392a645ba05392f94bdbaee41363c">  247</a></span>&#160;<span class="keywordtype">INTEGER</span> :: i, j, <a class="code" href="namespaceatm__step__local.xhtml#a36306cf03348750bfd3418511f8bcd10">k</a>, <a class="code" href="namespaceatm__step__local.xhtml#a818392a645ba05392f94bdbaee41363c">l</a>   <span class="comment">! loop counters</span></div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a61d5feb466e04ff5d5e0ea5e23397b81">  248</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a61d5feb466e04ff5d5e0ea5e23397b81">ij</a>           <span class="comment">! 2D array index for offx/y variables</span></div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ac87906ac3ab07d3da71224be12575f40">  249</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ac87906ac3ab07d3da71224be12575f40">lbc_pt</a>       <span class="comment">! pointer to LBC array</span></div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aa0754e140aebe305de0128fd1d7971f0">  250</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa0754e140aebe305de0128fd1d7971f0">ij_u</a>         <span class="comment">! 2D array index for U offx/y variables</span></div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7436e22036fe758f20ab1a02b3116b11">  251</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7436e22036fe758f20ab1a02b3116b11">ij_v</a>         <span class="comment">! 2D array index for V offx/y variables</span></div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a194386bedfa768c1d11210d749d00d67">  252</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a194386bedfa768c1d11210d749d00d67">ji</a>           <span class="comment">! 2D array index for halo_i/j variables</span></div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ad812eea39a9990b0458e4611341a0f8f">  253</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad812eea39a9990b0458e4611341a0f8f">icount</a>       <span class="comment">! diagnostic count</span></div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aa83af58924e7e91f01d32b357720eb69">  254</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa83af58924e7e91f01d32b357720eb69">j_ti</a>, <a class="code" href="namespaceatm__step__local.xhtml#a4d496309f62749b088be97b82d1d59da">j_ice_fract</a>, <a class="code" href="namespaceatm__step__local.xhtml#aeb651e6df8439844a1280fd337c46076">j_ice_thick</a></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a6118e9e3fb33a9065d0267da5701d963">  256</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a6118e9e3fb33a9065d0267da5701d963">n_y_arrays</a>    <span class="comment">! = 1 for global, 3 for LAM</span></div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a5c3992e80f0dfd527a0b53f81182114e">  257</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a5c3992e80f0dfd527a0b53f81182114e">n_yw_arrays</a>   <span class="comment">! = 1 for global, 2 for LAM</span></div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a8c7cd0a942165f34509ff380bb835db9">  258</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a8c7cd0a942165f34509ff380bb835db9">n_yd_arrays</a>   <span class="comment">! = 1 for global, 3 for LAM</span></div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a303deebd072af53d0394b83dc2fd168f">  259</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a303deebd072af53d0394b83dc2fd168f">n_ydw_arrays</a>  <span class="comment">! = 1 for global, 2 for LAM</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a3816f85fb29108279b584c478b01385b">  261</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a3816f85fb29108279b584c478b01385b">i_field</a>       <span class="comment">! fields in multivariate swapbounds</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aa15bb86b8f205fa5fc244b2aadc4c869">  263</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aa15bb86b8f205fa5fc244b2aadc4c869">info</a>          <span class="comment">! icode return from umFlush</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a58c96c271f8214eac40d93aadc1e6f38">  265</a></span>&#160;<span class="keywordtype">REAL</span>  ::   <a class="code" href="namespaceatm__step__local.xhtml#aa8d250611631b867ff830d7b0d3a76c7">constantreal</a>  ::   <a class="code" href="namespaceatm__step__local.xhtml#a58c96c271f8214eac40d93aadc1e6f38">h_print</a>     <span class="comment">! needed for printing idealised orography</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#aae0fbcf7a96e6b5a6fd168c643f7ea9d">  267</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#aae0fbcf7a96e6b5a6fd168c643f7ea9d">l_update_lbcs</a>, <a class="code" href="namespaceatm__step__local.xhtml#af324c85e64a45fb6ae51cdba40d56bfc">l_apply_lbcs</a>, <a class="code" href="namespaceatm__step__local.xhtml#a48dd467b9f048ffaea87d6a577c83646">l_balance</a>, <a class="code" href="namespaceatm__step__local.xhtml#a11b1b78686e8d122144fab67ae6df1b7">gcr_zero_guess_it</a></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#abc02ccb130b1829994c9dd368c32628b">  269</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#abc02ccb130b1829994c9dd368c32628b">itemp</a></div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a51f369c54361cdb0f42ad639d597fc75">  270</a></span>&#160;<span class="keywordtype">INTEGER</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a51f369c54361cdb0f42ad639d597fc75">gi</a></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">! Oxidant mass-mixing ratios and concentrations, for use in sulphur</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">! cycle.</span></div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ad651adf57aca733be77b957cc79b6db2">  274</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad651adf57aca733be77b957cc79b6db2">o3_mmr</a>, <a class="code" href="namespaceatm__step__local.xhtml#a62f5f24be6d364127fc71bb874d2ac97">hno3_mmr</a>, <a class="code" href="namespaceatm__step__local.xhtml#aee55837b4fe3be2e8a89ef9c5a95d9be">h2o2_mmr</a></div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a49abf454f10cec6cf9941c12de98e0b4">  275</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a49abf454f10cec6cf9941c12de98e0b4">oh_conc</a>, <a class="code" href="namespaceatm__step__local.xhtml#a0eb695cb8db6c01f62addd8cb4eb1364">ho2_conc</a> </div><div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a189b8a0bf4407f44fffcff1578de4553">  276</a></span>&#160;<span class="keywordtype">LOGICAL</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a189b8a0bf4407f44fffcff1578de4553">l_physics_store</a></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">! Local variables for using the aerosol climatology for NWP</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">! Internal array of mass-mixing ratios</span></div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a65fcaacf93d483f36a82df002aed3ce6">  280</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a65fcaacf93d483f36a82df002aed3ce6">arcl</a></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     <span class="comment">! Number of requested species within the climatology</span></div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a1214a061fb5b746dd54f3b677308c9a6">  282</a></span>&#160;<span class="keywordtype">INTEGER</span> <a class="code" href="namespaceatm__step__local.xhtml#a1214a061fb5b746dd54f3b677308c9a6">n_arcl_species</a></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">! Corresponding number of requested components</span></div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7d699b086ef6c3da65b632fa0ed7f2ec">  285</a></span>&#160;<span class="keywordtype">INTEGER</span> <a class="code" href="namespaceatm__step__local.xhtml#a7d699b086ef6c3da65b632fa0ed7f2ec">n_arcl_compnts</a></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">! Declare allocatable arrays for passing cloud fractions</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">! to LS_ACF_Brooks</span></div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a3a06cfed77cf1f534eda5b65ebfd526a">  289</a></span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION (:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span>:: &amp;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <a class="code" href="namespaceatm__step__local.xhtml#afc793acb180ac47eabc432fdf8e100ae">cf_bulk_nohalo</a>, <a class="code" href="namespaceatm__step__local.xhtml#a3a06cfed77cf1f534eda5b65ebfd526a">cf_liquid_nohalo</a>, <a class="code" href="namespaceatm__step__local.xhtml#aa6c6a812f155baed62fb495c358929cd">cf_frozen_nohalo</a></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#a7efd05dd20ff70b47e3be8a4105ab833">  293</a></span>&#160;<span class="keywordtype">LOGICAL</span>, <span class="keywordtype">SAVE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#a7efd05dd20ff70b47e3be8a4105ab833">first_atmstep_call</a> = .true.</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="namespaceatm__step__local.xhtml#ad588d11b7a957c9d1f66e939c5c942e9">  294</a></span>&#160;<span class="keywordtype">LOGICAL</span>, <span class="keywordtype">SAVE</span> :: <a class="code" href="namespaceatm__step__local.xhtml#ad588d11b7a957c9d1f66e939c5c942e9">iau_in_initial</a>     = .false. <span class="comment">! Flag to test within atm_step if IAU ran in initial</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespaceatm__step__local.xhtml" title="Declares variables and allocatable arrays which are local to atm_step!&gt; (and below) ...">atm_step_local</a></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
