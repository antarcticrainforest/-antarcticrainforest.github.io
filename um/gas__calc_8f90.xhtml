<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/atmosphere/radiation_control/gas_calc.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_1df14ea1ac826f73bc3062fa8a76e0c2.xhtml">atmosphere</a></li><li class="navelem"><a class="el" href="dir_f3ced4ca4d97f20ad26ce2534c2046c2.xhtml">radiation_control</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">gas_calc.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="gas__calc_8f90_source.xhtml">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8fe88020248adfee44073592dffa4de7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfacesubroutine.xhtml">subroutine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gas__calc_8f90.xhtml#a8fe88020248adfee44073592dffa4de7">gas_calc</a> (gas_now, gas_index_max, gas_year, gas_conc, gas_rate, max_scenario_pts, icode)</td></tr>
<tr class="memdesc:a8fe88020248adfee44073592dffa4de7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine GAS_CALC!&gt; Purpose : Subroutine GAS_CALC!&gt; Purpose : Calculates the trace gas mixing ratio (or weighting factor for aerosol forcing fields. Rates of increase (yearly compound factors) can be supplied, or spot values (which will be linearly interpolated) or a mixture of these. It is designed so it can be called each time step, but when rates of increase are being used, values are in fact only updated at New Year. The rules are: If rates exist (i.e. are positive) for the first &amp; current years then all concentrations are ignored, except for the initial value. If there is a positive rate for the current year but not for the start, the current rate &amp; most recent concentration are used. If rates do not exist for the current year then the concentration is calculated by linear interpolation between the concentrations at the given years. The mixing ratios calculated after the last given year use the rate for the final given year. The 360-day year is assumed. CARE should be taken if solitary rates are specified, as this can result in discontinuities in the concentration time profile at the next given year without a corresponding given rate.  <a href="#a8fe88020248adfee44073592dffa4de7">More...</a><br /></td></tr>
<tr class="separator:a8fe88020248adfee44073592dffa4de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a8fe88020248adfee44073592dffa4de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fe88020248adfee44073592dffa4de7">&#9670;&nbsp;</a></span>gas_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfacesubroutine.xhtml">subroutine</a> gas_calc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>&#160;</td>
          <td class="paramname"><em>gas_now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>gas_index_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>, dimension(max_scenario_pts)&#160;</td>
          <td class="paramname"><em>gas_year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(max_scenario_pts)&#160;</td>
          <td class="paramname"><em>gas_conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="c__fort2c__2a_8h.xhtml#a031f8951175b43076c2084a6c2173410">real</a>, dimension(max_scenario_pts)&#160;</td>
          <td class="paramname"><em>gas_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>max_scenario_pts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>&#160;</td>
          <td class="paramname"><em>icode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine GAS_CALC!&gt; Purpose : Subroutine GAS_CALC!&gt; Purpose : Calculates the trace gas mixing ratio (or weighting factor for aerosol forcing fields. Rates of increase (yearly compound factors) can be supplied, or spot values (which will be linearly interpolated) or a mixture of these. It is designed so it can be called each time step, but when rates of increase are being used, values are in fact only updated at New Year. The rules are: If rates exist (i.e. are positive) for the first &amp; current years then all concentrations are ignored, except for the initial value. If there is a positive rate for the current year but not for the start, the current rate &amp; most recent concentration are used. If rates do not exist for the current year then the concentration is calculated by linear interpolation between the concentrations at the given years. The mixing ratios calculated after the last given year use the rate for the final given year. The 360-day year is assumed. CARE should be taken if solitary rates are specified, as this can result in discontinuities in the concentration time profile at the next given year without a corresponding given rate. </p>
<p>This file belongs in section: Radiation Control</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gas_now</td><td>Maximum size of common block arrays Submodel parameters for array sizes </td></tr>
  </table>
  </dd>
</dl>
<p>Common blocks</p>
<p>Model time </p><pre class="fragment">Local variables </pre><pre class="fragment">                           !&gt; Time now in days/secs from time zero </pre><pre class="fragment">                           !&gt; Time in days/secs of current GAS_YEAR </pre><pre class="fragment">                           !&gt; The same converted to seconds </pre><pre class="fragment">                           !&gt; Time in days/secs of next GAS_YEAR </pre><pre class="fragment"> Check that GASCNST namelist is defined for this year </pre><pre class="fragment"> Loop over I to find correct index for current NOW_TIME </pre><pre class="fragment"> Calculate time now in seconds
</pre><p> DEPENDS ON: time2sec </p><pre class="fragment">If gas rate at current year is non zero calculate new GAS_NOW
by considering compound increases of GAS_RATE(1:INDEX) </pre>
<p class="definition">Definition at line <a class="el" href="gas__calc_8f90_source.xhtml#l00034">34</a> of file <a class="el" href="gas__calc_8f90_source.xhtml">gas_calc.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="gas__calc_8f90_a8fe88020248adfee44073592dffa4de7_cgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="gas__calc_8f90_a8fe88020248adfee44073592dffa4de7_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
