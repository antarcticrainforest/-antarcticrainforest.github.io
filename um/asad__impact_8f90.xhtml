<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UM General Atmosphere: /home/wilfred/PhD/UM/src/atmosphere/UKCA/asad_impact.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="unified_model_logo_2.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UM General Atmosphere
   &#160;<span id="projectnumber">8.6</span>
   </div>
   <div id="projectbrief">UK Met Offices Unified Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.xhtml">src</a></li><li class="navelem"><a class="el" href="dir_1df14ea1ac826f73bc3062fa8a76e0c2.xhtml">atmosphere</a></li><li class="navelem"><a class="el" href="dir_3b087d695daa154bfcb7242bcfd0fbd3.xhtml">UKCA</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">asad_impact.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="asad__impact_8f90_source.xhtml">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5d0099db38e65c1d44c00950354ce54a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfacesubroutine.xhtml">subroutine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asad__impact_8f90.xhtml#a5d0099db38e65c1d44c00950354ce54a">asad_impact</a> (n_points)</td></tr>
<tr class="memdesc:a5d0099db38e65c1d44c00950354ce54a"><td class="mdescLeft">&#160;</td><td class="mdescRight">(c) [University of Cambridge] [2008]. All rights reserved.  <a href="#a5d0099db38e65c1d44c00950354ce54a">More...</a><br /></td></tr>
<tr class="separator:a5d0099db38e65c1d44c00950354ce54a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a5d0099db38e65c1d44c00950354ce54a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d0099db38e65c1d44c00950354ce54a">&#9670;&nbsp;</a></span>asad_impact()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfacesubroutine.xhtml">subroutine</a> asad_impact </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eg__hash_8c.xhtml#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>, intent(in)&#160;</td>
          <td class="paramname"><em>n_points</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(c) [University of Cambridge] [2008]. All rights reserved. </p>
<p>(c) [University of Cambridge] [2008]. All rights reserved. This routine has been licensed to the Met Office for use and distribution under the UKCA collaboration agreement, subject!&gt; to the terms and conditions set out therein. [Met Office Ref SC138]!&gt; Purpose: Controlling routine for the IMPACT integration scheme Part of the UKCA model, a community model supported by The Met Office and NCAS, with components provided initially by The University of Cambridge, University of Leeds and The Met. Office. See www.ukca.ac.uk Called from ASAD_CDRIVE This file belongs in section: UKCA Interface !&gt; Called from chemistry driver routine cdrive. Arguments: lphot - Logical array. One entry per gridpoint. If set .T. then photolysis is occurring and the scheme will adjust the accuracy of the Jacobian. See method. All other variables are obtained via COMMON. Method !&gt; The IMPACT scheme used the Euler backward implicit timescheme as its starting point. This is a first order conservative scheme. A predictor-corrector approach is used to solve this by employing a Newton-Raphson type iteration. However, rather than compute and invert a near full Jacobian matrix, this scheme only considers the diagonal terms only. For mildly stiff chemistry this should work fine. However, if the scheme is not converging rapidly enough during daylight, this is a symptom that the off-diagonal production terms, which are usually ignored, are important. In this case, set the switch ljacx .T. and make sure that the lphot array is set .true. where photolysis is on. Since, only approximate forms of the Jacobian are considered, if switched on, the method will add in the terms in the Jacobian due to photolysis. It does this in an approximate way to avoid an matrix inversion but this greatly improves the performance of the scheme under stiffer conditions. The IMPACT scheme is fully described in the forthcoming paper; Carver and Stott, 1997, 'IMPACT: an implicit time integration scheme for chemical species and families', to be submitted to Annales Geophysicae. Preprints available. Externals !&gt; ftoy Converts f concentrations to y (partitions families). diffun Computes tendencies due to chemistry and main diagonal Jacobian elements. Local variables !&gt; gconv .true. if convergence in Newton-Rhapson has been achieved. ifi Number of ftoy iterations. zf Values of f at start of chemistry step. zprf Value of f on previous Newton-Rhapson iteration. binv Inverse of the approximate (main diagonal only) of the matrix ( I - dt.J) where J is Jacobian. dely Represents the change in variable, y, produced by multiplying binv to the function we are trying to find the root of. Language: FORTRAN 90 This code is written to UMDP3 v6 programming standards. </p>
<p>Local variables </p>

<p class="definition">Definition at line <a class="el" href="asad__impact_8f90_source.xhtml#l00076">76</a> of file <a class="el" href="asad__impact_8f90_source.xhtml">asad_impact.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="asad__impact_8f90_a5d0099db38e65c1d44c00950354ce54a_cgraph.svg" width="100%" height="527"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="asad__impact_8f90_a5d0099db38e65c1d44c00950354ce54a_icgraph.svg" width="460" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
